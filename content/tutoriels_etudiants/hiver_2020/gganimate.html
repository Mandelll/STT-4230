---
title: 'Package gganimate'
linkTitle: "gganimate - graphiques ggplot2 animés"
author: "Pascale Caissy & Jacob Lessard-Lord"
weight: 3
date: '2020-03-16'
output: 
  blogdown::html_page:
    toc: yes
    toc_depth: 2
    number_sections: true
    highlight: tango
editor_options:
  chunk_output_type: console
---

<script src="/rmarkdown-libs/accessible-code-block/empty-anchor.js"></script>
<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<div id="TOC">
<ul>
<li><a href="#introduction-à-gganimate"><span class="toc-section-number">1</span> Introduction à <code>gganimate</code></a></li>
<li><a href="#présentation-et-préparation-des-deux-jeux-de-données"><span class="toc-section-number">2</span> Présentation et préparation des deux jeux de données</a><ul>
<li><a href="#quakes"><span class="toc-section-number">2.1</span> <code>quakes</code></a></li>
<li><a href="#worldphones"><span class="toc-section-number">2.2</span> <code>WorldPhones</code></a></li>
</ul></li>
<li><a href="#exploration-de-gganimate"><span class="toc-section-number">3</span> Exploration de <code>gganimate</code></a><ul>
<li><a href="#installation-de-gganimate"><span class="toc-section-number">3.1</span> Installation de <code>gganimate</code></a></li>
<li><a href="#fonctions-de-base"><span class="toc-section-number">3.2</span> Fonctions de base</a></li>
<li><a href="#premier-exemple-avec-quakes"><span class="toc-section-number">3.3</span> Premier exemple avec <code>quakes</code></a></li>
<li><a href="#deuxième-exemple-avec-worldphones"><span class="toc-section-number">3.4</span> Deuxième exemple avec <code>WorldPhones</code></a></li>
<li><a href="#sauvegarder-une-animation-anim_save"><span class="toc-section-number">3.5</span> Sauvegarder une animation (<code>anim_save</code>)</a></li>
</ul></li>
<li><a href="#appréciation-du-package"><span class="toc-section-number">4</span> Appréciation du package</a><ul>
<li><a href="#points-forts"><span class="toc-section-number">4.1</span> Points forts</a></li>
<li><a href="#limitations"><span class="toc-section-number">4.2</span> Limitations</a></li>
</ul></li>
<li><a href="#ressources-utiles"><span class="toc-section-number">5</span> Ressources utiles</a></li>
<li><a href="#références">Références</a></li>
</ul>
</div>

<div id="introduction-à-gganimate" class="section level1">
<h1><span class="header-section-number">1</span> Introduction à <code>gganimate</code></h1>
<p>R est un logiciel très puissant permettant la création de graphiques, ceux-ci étant à la base de la présentation de données statistiques. Un package très utilisé pour la création de graphiques est <code>ggplot2</code>, sa popularité s’expliquant par sa facilité d’utilisation et la répétitivité de ses commandes. Une extension de <code>ggplot2</code> très appréciée des fans de visualisation graphique est le package <code>gganimate</code>.</p>
<p>Le package <code>gganimate</code> a d’abord été développé par David Robinson au début de 2016. Cependant, cette version n’a jamais été publiée sur les serveurs du CRAN. À l’automne 2017, Thomas Lin Pedersen a pris en charge la maintenance du package <code>gganimate</code>. Des changements majeurs ont ensuite été apportés au package, ce qui a mené à une nouvelle version de <code>gganimate</code> à l’été 2018. Le package <code>gganimate</code> est maintenant disponible sur les serveurs du CRAN. La dernière version (1.0.5) a été déposée le 9 février 2020.</p>
<p>Ce package permet d’ajouter des animations aux graphiques statiques produits à l’aide de <code>ggplot2</code>. Une animation est en fait une image générée à partir d’une série d’images (tableaux ou <em>frames</em> en anglais) superposées rapidement pour donner l’illusion d’un mouvement continu. Ces animations peuvent entre autres être visualisées sur des pages html ou enregistrées sous forme de gif. Ainsi, ce package permet d’attirer l’attention sur les graphiques d’une présentation ou d’aider à représenter une multitude de données dans un même graphique. Ici, nous nous amuserons à créer des graphiques animés à l’aide de <code>gganimate</code> en utilisant deux jeux de données du R de base, soit <code>quakes</code> et <code>WorldPhones</code>.</p>
</div>
<div id="présentation-et-préparation-des-deux-jeux-de-données" class="section level1">
<h1><span class="header-section-number">2</span> Présentation et préparation des deux jeux de données</h1>
<div id="quakes" class="section level2">
<h2><span class="header-section-number">2.1</span> <code>quakes</code></h2>
<p>Le jeu de données <code>quakes</code> du package <code>datasets</code> du R de base contient les données de 1000 séismes de magnitude 4.0 et plus s’étant produits près des îles Fidji depuis 1964. Chaque observation inclut la latitude (<code>lat</code>), la longitude (<code>long</code>), la profondeur (<code>depth</code>), la magnitude (<code>mag</code>) et le nombre de stations à proximité (<code>stations</code>) ayant rapporté une activité sismique.</p>
<p>Ajoutons à ce jeu de données une variable factorielle prénommée <code>region</code>. Ce facteur déterminera si chaque observation a été observée à l’ouest ou à l’est de la longitude 175°. Créons également un facteur nommé <code>mag_catego</code>. Ce dernier servira à créer des classes de magnitude du séisme arrondie à l’entier inférieur (4, 5 ou 6).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>quakes<span class="op">$</span>region &lt;-<span class="st"> </span><span class="kw">factor</span>(quakes<span class="op">$</span>long <span class="op">&gt;=</span><span class="st"> </span><span class="dv">175</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Ouest&quot;</span>, <span class="st">&quot;Est&quot;</span>))</span>
<span id="cb1-2"><a href="#cb1-2"></a>quakes<span class="op">$</span>mag_catego &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">floor</span>(quakes<span class="op">$</span>mag))</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">str</span>(quakes)</span></code></pre></div>
<pre><code>&#39;data.frame&#39;:   1000 obs. of  7 variables:
 $ lat       : num  -20.4 -20.6 -26 -18 -20.4 ...
 $ long      : num  182 181 184 182 182 ...
 $ depth     : int  562 650 42 626 649 195 82 194 211 622 ...
 $ mag       : num  4.8 4.2 5.4 4.1 4 4 4.8 4.4 4.7 4.3 ...
 $ stations  : int  41 15 43 19 11 12 43 15 35 19 ...
 $ region    : Factor w/ 2 levels &quot;Ouest&quot;,&quot;Est&quot;: 2 2 2 2 2 2 1 2 2 2 ...
 $ mag_catego: Factor w/ 3 levels &quot;4&quot;,&quot;5&quot;,&quot;6&quot;: 1 1 2 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div id="worldphones" class="section level2">
<h2><span class="header-section-number">2.2</span> <code>WorldPhones</code></h2>
<p>Le jeu de données <code>WorldPhones</code> du package <code>datasets</code> du R de base contient les données du nombre de lignes téléphoniques enregistrées entre 1951 et 1961 sur chaque continent sous forme de matrice. Dans cette matrice, le nom des colonnes indique le nom du continent où les données ont été enregistrées alors que le nom des rangées représente l’année à laquelle le nombre de lignes téléphoniques a été calculé.</p>
<p>Transformons d’abord cette matrice en dataframe avec le nom des rangées, donc l’année, inclus dans une colonne à part (<code>Year</code>).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>WorldPhones &lt;-<span class="st"> </span><span class="kw">data.frame</span>(WorldPhones)</span>
<span id="cb3-2"><a href="#cb3-2"></a>WorldPhones<span class="op">$</span>Year &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(<span class="kw">rownames</span>(WorldPhones))</span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">head</span>(WorldPhones, <span class="dt">n =</span> <span class="dv">3</span>)</span></code></pre></div>
<pre><code>     N.Amer Europe Asia S.Amer Oceania Africa Mid.Amer Year
1951  45939  21574 2876   1815    1646     89      555 1951
1956  60423  29990 4708   2568    2366   1411      733 1956
1957  64721  32510 5230   2695    2526   1546      773 1957</code></pre>
<p>Nous pouvons constater que le dataframe <code>WorldPhones</code> a une mise en forme large. Afin de pouvoir utiliser ce dataframe pour produire un graphique animé plus tard, transférons-le dans une mise en forme longue. Pour ce faire, nous utiliserons la fonction <code>pivot_longer</code> du package <code>tidyr</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">library</span>(tidyr)</span>
<span id="cb5-2"><a href="#cb5-2"></a>WorldPhones_long &lt;-<span class="st"> </span><span class="kw">pivot_longer</span>(</span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="dt">data =</span> WorldPhones, </span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="dt">cols =</span> <span class="kw">c</span>(N.Amer, Europe, Asia, S.Amer, Oceania, Africa, Mid.Amer), </span>
<span id="cb5-5"><a href="#cb5-5"></a>  <span class="dt">names_to =</span> <span class="st">&quot;Region&quot;</span>, </span>
<span id="cb5-6"><a href="#cb5-6"></a>  <span class="dt">values_to =</span> <span class="st">&quot;Nbr.Phones&quot;</span>)</span>
<span id="cb5-7"><a href="#cb5-7"></a></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="kw">head</span>(WorldPhones_long, <span class="dt">n =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code># A tibble: 5 x 3
   Year Region  Nbr.Phones
  &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;
1  1951 N.Amer       45939
2  1951 Europe       21574
3  1951 Asia          2876
4  1951 S.Amer        1815
5  1951 Oceania       1646</code></pre>
</div>
</div>
<div id="exploration-de-gganimate" class="section level1">
<h1><span class="header-section-number">3</span> Exploration de <code>gganimate</code></h1>
<div id="installation-de-gganimate" class="section level2">
<h2><span class="header-section-number">3.1</span> Installation de <code>gganimate</code></h2>
<p>Une fois le package installé dans notre librairie à l’aide de la fonction <code>install.packages</code>, chargeons-le dans notre espace de travail. À noter que <code>gganimate</code> charge automatiquement le package <code>ggplot2</code> à notre session.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">library</span>(gganimate)</span></code></pre></div>
<pre><code>Loading required package: ggplot2</code></pre>
<p><strong>NOTE:</strong> L’installation du package <a href="https://cran.r-project.org/web/packages/gifski/index.html"><code>gifski</code></a> avec la fonction <code>install.packages</code> peut être nécessaire pour le bon fonctionnement des animations. Le package <code>gifski</code> permet d’assembler les différents tableaux produits en un GIF. Par la suite, même si l’installation en soi est requise, vous n’aurez pas besoin de le charger dans votre espace de travail.</p>
</div>
<div id="fonctions-de-base" class="section level2">
<h2><span class="header-section-number">3.2</span> Fonctions de base</h2>
<table>
<caption><strong>Tableau 1.</strong> Liste des fonctions les plus couramment utilisées du package <code>gganimate</code> avec un hyperlien vers la documentation pertinente pour chacune d’entre elle. Comme il n’existe pas de documentation spécifique pour expliquer la fonction générique des fonctions de type <code>fonction_*</code> (sauf <code>enter/exit_*</code>), les hyperliens mènent à un exemple de fonction.</caption>
<colgroup>
<col width="12%" />
<col width="21%" />
<col width="38%" />
<col width="27%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">Fonction</th>
<th align="left">Possibilités de fonctions (*)</th>
<th align="left">Rôle</th>
<th align="left">S’intègre directement aux commandes <code>ggplot2</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"><a href="https://gganimate.com/reference/transition_states.html"><code>transition_*</code></a></td>
<td align="left">states / time / reveal / events / filter / layers / components / manual / null</td>
<td align="left">Contrôle les données à animer</td>
<td align="left">Oui</td>
</tr>
<tr class="even">
<td align="left"><a href="https://gganimate.com/reference/view_follow.html"><code>view_*</code></a></td>
<td align="left">follow / step / step_manual / zoom / zoom_manual / static</td>
<td align="left">Contrôle le mouvement du plan de vue</td>
<td align="left">Oui</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://gganimate.com/reference/shadow_mark.html"><code>shadow_*</code></a></td>
<td align="left">wake / trail / mark / null</td>
<td align="left">Contrôle la persistance des données</td>
<td align="left">Oui</td>
</tr>
<tr class="even">
<td align="left"><a href="https://gganimate.com/reference/enter_exit.html"><code>enter/exit_*</code></a></td>
<td align="left">manual / appear / disappear / fade / grow / shrink / recolour / recolor / fly / drift / reset</td>
<td align="left">Contrôlent la façon dont les données apparaissent et disparaissent</td>
<td align="left">Oui</td>
</tr>
<tr class="odd">
<td align="left"><a href="https://gganimate.com/reference/animate.html"><code>animate</code></a></td>
<td align="left">-</td>
<td align="left">Contrôle la visualisation des tableaux (<em>frames</em>) de l’animation et leur nombre</td>
<td align="left">Non</td>
</tr>
<tr class="even">
<td align="left"><a href="https://gganimate.com/reference/anim_save.html"><code>anim_save</code></a></td>
<td align="left">-</td>
<td align="left">Permet la sauvegarde de l’objet animé dans un fichier</td>
<td align="left">Non</td>
</tr>
</tbody>
</table>
<p><strong>NOTE:</strong> L’ajout de la fonction <code>view_*</code> ou <code>transition_*</code> à une série de commandes suivant la syntaxe de <code>ggplot2</code> permet d’animer n’importe quel graphique.</p>
<p><strong>NOTE 2:</strong> La description exhaustive de chaque fonction du package <code>gganimate</code> est disponible sur le <a href="https://gganimate.com/reference/index.html">site web de gganimate</a>.</p>
</div>
<div id="premier-exemple-avec-quakes" class="section level2">
<h2><span class="header-section-number">3.3</span> Premier exemple avec <code>quakes</code></h2>
<p>Explorons maintenant le package <code>gganimate</code>. Nous débuterons en créant un graphique statique avec <code>ggplot2</code> à partir du jeu de données <code>quakes</code>. Nous voulons mettre sous forme d’un nuage de points la latitude et la longitude où un séisme a été enregistré. Ces points seront colorés selon un gradient de la profondeur du séisme.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>p &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> long, </span>
<span id="cb9-3"><a href="#cb9-3"></a>                           <span class="dt">y =</span> lat,</span>
<span id="cb9-4"><a href="#cb9-4"></a>                           <span class="dt">colour =</span> depth,</span>
<span id="cb9-5"><a href="#cb9-5"></a>                           <span class="dt">group =</span> region)) <span class="op">+</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;1000 séismes près de Fidji&quot;</span>) <span class="op">+</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;longitude&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;latitude&quot;</span>) <span class="op">+</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&quot;profondeur&quot;</span>) <span class="op">+</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="st">  </span><span class="kw">scale_color_gradient</span>(<span class="dt">low =</span> <span class="st">&quot;paleturquoise&quot;</span>, </span>
<span id="cb9-11"><a href="#cb9-11"></a>                       <span class="dt">high =</span> <span class="st">&quot;#008080&quot;</span>) <span class="op">+</span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="st">  </span><span class="kw">coord_quickmap</span>()</span>
<span id="cb9-14"><a href="#cb9-14"></a></span>
<span id="cb9-15"><a href="#cb9-15"></a>p</span></code></pre></div>
<p><img src="/tutoriels_etudiants/hiver_2020/gganimate_files/figure-html/graphique%20statique-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Nous allons maintenant ajouter un peu de mouvement. Pour faciliter la visualisation du gradient de couleur, nous voulons que chaque point apparaisse graduellement en fonction de la profondeur à laquelle les séismes ont été enregistrés. Nous nous attarderons au rôle de chacune des fonctions plus bas.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>panim &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="st">  </span><span class="kw">transition_time</span>(depth) <span class="op">+</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="st">  </span><span class="kw">shadow_mark</span>(<span class="dt">past =</span> <span class="ot">TRUE</span>, </span>
<span id="cb10-4"><a href="#cb10-4"></a>              <span class="dt">future =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="st">  </span><span class="kw">enter_fade</span>() <span class="op">+</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="st">  </span><span class="kw">exit_fade</span>()</span>
<span id="cb10-7"><a href="#cb10-7"></a> </span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="kw">animate</span>(panim, <span class="dt">nframes =</span> <span class="dv">100</span>, <span class="dt">end_pause =</span> <span class="dv">15</span>, <span class="dt">rewind =</span> <span class="ot">TRUE</span>) </span></code></pre></div>
<p><img src="/tutoriels_etudiants/hiver_2020/gganimate_files/figure-html/animationON-1.gif" width="100%" style="display: block; margin: auto;" /></p>
<p>Nous constatons que la syntaxe s’intègre très bien à celle de <code>ggplot2</code>. Explorons chacune des fonctions ci-haut, en les appliquant une à une au graphique <code>p</code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>panim1 &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="st">  </span><span class="kw">transition_time</span>(depth)</span>
<span id="cb11-3"><a href="#cb11-3"></a></span>
<span id="cb11-4"><a href="#cb11-4"></a>panim1</span></code></pre></div>
<p><img src="/tutoriels_etudiants/hiver_2020/gganimate_files/figure-html/animationON1-1.gif" width="100%" style="display: block; margin: auto;" /></p>
<p><a href="https://gganimate.com/reference/transition_time.html"><code>transion_time</code></a> permet que chaque état soit défini comme une période de temps et chaque transition se fasse selon la durée entre les différents états. Bien que la profondeur (<code>depth</code>) ne soit pas une mesure de temps, nous voulions ici que chaque point apparaisse graduellement <em>dans le temps</em> selon la profondeur. Avec cette seule fonction, le graphique est un peu chaotique: les points disparaissent les uns après les autres. Nous aurons donc besoin d’une fonction de type <code>shadow_*</code> pour la suite.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>panim2 &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="st">  </span><span class="kw">transition_time</span>(depth) <span class="op">+</span></span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="st">  </span><span class="kw">shadow_mark</span>(<span class="dt">past =</span> <span class="ot">TRUE</span>, </span>
<span id="cb12-4"><a href="#cb12-4"></a>              <span class="dt">future =</span> <span class="ot">FALSE</span>)</span>
<span id="cb12-5"><a href="#cb12-5"></a> </span>
<span id="cb12-6"><a href="#cb12-6"></a>panim2</span></code></pre></div>
<p><img src="/tutoriels_etudiants/hiver_2020/gganimate_files/figure-html/animationON2-1.gif" width="100%" style="display: block; margin: auto;" /></p>
<p><a href="https://gganimate.com/reference/shadow_mark.html"><code>shadow_mark</code></a> permet d’afficher les données des animations passées et futures à l’aide de ses arguments logiques <code>past</code> et <code>future</code>. En donnant la valeur <code>TRUE</code> à <code>past</code> et la valeur <code>FALSE</code> à <code>future</code> (qui sont d’ailleurs les valeurs par défaut), les données des animations passées restent visibles jusqu’à la fin de l’animation, tandis que les données des animations futures ne sont pas affichées. Toutefois, la transition entre les points est un peu abrupte. Tentons d’intégrer une fonction de type <code>enter/exit_*</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>panim3 &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="st">  </span><span class="kw">transition_time</span>(depth) <span class="op">+</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="st">  </span><span class="kw">shadow_mark</span>(<span class="dt">past =</span> <span class="ot">TRUE</span>, </span>
<span id="cb13-4"><a href="#cb13-4"></a>              <span class="dt">future =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="st">  </span><span class="kw">enter_fade</span>() <span class="op">+</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="st">  </span><span class="kw">exit_fade</span>()</span></code></pre></div>
<p><a href="https://gganimate.com/reference/enter_exit.html"><code>enter_fade</code></a> et <a href="https://gganimate.com/reference/enter_exit.html"><code>exit_fade</code></a> nous permettent de faire apparaître et disparaître les points de façon graduelle. Cependant, l’animation se réinitialise lorsque l’intégralité des données ont apparu. Il nous faudra donc contrôler l’enchaînement des tableaux avec <code>animate</code>.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>panim &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="st">  </span><span class="kw">transition_time</span>(depth) <span class="op">+</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="st">  </span><span class="kw">shadow_mark</span>(<span class="dt">past =</span> <span class="ot">TRUE</span>, </span>
<span id="cb14-4"><a href="#cb14-4"></a>              <span class="dt">future =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="st">  </span><span class="kw">enter_fade</span>() <span class="op">+</span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="st">  </span><span class="kw">exit_fade</span>()</span>
<span id="cb14-7"><a href="#cb14-7"></a> </span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="kw">animate</span>(panim, <span class="dt">nframes =</span> <span class="dv">100</span>, <span class="dt">end_pause =</span> <span class="dv">15</span>, <span class="dt">rewind =</span> <span class="ot">TRUE</span>) </span></code></pre></div>
<p><img src="/tutoriels_etudiants/hiver_2020/gganimate_files/figure-html/animationON4-1.gif" width="100%" style="display: block; margin: auto;" /></p>
<p><a href="https://gganimate.com/reference/animate.html"><code>animate</code></a> nous permet de contrôler la visualisation des tableaux (<em>frames</em>) de l’animation et leur nombre (argument <code>nframes</code>). L’argument <code>rewind</code> permet de “rembobiner” notre animation <code>panim</code> en faisant rejouer les différents tableaux dans l’ordre inverse. De plus, nous avons pu ajouter une pause à la fin de l’animation (argument <code>end_pause</code>) d’une durée de 15 tableaux afin d’augmenter la période de temps où on peut voir tous les points de l’animation.</p>
<!--
L'argument `width` permet de contrôler la taille du graphique, car l'usage d'`animate` outrepasse les options de tailles mises avec R Markdown. Toutefois, l'usage de l'argument `width` modifie aussi la taille des titres et annotations du graphique.
-->
<div id="sous-exemples" class="section level3">
<h3><span class="header-section-number">3.3.1</span> Sous-exemples</h3>
<p>Nous pourrions aussi changer l’animation en modifiant le type de transition. Par exemple, nous pourrions vouloir voir apparaître les séismes s’étant produits à l’est et à l’ouest de la longitude 175° en alternance. Nous pourrions alors utiliser la fonction <code>transition_states</code> au lieu de <code>transition_times</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>p2 &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st">  </span><span class="kw">transition_states</span>(region, </span>
<span id="cb15-3"><a href="#cb15-3"></a>                    <span class="dt">wrap =</span> <span class="ot">FALSE</span>, </span>
<span id="cb15-4"><a href="#cb15-4"></a>                    <span class="dt">transition_length =</span> <span class="dv">3</span>, </span>
<span id="cb15-5"><a href="#cb15-5"></a>                    <span class="dt">state_length =</span> <span class="fl">0.5</span>) <span class="op">+</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="st">  </span><span class="kw">shadow_mark</span>(<span class="dt">past =</span> <span class="ot">FALSE</span>, </span>
<span id="cb15-7"><a href="#cb15-7"></a>              <span class="dt">future =</span> <span class="ot">FALSE</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="st">  </span><span class="kw">enter_fade</span>() <span class="op">+</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="st">  </span><span class="kw">exit_fade</span>()</span>
<span id="cb15-10"><a href="#cb15-10"></a> </span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="kw">animate</span>(p2, <span class="dt">nframes =</span> <span class="dv">100</span>, <span class="dt">rewind =</span> <span class="ot">TRUE</span>) </span></code></pre></div>
<p><img src="/tutoriels_etudiants/hiver_2020/gganimate_files/figure-html/animation2-1.gif" width="100%" style="display: block; margin: auto;" /></p>
<ul>
<li><p>Avec la fonction <a href="https://gganimate.com/reference/transition_states.html"><code>transition_states</code></a>, les données sont séparées en différents états. Ici, les données ont été séparées selon la région en deux états : est et ouest. Nous avons pu définir le temps entre les transitions, donc à quelle vitesse les points d’une région s’effacent, avec l’argument <code>transition_length</code>. Nous avons également raccourci le temps entre lequel on voit les points d’une région individuelle en modifiant la valeur de l’argument <code>state_length</code>.</p></li>
<li><p>Avec la fonction <a href="https://gganimate.com/reference/shadow_mark.html"><code>shadow_mark</code></a>, nous avons empêché que les points d’une seule région apparaissent et disparaissent en mettant les deux arguments <code>past</code> et <code>future</code> à <code>FALSE</code>. Finalement, avec la fonction <code>animate</code>, nous avons retiré la pause (argument <code>end_pause</code>) à la fin de l’animation pour que le tout soit fluide.</p></li>
</ul>
</div>
<div id="pour-samuser-encore-un-peu-avec-quakes" class="section level3">
<h3><span class="header-section-number">3.3.2</span> Pour s’amuser encore un peu avec <code>quakes</code></h3>
<p>Une autre fonction intéressante du package <code>gganimate</code> est <a href="https://gganimate.com/reference/transition_layers.html"><code>transition_layers</code></a>. Cette dernière permet d’ajouter graduellement chaque couche du graphique. Par exemple, il est possible de faire apparaître des diagrammes en boîte, puis d’ajouter les points qui les constituent par la suite.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>bp &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes, </span>
<span id="cb16-2"><a href="#cb16-2"></a>             <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag_catego, <span class="dt">y =</span> stations)) <span class="op">+</span></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">colour =</span> region),</span>
<span id="cb16-5"><a href="#cb16-5"></a>              <span class="dt">alpha =</span> <span class="fl">0.4</span>) <span class="op">+</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Nombre de stations ayant rapporté des séismes</span><span class="ch">\n</span><span class="st">d&#39;une certaine classe de magnitudes&quot;</span>) <span class="op">+</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Classe de magnitude&quot;</span>) <span class="op">+</span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Nombre de stations&quot;</span>) <span class="op">+</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&quot;Région&quot;</span>)<span class="op">+</span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="st">  </span><span class="kw">theme_classic</span>()<span class="op">+</span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="st">  </span><span class="kw">scale_color_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkcyan&quot;</span>, <span class="st">&quot;#FF69B4&quot;</span>))</span>
<span id="cb16-13"><a href="#cb16-13"></a>  </span>
<span id="cb16-14"><a href="#cb16-14"></a></span>
<span id="cb16-15"><a href="#cb16-15"></a>bpanim &lt;-<span class="st"> </span>bp <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-16"><a href="#cb16-16"></a><span class="st">  </span><span class="kw">transition_layers</span>(<span class="dt">layer_length =</span> <span class="fl">0.5</span>, </span>
<span id="cb16-17"><a href="#cb16-17"></a>                    <span class="dt">transition_length =</span> <span class="dv">1</span>) <span class="op">+</span></span>
<span id="cb16-18"><a href="#cb16-18"></a><span class="st">  </span><span class="kw">enter_grow</span>() <span class="op">+</span><span class="st"> </span></span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="st">  </span><span class="kw">enter_fade</span>()</span>
<span id="cb16-20"><a href="#cb16-20"></a></span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="kw">animate</span>(bpanim, <span class="dt">rewind =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="/tutoriels_etudiants/hiver_2020/gganimate_files/figure-html/animationBP-1.gif" width="100%" style="display: block; margin: auto;" /></p>
<ul>
<li><p><a href="https://gganimate.com/reference/transition_layers.html"><code>transition_layers</code></a> permet de faire apparaître les diagrammes en boîte, puis les points qui les constituent. Dans cet exemple, <code>geom_boxplot</code> est une couche et <code>geom_jitter</code> est une autre couche. L’argument <code>layer_length</code> permet de déterminer le temps de pause avant l’ajout de la prochaine couche et l’argument <code>transition_length</code> permet de contrôler la durée de l’entrée d’une nouvelle couche.</p></li>
<li><p><a href="https://gganimate.com/reference/enter_exit.html"><code>enter_grow</code></a> et <a href="https://gganimate.com/reference/enter_exit.html"><code>enter_fade</code></a> permettent de contrôler l’apparition des différentes couches. Comme dans cet exemple, il est possible de combiner plusieurs fonctions de type <a href="https://gganimate.com/reference/enter_exit.html"><code>enter_*</code></a> afin d’obtenir l’animation souhaitée.</p></li>
<li><p><a href="https://gganimate.com/reference/animate.html"><code>animate</code></a> permet ici d’utiliser l’argument <code>rewind</code> afin de rendre l’animation plus intéressante visuellement.</p></li>
</ul>
</div>
</div>
<div id="deuxième-exemple-avec-worldphones" class="section level2">
<h2><span class="header-section-number">3.4</span> Deuxième exemple avec <code>WorldPhones</code></h2>
<p>Nous voulons ici que le nombre de lignes téléphoniques change en fonction des années et des régions. Nous utiliserons alors un diagramme à barres.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>WP &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> WorldPhones_long) <span class="op">+</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> Nbr.Phones), </span>
<span id="cb17-3"><a href="#cb17-3"></a>           <span class="dt">fill =</span> <span class="st">&quot;darkcyan&quot;</span>) <span class="op">+</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Région&quot;</span>) <span class="op">+</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Nombre de téléphones (en milliers)&quot;</span>) <span class="op">+</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="st">  </span><span class="kw">transition_states</span>(Year,</span>
<span id="cb17-8"><a href="#cb17-8"></a>                    <span class="dt">transition_length =</span> <span class="dv">2</span>,</span>
<span id="cb17-9"><a href="#cb17-9"></a>                    <span class="dt">state_length =</span> <span class="dv">1</span>, </span>
<span id="cb17-10"><a href="#cb17-10"></a>                    <span class="dt">wrap =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Année : {closest_state}&quot;</span>)</span>
<span id="cb17-12"><a href="#cb17-12"></a></span>
<span id="cb17-13"><a href="#cb17-13"></a>WP</span></code></pre></div>
<p><img src="/tutoriels_etudiants/hiver_2020/gganimate_files/figure-html/animationWP-1.gif" width="100%" style="display: block; margin: auto;" /></p>
<ul>
<li><p>Cet exemple fait appel à la fonction <a href="https://gganimate.com/reference/transition_states.html"><code>transition_states</code></a> pour animer le graphique. Chaque état représente une année différente. Encore une fois, nous avons pu définir le temps entre les transitions, donc la vitesse à laquelle on change d’année avec l’argument <code>transition_length</code>. Aussi, nous avons laissé la valeur par défaut pour l’argument <code>state_length</code>, qui permet de contrôler le temps que les données de chaque année restent visibles. En donnant la valeur <code>TRUE</code> à l’argument logique <code>wrap</code>, on ajoute une transition entre le dernier état et le premier état, ce qui permet d’avoir une animation plus fluide lorsqu’elle se termine.</p></li>
<li><p>Il est possible d’afficher de façon interactive l’année représentée à chaque état de l’animation grâce à la variable <code>closest_state</code>. Cette variable permet de définir le nom de l’état le plus près du tableau représenté (<em>frame</em>).</p></li>
</ul>
<div id="sous-exemple" class="section level3">
<h3><span class="header-section-number">3.4.1</span> Sous-exemple</h3>
<p>En reprenant l’exemple précédent, nous allons mettre en couleur les nouvelles données qui apparaissent passé 1951. Cela nécessitera la superposition d’un graphique de l’état initial, soit l’année 1951, sur les données des années qui suivent, celles-ci affichées d’une différente couleur.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>WP2 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> WorldPhones_long) <span class="op">+</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> Nbr.Phones), </span>
<span id="cb18-3"><a href="#cb18-3"></a>           <span class="dt">fill =</span> <span class="st">&quot;cyan3&quot;</span>) <span class="op">+</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">data =</span> WorldPhones_long[WorldPhones_long<span class="op">$</span>Year <span class="op">==</span><span class="st"> </span><span class="dv">1951</span>,], </span>
<span id="cb18-5"><a href="#cb18-5"></a>           <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> Region, <span class="dt">y =</span> Nbr.Phones), </span>
<span id="cb18-6"><a href="#cb18-6"></a>           <span class="dt">fill =</span> <span class="st">&quot;darkcyan&quot;</span>, </span>
<span id="cb18-7"><a href="#cb18-7"></a>           <span class="dt">show.legend =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="st">  </span><span class="kw">theme_classic</span>() <span class="op">+</span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;Région&quot;</span>) <span class="op">+</span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="st">  </span><span class="kw">ylab</span>(<span class="st">&quot;Nombre de téléphones (en milliers)&quot;</span>) <span class="op">+</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="st">  </span><span class="kw">transition_states</span>(Year,</span>
<span id="cb18-12"><a href="#cb18-12"></a>                    <span class="dt">transition_length =</span> <span class="dv">2</span>,</span>
<span id="cb18-13"><a href="#cb18-13"></a>                    <span class="dt">state_length =</span> <span class="dv">1</span>, </span>
<span id="cb18-14"><a href="#cb18-14"></a>                    <span class="dt">wrap =</span> <span class="ot">TRUE</span>) <span class="op">+</span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Année : {closest_state}&quot;</span>) <span class="op">+</span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="st">  </span><span class="kw">shadow_mark</span>()</span>
<span id="cb18-17"><a href="#cb18-17"></a></span>
<span id="cb18-18"><a href="#cb18-18"></a>WP2</span></code></pre></div>
<p><img src="/tutoriels_etudiants/hiver_2020/gganimate_files/figure-html/animationWP2-1.gif" width="100%" style="display: block; margin: auto;" /></p>
<ul>
<li>Nous avons d’abord eu à définir dans ggplot l’argument <code>data</code> comme étant <code>WorldPhones_long</code>.</li>
<li>Nous avons ensuite généré le graphique à animer en premier. <code>gganimate</code> le reconnaitra, car il reprend l’argument <code>data</code> de la fonction <code>ggplot</code>.</li>
<li>Nous superposons ensuite le deuxième graphique, qui utilise seulement les données de 1951 dans <code>WorldPhones_long</code>, soit des données différentes que ce qui a été entré dans <code>ggplot</code>. Ce graphique demeurera alors statique, <code>gganimate</code> ne le reconnaissant pas.</li>
<li>Les arguments <code>fill</code> dans <code>geom_col</code> pour les deux graphiques ne retournent pas les mêmes teintes.</li>
<li>Pour l’animation, nous avons simplement repris notre usage précédent de <code>transition_states</code> et <code>closest_states</code>, mais avons ajouté la fonction <code>shadow_mark</code> pour que le graphique statique apparaisse par-dessus le graphique animé durant toute la durée de l’animation.</li>
</ul>
</div>
<div id="pour-samuser-encore-un-peu-avec-worldphones" class="section level3">
<h3><span class="header-section-number">3.4.2</span> Pour s’amuser encore un peu avec <code>WorldPhones</code></h3>
<p>Les diagrammes à barres peuvent être intéressants pour comparer les données d’une seule année à la fois entre elles, mais ne permettent pas de comparer la progression du nombre de lignes téléphoniques par année sur un seul plan de vue. Nous pourrions alors créer un graphique à lignes avec <code>geom_line</code>. Pour l’animation, nous utiliserons pour la première fois une fonction de type <code>view_*</code> ainsi que la fonction <a href="https://gganimate.com/reference/transition_reveal.html"><code>transition_reveal</code></a>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a>WP3 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> WorldPhones_long, <span class="kw">aes</span>(<span class="dt">x =</span> Year, <span class="dt">y =</span> Nbr.Phones, <span class="dt">group=</span>Region, <span class="dt">color=</span>Region)) <span class="op">+</span></span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="st">    </span><span class="kw">geom_line</span>() <span class="op">+</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Nombre de téléphones (en milliers) entre 1951 et 1961&quot;</span>) <span class="op">+</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="st">    </span><span class="kw">ylab</span>(<span class="st">&quot;Nombre de téléphones&quot;</span>) <span class="op">+</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="st">    </span><span class="kw">xlab</span>(<span class="st">&quot;Année&quot;</span>)<span class="op">+</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="st">    </span><span class="kw">theme_classic</span>()<span class="op">+</span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="st">    </span><span class="kw">view_follow</span>(<span class="dt">fixed_x =</span> <span class="ot">TRUE</span>, </span>
<span id="cb19-9"><a href="#cb19-9"></a>                <span class="dt">fixed_y =</span> <span class="ot">FALSE</span>) <span class="op">+</span></span>
<span id="cb19-10"><a href="#cb19-10"></a><span class="st">    </span><span class="kw">transition_reveal</span>(Year)</span>
<span id="cb19-11"><a href="#cb19-11"></a>    </span>
<span id="cb19-12"><a href="#cb19-12"></a></span>
<span id="cb19-13"><a href="#cb19-13"></a>WP3 &lt;-<span class="st"> </span><span class="kw">animate</span>(WP3, <span class="dt">end_pause =</span> <span class="dv">15</span>)</span>
<span id="cb19-14"><a href="#cb19-14"></a></span>
<span id="cb19-15"><a href="#cb19-15"></a>WP3</span></code></pre></div>
<p><img src="/tutoriels_etudiants/hiver_2020/gganimate_files/figure-html/animationWP3-1.gif" width="100%" style="display: block; margin: auto;" /></p>
<ul>
<li><a href="https://gganimate.com/reference/transition_reveal.html"><code>transition_reveal</code></a> calcule des états intermédiaires entre les années (<code>Year</code>) pour tracer une ligne en continu.</li>
<li><a href="https://gganimate.com/reference/view_follow.html"><code>view_follow</code></a> initie un mouvement du plan de vue selon la progression des axes. Ici, nous ne voulions pas que le plan de vue suive l’axe des abscisses. Nous avons donc donné la valeur <code>FALSE</code> à l’argument <code>fixed_x</code>.</li>
</ul>
</div>
</div>
<div id="sauvegarder-une-animation-anim_save" class="section level2">
<h2><span class="header-section-number">3.5</span> Sauvegarder une animation (<code>anim_save</code>)</h2>
<p>Les animations produites par <code>gganimate</code> peuvent soit être visualisées en RStudio (fenêtre <em>Viewer</em>), intégrées directement dans des documents HTML avec la syntaxe R Markdown ou sauvegardées à l’aide de la fonction <code>anim_save</code> en fournissant une chaîne de caractères pour le nom de fichier (argument <code>filename</code>) et en désignation quelle animation enregistrer (argument <code>animation</code>). Sauvegardées ainsi, ces animations peuvent ensuite être implémentées dans d’autres documents.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">anim_save</span>(<span class="dt">filename =</span> <span class="st">&quot;WP3.gif&quot;</span>, <span class="dt">animation =</span> WP3)</span></code></pre></div>
</div>
</div>
<div id="appréciation-du-package" class="section level1">
<h1><span class="header-section-number">4</span> Appréciation du package</h1>
<p>Le package <code>gganimate</code> permet d’ajouter un peu de vie aux figures graphiques classiques. Ainsi, quelqu’un qui adore la visualisation de données graphiques pourra facilement y trouver son compte pour rendre ses graphiques plus interactifs et attirer l’œil de son audience.</p>
<div id="points-forts" class="section level2">
<h2><span class="header-section-number">4.1</span> Points forts</h2>
<ul>
<li>La syntaxe est compatible avec <code>ggplot2</code>, donc facile à intégrer rapidement dans une série de commandes.</li>
<li>Animer un graphique <code>ggplot2</code> est très simple, et nécessite dans bien des cas seulement l’ajout d’une fonction ou deux.</li>
<li>Un nombre limité de fonctions permet d’arriver à une panoplie de résultats.</li>
<li>Qui n’aime pas les animations, sincèrement?</li>
</ul>
</div>
<div id="limitations" class="section level2">
<h2><span class="header-section-number">4.2</span> Limitations</h2>
<ul>
<li>On ne peut pas superposer deux types de transition, ce qui peut limiter les possibilités de création ou demander de passer par des chemins plus complexes pour arriver à un résultat donné.</li>
<li>Les graphiques sont lents à produire selon la puissance de l’ordinateur. Cela rend l’exploration du package plus difficile.</li>
<li>La combinaison de certaines fonctions peut produire des résultats inattendus. Animer un graphique exactement comme on l’imagine peut alors devenir complexe.</li>
<li>Les tailles des graphiques sont difficiles à contrôler, surtout lorsqu’on les intègre à des documents en utilisant R Markdown.</li>
<li>La documentation R des différentes fonctions manque de clarté, car elle ne donne pas d’exemples visuels de ses commandes. Il faut souvent faire rouler le code qui est fourni, et celui-ci ne fonctionne pas toujours. Il faut alors avoir recours à des forums ou à des pages webs afin de mieux comprendre l’intégration des différentes fonctions.</li>
</ul>
</div>
</div>
<div id="ressources-utiles" class="section level1">
<h1><span class="header-section-number">5</span> Ressources utiles</h1>
<p>Aide-mémoire: <a href="https://github.com/rstudio/cheatsheets/blob/master/gganimate.pdf" class="uri">https://github.com/rstudio/cheatsheets/blob/master/gganimate.pdf</a></p>
</div>
<div id="références" class="section level1 unnumbered">
<h1>Références</h1>
<p><a href="https://gganimate.com/reference/index.html" class="uri">https://gganimate.com/reference/index.html</a></p>
<p><a href="https://CRAN.R-project.org/package=gganimate" class="uri">https://CRAN.R-project.org/package=gganimate</a></p>
<p><a href="https://www.datanovia.com/en/blog/gganimate-how-to-create-plots-with-beautiful-animation-in-r/" class="uri">https://www.datanovia.com/en/blog/gganimate-how-to-create-plots-with-beautiful-animation-in-r/</a></p>
<p><a href="https://www.data-imaginist.com/2019/gganimate-has-transitioned-to-a-state-of-release/" class="uri">https://www.data-imaginist.com/2019/gganimate-has-transitioned-to-a-state-of-release/</a></p>
</div>

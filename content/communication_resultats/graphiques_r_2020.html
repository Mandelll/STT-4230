---
title: "Graphiques en R"
author: "Sophie Baillargeon, Université Laval"
date: '2020-02-04'
weight: 1
slug: "graphiques_r"
categories: ["cours_2020-02-11"]
categories_weight: 1
lastmodifierdisplayname: "Sophie Baillargeon"
lastmodifieremail: "sophie.baillargeon@mat.ulaval.ca"
output:
  pdf_document:
    toc: yes
    toc_depth: 3
    highlight: tango
  blogdown::html_page:
    toc: yes
    toc_depth: 3
    highlight: tango
header-includes:
- \usepackage[french]{babel}
- \frenchbsetup{StandardLayout}
- \hypersetup{colorlinks=true, urlcolor = {blue}, linkcolor = {blue}}
- \renewcommand{\linethickness}{0.05em}
editor_options:
  chunk_output_type: console
always_allow_html: yes
---

<script src="/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/rmarkdown-libs/plotly-binding/plotly.js"></script>
<script src="/rmarkdown-libs/typedarray/typedarray.min.js"></script>
<script src="/rmarkdown-libs/jquery/jquery.min.js"></script>
<link href="/rmarkdown-libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
<script src="/rmarkdown-libs/crosstalk/js/crosstalk.min.js"></script>
<link href="/rmarkdown-libs/plotly-htmlwidgets-css/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="/rmarkdown-libs/plotly-main/plotly-latest.min.js"></script>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#système-graphique-de-base-en-r">Système graphique de base en R</a><ul>
<li><a href="#procédure-de-création-dun-graphique">Procédure de création d’un graphique</a></li>
<li><a href="#fonction-générique-plot">Fonction générique <code>plot</code></a></li>
<li><a href="#différentes-fonctions-graphiques">Différentes fonctions graphiques</a><ul>
<li><a href="#exemple-de-diagramme-de-dispersion---fonctions-plot.default-pairs-et-matplot">Exemple de diagramme de dispersion - fonctions <code>plot.default</code>, <code>pairs</code> et <code>matplot</code></a></li>
<li><a href="#exemple-de-diagramme-en-lignes---fonctions-plot.default-et-matplot">Exemple de diagramme en lignes - fonctions <code>plot.default</code> et <code>matplot</code></a></li>
<li><a href="#exemple-de-diagramme-en-secteurs---fonction-pie">Exemple de diagramme en secteurs - fonction <code>pie</code></a></li>
<li><a href="#exemple-de-diagramme-à-barres---fonction-barplot">Exemple de diagramme à barres - fonction <code>barplot</code></a></li>
<li><a href="#exemple-de-diagramme-en-points-de-cleveland---fonction-dotchart">Exemple de diagramme en points de Cleveland - fonction <code>dotchart</code></a></li>
<li><a href="#exemple-de-diagramme-en-mosaïque---fonction-mosaicplot">Exemple de diagramme en mosaïque - fonction <code>mosaicplot</code></a></li>
<li><a href="#exemple-dhistogramme---fonction-hist">Exemple d’histogramme - fonction <code>hist</code></a></li>
<li><a href="#exemple-de-diagramme-en-boîte---fonction-boxplot">Exemple de diagramme en boîte - fonction <code>boxplot</code></a></li>
<li><a href="#exemple-de-courbe-destimation-de-densité-à-noyau---méthode-plot.density">Exemple de courbe d’estimation de densité à noyau - méthode <code>plot.density</code></a></li>
<li><a href="#exemple-de-diagramme-quantile-quantile---fonctions-qqnorm-et-qqplot">Exemple de diagramme quantile-quantile - fonctions <code>qqnorm</code> et <code>qqplot</code></a></li>
<li><a href="#exemple-de-représentation-graphique-dune-expression-mathématique---fonction-curve">Exemple de représentation graphique d’une expression mathématique - fonction <code>curve</code></a></li>
</ul></li>
<li><a href="#arguments-et-paramètres-graphiques">Arguments et paramètres graphiques</a><ul>
<li><a href="#couleurs">Couleurs</a></li>
</ul></li>
<li><a href="#ajout-déléments-à-un-graphique">Ajout d’éléments à un graphique</a><ul>
<li><a href="#exemple-dajout-de-lignes---fonctions-abline-vs-lines">Exemple d’ajout de lignes - fonctions <code>abline</code> vs <code>lines</code></a></li>
<li><a href="#exemple-dajout-dune-légende---fonction-legend">Exemple d’ajout d’une légende - fonction <code>legend</code></a></li>
<li><a href="#exemple-dajout-de-courbes-à-un-histogramme-et-dune-légende">Exemple d’ajout de courbes à un histogramme et d’une légende</a></li>
</ul></li>
<li><a href="#possibilités-graphiques-spécifiques">Possibilités graphiques spécifiques</a><ul>
<li><a href="#annotations-mathématiques">Annotations mathématiques</a></li>
<li><a href="#plusieurs-graphiques-dans-une-même-fenêtre">Plusieurs graphiques dans une même fenêtre</a></li>
</ul></li>
<li><a href="#aspects-techniques">Aspects techniques</a><ul>
<li><a href="#fenêtres-graphiques">Fenêtres graphiques</a></li>
<li><a href="#enregistrer-un-graphique">Enregistrer un graphique</a></li>
<li><a href="#autres-fonctions-et-trucs-utiles">Autres fonctions et trucs utiles</a></li>
</ul></li>
<li><a href="#résumé-et-point-de-vue">Résumé et point de vue</a></li>
</ul></li>
<li><a href="#package-lattice">Package <code>lattice</code></a></li>
<li><a href="#package-ggplot2">Package <code>ggplot2</code></a><ul>
<li><a href="#la-grammaire-graphique">La grammaire graphique</a></li>
<li><a href="#principales-fonctions-et-gabarit-de-code">Principales fonctions et gabarit de code</a></li>
<li><a href="#objet-de-classe-ggplot---production-et-enregistrement-du-graphique">Objet de classe <code>ggplot</code> - production et enregistrement du graphique</a></li>
<li><a href="#démarche-de-création-dun-graphique-ggplot2">Démarche de création d’un graphique <code>ggplot2</code></a></li>
<li><a href="#exemples-de-configurations-graphiques-simples">Exemples de configurations graphiques simples</a><ul>
<li><a href="#ajout-dun-titre-et-de-noms-daxes---fonction-labs">Ajout d’un titre et de noms d’axes - fonction <code>labs</code></a></li>
<li><a href="#ajout-dune-variable-associée-à-une-propriété-visuelle-autre-quun-axe">Ajout d’une variable associée à une propriété visuelle autre qu’un axe</a></li>
<li><a href="#échelles-de-couleurs---fonctions-de-type-scale_colour_-et-scale_fill_">Échelles de couleurs - fonctions de type <code>scale_colour_</code> et <code>scale_fill_</code></a></li>
<li><a href="#ajout-de-variables-par-lintermédiaire-dune-grille-de-sous-graphiques-facets">Ajout de variables par l’intermédiaire d’une grille de sous-graphiques (<em>facets</em>)</a></li>
</ul></li>
<li><a href="#exemples-de-graphiques-de-différents-types">Exemples de graphiques de différents types</a><ul>
<li><a href="#diagramme-à-barres---fonctions-geom_bar-et-geom_col">Diagramme à barres - fonctions <code>geom_bar</code> et <code>geom_col</code></a></li>
<li><a href="#diagramme-en-secteurs---coordonnées-polaires-avec-coord_polar">Diagramme en secteurs - coordonnées polaires avec <code>coord_polar</code></a></li>
<li><a href="#conversion-dune-variable-en-facteur---fonction-factor">Conversion d’une variable en facteur - fonction <code>factor</code></a></li>
<li><a href="#courbes-de-densité-à-noyau-superposées---fonction-geom_density">Courbes de densité à noyau superposées - fonction <code>geom_density</code></a></li>
<li><a href="#diagrammes-en-violon-juxtaposés---fonction-geom_violin">Diagrammes en violon juxtaposés - fonction <code>geom_violin</code></a></li>
<li><a href="#diagrammes-en-boîtes-juxtaposés---fonction-geom_boxplot">Diagrammes en boîtes juxtaposés - fonction <code>geom_boxplot</code></a></li>
</ul></li>
<li><a href="#exemples-divers-plus-poussés">Exemples divers plus poussés</a><ul>
<li><a href="#solutions-aux-observations-superposées-overplotting">Solutions aux observations superposées (<em>overplotting</em>)</a></li>
<li><a href="#représentation-graphique-dune-fonction">Représentation graphique d’une fonction</a></li>
<li><a href="#mise-en-forme-dune-légende">Mise en forme d’une légende</a></li>
</ul></li>
<li><a href="#packages-souvent-utilisés-avec-ggplot2-et-extensions-de-ggplot2">Packages souvent utilisés avec <code>ggplot2</code> et extensions de <code>ggplot2</code></a><ul>
<li><a href="#le-tidyverse">Le <code>tidyverse</code></a></li>
<li><a href="#extensions">Extensions</a></li>
</ul></li>
<li><a href="#comparaison-entre-ggplot2-et-le-système-graphique-r-de-base">Comparaison entre <code>ggplot2</code> et le système graphique R de base</a></li>
</ul></li>
<li><a href="#autres-possibilités-graphiques-en-r-seulement-mentionnées">Autres possibilités graphiques en R (seulement mentionnées)</a><ul>
<li><a href="#graphiques-3d">Graphiques 3D</a><ul>
<li><a href="#fonction-persp-du-système-de-base">Fonction <code>persp</code> du système de base</a></li>
<li><a href="#graphiques-3d-orientables---package-rgl">Graphiques 3D orientables - package <code>rgl</code></a></li>
</ul></li>
<li><a href="#cartes-géographiques">Cartes géographiques</a><ul>
<li><a href="#packages-maps-et-mapdata">Packages <code>maps</code> et <code>mapdata</code></a></li>
<li><a href="#autres-packages-pour-lintégration-de-cartes-géographiques-dans-un-graphique-r">Autres packages pour l’intégration de cartes géographiques dans un graphique R</a></li>
</ul></li>
<li><a href="#graphiques-interactifs">Graphiques interactifs</a><ul>
<li><a href="#graphiques-interactifs-plotly---package-plotly">Graphiques interactifs Plotly - package <code>plotly</code></a></li>
<li><a href="#autres-packages-pour-la-création-de-graphiques-interactifs-en-r">Autres packages pour la création de graphiques interactifs en R</a></li>
</ul></li>
</ul></li>
<li><a href="#conclusion">Conclusion</a></li>
<li><a href="#résumé">Résumé</a></li>
<li><a href="#références">Références</a></li>
<li><a href="#annexe">Annexe</a><ul>
<li><a href="#graphiques-produits-par-plot-selon-les-types-dobjets-donnés-en-entrée-aux-arguments-x-et-y">Graphiques produits par <code>plot</code> selon les types d’objets donnés en entrée aux arguments <code>x</code> et <code>y</code></a></li>
</ul></li>
</ul>
</div>

<hr />
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<div id="la-visualisation-graphique-une-étape-importante-en-analyse-de-données" class="section level4">
<h4>La visualisation graphique, une étape importante en analyse de données</h4>

<p>La communauté statistique insiste depuis longtemps sur l’importance de visualiser graphiquement des données avant de les analyser. En 1973, Anscombe<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> publiait les <a href="https://fr.wikipedia.org/wiki/Quartet_d%27Anscombe">quatre jeux de données suivants</a>, ayant les mêmes paramètres estimés de régression linéaire simple (<span class="math inline">\(y = 3 + 0.5x\)</span>), mais présentant des relations bien différentes!</p>
<p><img src="fig/AnscombeHoriz.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Plusieurs autres exemples de <a href="https://www.autodeskresearch.com/publications/samestats">jeux de données possédant les mêmes statistiques descriptives, mais des représentations graphiques très différentes</a> ont été publiés depuis<a href="#fn2" class="footnote-ref" id="fnref2"><sup>2</sup></a>.</p>
<p>Certains ont même mis en évidence l’importance de représenter graphiquement des données de plusieurs manières différentes afin de découvrir les surprises qu’elles peuvent cacher. Par exemple, les données suivantes, créées pour enseigner à des étudiants l’importance des graphiques en analyse de données<a href="#fn3" class="footnote-ref" id="fnref3"><sup>3</sup></a>, forment le mot SUPERMAN si elles sont représentées sur une échelle adéquatement transformée et si les observations des deux groupes sont superposées.</p>
<p><img src="fig/Superman.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="les-graphiques-une-force-de-r" class="section level4">
<h4>Les graphiques, une force de R</h4>

<p>En plus d’être un environnement de calculs statistiques, R permet de produire des graphiques. Il s’agit d’une utilité importante de R. La toute première phrase du <a href="https://www.r-project.org">site web de R</a> mentionne cette utilité.</p>
<blockquote>
<p>« R is a free software environment for statistical computing and graphics. »</p>
</blockquote>
<p>Lors de comparaison entre R et d’autres logiciels permettant de faire de l’analyse de données, les capacités graphiques de R sont souvent considérées comme un de ses meilleurs atouts<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a><a href="#fn5" class="footnote-ref" id="fnref5"><sup>5</sup></a>.</p>
<p>L’installation de base de R comporte beaucoup de fonctions graphiques. La première partie de ces notes présente ces fonctions. Elles permettent de produire des graphiques pour lesquels l’utilisateur garde le plein contrôle sur l’apparence du graphique.</p>
<p>De plus, deux packages offrent des fonctions pouvant remplacer plusieurs des fonctions graphiques de base de R. Chacun de ces packages est tellement complet qu’il peut être qualifié de système graphique. Il s’agit des packages suivants :</p>
<ul>
<li><a href="https://CRAN.R-project.org/package=lattice"><code>lattice</code></a> : package graphique qui met l’emphase sur les représentations multivariables,</li>
<li><a href="https://CRAN.R-project.org/package=ggplot2"><code>ggplot2</code></a> : package graphique conçu en ayant comme objectif la simplicité d’utilisation et la qualité des graphiques produits.</li>
</ul>
<p>Le package <code>lattice</code> n’est présenté que très brièvement dans ce document, mais l’utilisation du package <code>ggplot2</code> est abordée avec assez de détails pour bien démarer un apprentissage de cet outil très populaire.</p>
<p>Pour finir, quelques autres possibilités graphiques en R sont mentionnées rapidement à la fin de ce document, notamment les :</p>
<ul>
<li>graphiques 3D,</li>
<li>cartes géographiques,</li>
<li>graphiques interactifs.</li>
</ul>
<p>La grande quantité de possibilités graphiques en R contribue à en faire un puissant outil de visualisation de données.</p>
</div>
<div id="présentation-des-données-utilisées-pour-les-exemples" class="section level4">
<h4>Présentation des données utilisées pour les exemples</h4>

<p>Plusieurs des exemples de graphiques de ces notes représentent les mêmes données : celles stockées dans le <a href="https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/quakes.html">data frame <code>quakes</code></a> du package <code>datasets</code> (chargé par défaut lors de l’ouverture de session).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">str</span>(quakes)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1000 obs. of  5 variables:
##  $ lat     : num  -20.4 -20.6 -26 -18 -20.4 ...
##  $ long    : num  182 181 184 182 182 ...
##  $ depth   : int  562 650 42 626 649 195 82 194 211 622 ...
##  $ mag     : num  4.8 4.2 5.4 4.1 4 4 4.8 4.4 4.7 4.3 ...
##  $ stations: int  41 15 43 19 11 12 43 15 35 19 ...</code></pre>
<p>Il s’agit d’observations pour 1000 évènements sismiques survenus près des îles Fidji depuis 1964. Pour chaque évènement, nous avons :</p>
<ul>
<li><code>lat</code> et <code>long</code> : sa localisation géographique en latitude-longitude,</li>
<li><code>depth</code> : sa <a href="https://fr.wikipedia.org/wiki/S%C3%A9isme">profondeur</a>,</li>
<li><code>mag</code> : sa <a href="https://fr.wikipedia.org/wiki/Magnitude_d%27un_s%C3%A9isme">magnitude</a> et</li>
<li><code>stations</code> : le nombre de stations sismiques ayant rapporté l’évènement.</li>
</ul>
<p>Pour certains exemples, nous aurons besoin de variables catégoriques stockées sous forme de facteur. Ajoutons donc les deux variables supplémentaires suivantes au jeu de données <code>quakes</code> :</p>
<ul>
<li><code>mag_catego</code> : magnitude du séisme arrondie à l’entier inférieur (4, 5 ou 6),</li>
<li><code>region</code> : région où à eu lieu le séisme (<code>"Ouest"</code> ou <code>"Est"</code>).</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">quakes<span class="op">$</span>mag_catego &lt;-<span class="st"> </span><span class="kw">factor</span>(<span class="kw">floor</span>(quakes<span class="op">$</span>mag))</a>
<a class="sourceLine" id="cb3-2" title="2">quakes<span class="op">$</span>region &lt;-<span class="st"> </span><span class="kw">factor</span>(quakes<span class="op">$</span>long <span class="op">&gt;=</span><span class="st"> </span><span class="dv">175</span>, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Ouest&quot;</span>, <span class="st">&quot;Est&quot;</span>))</a></code></pre></div>
<div id="remarque-concernant-la-présence-de-deux-objets-nommés-quakes-dans-le-chemin-de-recherche" class="section level5">
<h5>Remarque concernant la présence de deux objets nommés <code>quakes</code> dans le chemin de recherche :</h5>

<p>Nous avons maintenant deux objets nommés <code>quakes</code> dans notre chemin de recherche, parce que nous venons d’ajouter des variables au data frame. Le data frame modifié, soit celui avec les variables ajoutées, est situé dans notre environnement de travail. Alors que le data frame <code>quakes</code> original est toujours dans l’environnement du package <code>datasets</code>. Celui-là n’a pas été modifié.</p>
<p>Le chemin de recherche de notre session R, pour une commande soumise dans la console, est le suivant.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">search</span>()</a></code></pre></div>
<pre><code>## [1] &quot;.GlobalEnv&quot;        &quot;package:stats&quot;     &quot;package:graphics&quot; 
## [4] &quot;package:grDevices&quot; &quot;package:utils&quot;     &quot;package:datasets&quot; 
## [7] &quot;package:methods&quot;   &quot;Autoloads&quot;         &quot;package:base&quot;</code></pre>
<p>Lorsque nous demandons à R d’accéder à l’objet nommé <code>quakes</code>, il cherche ce nom dans les environnements de son chemin de recherche, un environnement à la fois, en respectant l’ordre des environnements dans la liste précédente. L’environnement <code>".GlobalEnv"</code>, soit notre environnement de travail, est le premier de la liste. Lorsque R trouve le nom, il cesse sa recherche. Ainsi, toute commande dans la console contenant le nom <code>quakes</code>, accédera à l’objet nommé <code>quakes</code> de notre environnement de travail.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">str</span>(quakes)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1000 obs. of  7 variables:
##  $ lat       : num  -20.4 -20.6 -26 -18 -20.4 ...
##  $ long      : num  182 181 184 182 182 ...
##  $ depth     : int  562 650 42 626 649 195 82 194 211 622 ...
##  $ mag       : num  4.8 4.2 5.4 4.1 4 4 4.8 4.4 4.7 4.3 ...
##  $ stations  : int  41 15 43 19 11 12 43 15 35 19 ...
##  $ mag_catego: Factor w/ 3 levels &quot;4&quot;,&quot;5&quot;,&quot;6&quot;: 1 1 2 1 1 1 1 1 1 1 ...
##  $ region    : Factor w/ 2 levels &quot;Ouest&quot;,&quot;Est&quot;: 2 2 2 2 2 2 1 2 2 2 ...</code></pre>
<p>Il est possible de forcer R à aller chercher l’objet <code>quakes</code> dans le package <code>datasets</code> avec l’opérateur <code>::</code>.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">str</span>(datasets<span class="op">::</span>quakes)</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1000 obs. of  5 variables:
##  $ lat     : num  -20.4 -20.6 -26 -18 -20.4 ...
##  $ long    : num  182 181 184 182 182 ...
##  $ depth   : int  562 650 42 626 649 195 82 194 211 622 ...
##  $ mag     : num  4.8 4.2 5.4 4.1 4 4 4.8 4.4 4.7 4.3 ...
##  $ stations: int  41 15 43 19 11 12 43 15 35 19 ...</code></pre>
<p>Nous reviendrons sur le fonctionnement des évaluations en R dans un autre cours.</p>
<hr />
</div>
</div>
</div>
<div id="système-graphique-de-base-en-r" class="section level1">
<h1>Système graphique de base en R</h1>
<p>Les graphiques de base en R sont créés grâce aux fonctions provenant des packages <code>graphics</code> et <code>grDevices</code> développés par le <em>R core team</em>. Ces packages sont intégrés à l’installation de base de R et ils sont chargés par défaut lors de l’ouverture d’une session R. Dans cette section, nous couvrirons les possibilités de ces packages.</p>
<div id="procédure-de-création-dun-graphique" class="section level2">
<h2>Procédure de création d’un graphique</h2>
<p>Un programme pour créer un graphique avec le système graphique de base en R se décompose typiquement en 3 étapes, les suivantes :</p>
<ol style="list-style-type: decimal">
<li>La configuration des paramètres graphiques (au besoin) :
<ul>
<li>énoncé <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/par.html"><code>par</code></a> ou <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/layout.html"><code>layout</code></a>.</li>
</ul></li>
<li>L’initialisation d’un graphique :
<ul>
<li>fonction de base : <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.html"><code>plot</code></a> (choisit un graphique pertinent à produire selon ce qu’elle reçoit en entrée),</li>
<li>ou fonction pour un type spécifique graphiques : <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/pairs.html"><code>pairs</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/matplot.html"><code>matplot</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/pie.html"><code>pie</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/dotchart.html"><code>barplot</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/mosaicplot.html"><code>dotchart</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/mosaicplot.html"><code>mosaicplot</code></a>, <a href="http://stat.ethz.ch/R-manual/R-devel/library/graphics/html/hist.html"><code>hist</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/boxplot.html"><code>boxplot</code></a>, <a href="http://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqnorm</code></a>, <a href="http://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqplot</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/curve.html"><code>curve</code></a>, etc.</li>
</ul></li>
<li>L’ajout séquentiel d’éléments au graphique (au besoin) :
<ul>
<li>fonctions d’ajouts à un graphique déjà initialisé :
<ul>
<li><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/points.html"><code>points</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/matplot.html"><code>matpoints</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/lines.html"><code>lines</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/matplot.html"><code>matlines</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/abline.html"><code>abline</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/segments.html"><code>segments</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/arrows.html"><code>arrows</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/rect.html"><code>rect</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/polygon.html"><code>polygon</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/legend.html"><code>legend</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/text.html"><code>text</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/mtext.html"><code>mtext</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/title.html"><code>title</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/axis.html"><code>axis</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/box.html"><code>box</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqline</code></a>, etc.;</li>
<li><code>matplot</code>, <code>barplot</code>, <code>hist</code>, <code>boxplot</code>, <code>curve</code> avec l’argument <code>add = TRUE</code>.</li>
</ul></li>
</ul></li>
</ol>
<p>Lorsque les paramètres graphiques sont modifiés avec un appel à la fonction <code>par</code> au début du programme, une bonne pratique est d’ajouter aussi à la fin du programme une commande pour redonner aux paramètres graphiques leurs valeurs par défaut.</p>
<p>La mise en forme et les annotations du graphique (p. ex. titre et noms d’axe) sont déterminées par les paramètres graphiques ainsi que par des arguments des fonctions graphiques. Avec un peu de patience et quelques lignes de code, il est possible d’arriver à contrôler parfaitement l’apparence du graphique.</p>
<p>Voici un exemple de programme créant un graphique avec le système graphique de base en R.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co"># 1. Configuration de paramètres graphiques</span></a>
<a class="sourceLine" id="cb10-2" title="2">par.default &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">bty =</span> <span class="st">&#39;n&#39;</span>)</a>
<a class="sourceLine" id="cb10-3" title="3"></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co"># 2. Initialisation d&#39;un graphique (contenant ici des diagrammes en boîtes)</span></a>
<a class="sourceLine" id="cb10-5" title="5"><span class="kw">plot</span>(stations <span class="op">~</span><span class="st"> </span>mag_catego, <span class="dt">data =</span> quakes, <span class="dt">lwd =</span> <span class="fl">1.5</span>, <span class="dt">outline =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb10-6" title="6">     <span class="dt">main =</span> <span class="st">&quot;Nombres de stations ayant rapporté les séismes</span><span class="ch">\n</span><span class="st">selon leurs classes de magnitude&quot;</span>,</a>
<a class="sourceLine" id="cb10-7" title="7">     <span class="dt">xlab =</span> <span class="st">&quot;classe de magnitude&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;nombre de stations&quot;</span>)</a>
<a class="sourceLine" id="cb10-8" title="8"></a>
<a class="sourceLine" id="cb10-9" title="9"><span class="co"># 3. Ajout séquentiel d&#39;éléments au graphique</span></a>
<a class="sourceLine" id="cb10-10" title="10"><span class="co"># Ajout de diagrammes de dispersion 1D par région</span></a>
<a class="sourceLine" id="cb10-11" title="11"><span class="kw">stripchart</span>(stations <span class="op">~</span><span class="st"> </span>mag_catego, <span class="dt">data =</span> quakes, <span class="dt">subset =</span> region <span class="op">==</span><span class="st"> &quot;Est&quot;</span>,</a>
<a class="sourceLine" id="cb10-12" title="12">           <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">jitter =</span> <span class="fl">0.3</span>, <span class="dt">pch =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb10-13" title="13">           <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.2</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">vertical =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-14" title="14"><span class="kw">stripchart</span>(stations <span class="op">~</span><span class="st"> </span>mag_catego, <span class="dt">data =</span> quakes, <span class="dt">subset =</span> region <span class="op">==</span><span class="st"> &quot;Ouest&quot;</span>,</a>
<a class="sourceLine" id="cb10-15" title="15">           <span class="dt">method =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">jitter =</span> <span class="fl">0.3</span>, <span class="dt">pch =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb10-16" title="16">           <span class="dt">col =</span> <span class="kw">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.2</span>), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">vertical =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-17" title="17"><span class="co"># Ajout d&#39;une légende</span></a>
<a class="sourceLine" id="cb10-18" title="18"><span class="kw">legend</span>(<span class="dt">x =</span> <span class="st">&quot;bottomright&quot;</span>, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, </a>
<a class="sourceLine" id="cb10-19" title="19">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="kw">rgb</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>,<span class="fl">0.5</span>), <span class="kw">rgb</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="fl">0.5</span>)),</a>
<a class="sourceLine" id="cb10-20" title="20">       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Est&quot;</span>, <span class="st">&quot;Ouest&quot;</span>), <span class="dt">title =</span> <span class="st">&quot;région&quot;</span>)</a>
<a class="sourceLine" id="cb10-21" title="21"></a>
<a class="sourceLine" id="cb10-22" title="22"><span class="co"># Réattribution des valeurs par défaut aux paramètres graphiques modifiés</span></a>
<a class="sourceLine" id="cb10-23" title="23"><span class="kw">par</span>(par.default)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-7-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Les prochaines sections présentent les concepts à connaître pour suivre la procédure de création de graphique avec le système graphique de base en R et contiennent beaucoup d’exemples. Cependant, la matière n’est pas couverte dans le même ordre que les étapes de la procédure. Même si dans le code de création d’un graphique la configuration des paramètres est l’étape 1, il faut d’abord savoir créer un graphique pour que cette étape ait du sens. De plus, la configuration des paramètres graphique est une étape facultative. Parfois, les valeurs par défaut des paramètres font l’affaire.</p>
<p>Ainsi, nous allons d’abord étudier la principale fonction du système graphique de base en R, soit la fonction <code>plot</code>. Dans un deuxième temps, nous ferons un survol de plusieurs autres fonctions de création de graphiques. Ensuite, les arguments et paramètres graphiques qui permettent de contrôler les annotations et la mise en forme seront présentés. Pour terminer la couverture des étapes de la procédure de création, il ne restera plus qu’à parler des fonctions d’ajouts d’éléments à un graphique.</p>
<p>Les exemples présentés seront simple au début, mais se complexifient au fil de la section.</p>
</div>
<div id="fonction-générique-plot" class="section level2">
<h2>Fonction générique <code>plot</code></h2>
<p>La principale fonction graphique en R est la fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.html"><code>plot</code></a>. En fait, <code>plot</code> est une fonction générique. Il existe plusieurs méthodes associées à cette fonction générique. Pour afficher la liste des méthodes <code>plot</code> chargées dans notre session R, il faut soumettre la commande suivante.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">methods</span>(plot)</a></code></pre></div>
<pre><code>##  [1] plot.acf*           plot.data.frame*    plot.decomposed.ts* plot.default       
##  [5] plot.dendrogram*    plot.density*       plot.ecdf           plot.factor*       
##  [9] plot.formula*       plot.function       plot.hclust*        plot.histogram*    
## [13] plot.HoltWinters*   plot.isoreg*        plot.lm*            plot.medpolish*    
## [17] plot.mlm*           plot.ppr*           plot.prcomp*        plot.princomp*     
## [21] plot.profile.nls*   plot.raster*        plot.spec*          plot.stepfun       
## [25] plot.stl*           plot.table*         plot.ts             plot.tskernel*     
## [29] plot.TukeyHSD*     
## see &#39;?methods&#39; for accessing help and source code</code></pre>
<p>Si nous donnons en entrée à la fonction <code>plot</code> un vecteur en argument <code>x</code>, c’est la méthode <code>plot.default</code> qui est utilisée. Cette méthode trace un diagramme de dispersion.</p>
<p>La fonction <code>plot</code> choisit la méthode à utiliser en fonction de la classe de l’objet assigné à son premier argument (<code>x</code>). C’est une caractéristique « orientée objet » du langage R. Nous reviendrons sur ce concept plus tard. Pour l’instant, il suffit de comprendre que les différentes méthodes produisent différents résultats et acceptent différents arguments. En fait, ces méthodes font souvent appels à d’autres fonctions de création de graphique.</p>
<p>L’<a href="#annexe">annexe</a> contient une panoplie d’exemples de graphiques pouvant être produits avec la fonction générique <code>plot</code>, selon les objets qui lui sont donnés en entrée. Voici ici un résumé des possibilités couvertes dans ces exemples.</p>
<div id="résumé-de-graphiques-usuels-produits-par-plot" class="section level4">
<h4>Résumé de graphiques usuels produits par <code>plot</code></h4>
<table>
<colgroup>
<col width="9%" />
<col width="8%" />
<col width="81%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Type <code>x</code></strong></th>
<th><strong>Type <code>y</code></strong></th>
<th><strong>Graphique produit</strong> (<strong>méthode</strong> utilisée <span class="math inline">\(\rightarrow\)</span> fonction ou autre méthode appelée)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>vecteur</td>
<td>-</td>
<td>diagramme de dispersion en fonction de l’index des observations (<code>plot.default</code>)</td>
</tr>
<tr class="even">
<td> </td>
<td>vecteur</td>
<td>diagramme de dispersion (<code>plot.default</code>)</td>
</tr>
<tr class="odd">
<td>facteur</td>
<td>-</td>
<td>diagramme à barres (<code>plot.factor</code> <span class="math inline">\(\rightarrow\)</span> <code>barplot</code>)</td>
</tr>
<tr class="even">
<td> </td>
<td>vecteur</td>
<td>diagrammes en boîtes juxtaposées (<code>plot.factor</code> <span class="math inline">\(\rightarrow\)</span> <code>boxplot</code>)</td>
</tr>
<tr class="odd">
<td> </td>
<td>facteur</td>
<td>diagramme en mosaïque (<code>plot.factor</code> <span class="math inline">\(\rightarrow\)</span> <code>spineplot</code>)</td>
</tr>
<tr class="even">
<td>data frame</td>
<td>-</td>
<td>dépend du nombre de variables, de leur ordre et de leurs natures (<code>plot.data.frame</code> <span class="math inline">\(\rightarrow\)</span> <code>pairs</code>, <code>plot.default</code>, <code>plot.factor</code> ou <code>stripchart</code>)</td>
</tr>
<tr class="odd">
<td>formule</td>
<td>-</td>
<td>dépend de la position des variables dans la formule et de leurs natures (<code>plot.formula</code> <span class="math inline">\(\rightarrow\)</span> <code>plot.default</code>, <code>plot.factor</code> ou <code>plot.data.frame</code>)</td>
</tr>
<tr class="even">
<td>fonction</td>
<td>-</td>
<td>courbe (<code>plot.function</code> <span class="math inline">\(\rightarrow\)</span> <code>curve</code>)</td>
</tr>
</tbody>
</table>
<p>La fonction <code>plot</code> peut en faire beaucoup plus que ça grâce à ses nombreuses méthodes. Par exemple, comme nous l’avons déjà mentionné dans les notes sur les <a href="https://stt4230.rbind.io/introduction/base_r/#est-ce-que-de-la-programmation-orient%C3%A9e-objet-est-possible-en-r">concepts de base en R</a>, si elle reçoit en entrée la sortie d’un appel à la fonction <code>lm</code>, qui ajuste un modèle linéaire à des données, elle produit des graphiques de résidus de ce modèle via sa méthode <code>plot.lm</code>.</p>
</div>
</div>
<div id="différentes-fonctions-graphiques" class="section level2">
<h2>Différentes fonctions graphiques</h2>
<p>En explorant les capacités de la fonction générique <code>plot</code>, nous découvrons plusieurs fonctions de création de graphiques. Ces fonctions permettent de créer des graphiques de différents types.</p>
<p>Voici un résumé des principaux types de graphiques pouvant être créés dans le système graphique de base en R, suivi d’exemples.</p>
<p><strong>Représentations d’une variable (observations stockées dans <code>x</code>)</strong> :</p>
<table>
<colgroup>
<col width="49%" />
<col width="30%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th>Type de graphique</th>
<th>Exemple d’appel de fonction</th>
<th>Type de <code>x</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://en.wikipedia.org/wiki/Pie_chart">diagramme en secteurs (<em>pie chart</em>)</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/pie.html"><code>pie</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/table.html"><code>table</code></a><code>(x), ...)</code></td>
<td>facteur</td>
</tr>
<tr class="even">
<td><a href="https://en.wikipedia.org/wiki/Bar_chart">diagramme à barres (<em>bar plot</em>)</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/barplot.html"><code>barplot</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/table.html"><code>table</code></a><code>(x), ...)</code></td>
<td>facteur</td>
</tr>
<tr class="odd">
<td><a href="https://en.wikipedia.org/wiki/Dot_plot_(statistics)">diagramme en points de Cleveland</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/dotchart.html"><code>dotchart</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/table.html"><code>table</code></a><code>(x), ...)</code></td>
<td>facteur</td>
</tr>
<tr class="even">
<td><a href="https://en.wikipedia.org/wiki/Histogram">histogramme</a></td>
<td><a href="http://stat.ethz.ch/R-manual/R-devel/library/graphics/html/hist.html"><code>hist</code></a><code>(x, ...)</code></td>
<td>vecteur numérique</td>
</tr>
<tr class="odd">
<td><a href="https://en.wikipedia.org/wiki/Kernel_density_estimation">courbe de densité à noyau (<em>kernel density plot</em>)</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.html"><code>plot</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/density.html"><code>density</code></a><code>(x), ...)</code> <span class="math inline">\(\rightarrow\)</span> méthode <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/plot.density.html"><code>plot.density</code></a></td>
<td>vecteur numérique</td>
</tr>
<tr class="even">
<td><a href="https://en.wikipedia.org/wiki/Box_plot">diagramme en boîte (<em>boxplot</em>)</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/boxplot.html"><code>boxplot</code></a><code>(x, ...)</code></td>
<td>vecteur numérique</td>
</tr>
<tr class="odd">
<td><a href="https://fr.wikipedia.org/wiki/Diagramme_Quantile-Quantile">diagramme quantile-quantile théorique normal</a></td>
<td><a href="http://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqnorm</code></a><code>(x, ...)</code></td>
<td>vecteur numérique</td>
</tr>
</tbody>
</table>
<p><strong>Représentation d’une expression mathématique</strong> : <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/curve.html"><code>curve</code></a><code>(expr, ...)</code></p>
<p><strong>Représentations de deux variables (observations stockées dans <code>x</code> et <code>y</code>)</strong> :</p>
<table>
<colgroup>
<col width="32%" />
<col width="40%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th>Type de graphique</th>
<th>Exemple d’appel de fonction</th>
<th>Type de <code>x</code></th>
<th>Type de <code>y</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://en.wikipedia.org/wiki/Bar_chart">diagramme à barres empilées ou groupées</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/barplot.html"><code>barplot</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/table.html"><code>table</code></a><code>(x, y), ...)</code> avec <code>beside = TRUE</code> pour barres groupées</td>
<td>facteur</td>
<td>facteur</td>
</tr>
<tr class="even">
<td><a href="https://en.wikipedia.org/wiki/Dot_plot_(statistics)">diagramme en points de Cleveland</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/dotchart.html"><code>dotchart</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/table.html"><code>table</code></a><code>(x, y), ...)</code></td>
<td>facteur</td>
<td>facteur</td>
</tr>
<tr class="odd">
<td><a href="https://en.wikipedia.org/wiki/Mosaic_plot">diagramme en mosaïque</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/mosaicplot.html"><code>mosaicplot</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/table.html"><code>table</code></a><code>(x, y), ...)</code></td>
<td>facteur</td>
<td>facteur</td>
</tr>
<tr class="even">
<td><a href="https://en.wikipedia.org/wiki/Box_plot">diagrammes en boîte juxtaposés</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/boxplot.html"><code>boxplot</code></a><code>(y ~ x, ...)</code></td>
<td>facteur</td>
<td>vecteur numérique</td>
</tr>
<tr class="odd">
<td><a href="https://en.wikipedia.org/wiki/Scatter_plot">diagramme de dispersion (<em>scatterplot</em>)</a> ou <a href="https://en.wikipedia.org/wiki/Line_chart">en lignes (<em>line chart</em>)</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.html"><code>plot</code></a><code>(x, y, ...)</code> <span class="math inline">\(\rightarrow\)</span> méthode <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.default.html"><code>plot.default</code></a></td>
<td>vecteur numérique</td>
<td>vecteur numérique</td>
</tr>
<tr class="even">
<td><a href="https://fr.wikipedia.org/wiki/Diagramme_Quantile-Quantile">diagramme quantile-quantile empirique</a></td>
<td><a href="http://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqplot</code></a><code>(x, y, ...)</code></td>
<td>vecteur numérique</td>
<td>vecteur numérique</td>
</tr>
</tbody>
</table>
<p><strong>Représentation de plus de trois variables numériques</strong> :</p>
<ul>
<li>matrice de diagrammes de dispersion : <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/pairs.html"><code>pairs</code></a><code>( ~ x + y + z, ...)</code></li>
<li>diagrammes de dispersion superposés : <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/matplot.html"><code>matplot</code></a><code>(matriceX, matriceY, ...)</code></li>
</ul>
<div id="exemple-de-diagramme-de-dispersion---fonctions-plot.default-pairs-et-matplot" class="section level3">
<h3>Exemple de diagramme de dispersion - fonctions <code>plot.default</code>, <code>pairs</code> et <code>matplot</code></h3>
<p>La méthode <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.default.html"><code>plot.default</code></a> (via la fonction générique <code>plot</code> ou directement) produit un <a href="https://en.wikipedia.org/wiki/Scatter_plot">diagramme de dispersion (<em>scatterplot</em>)</a> par défault.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb13-2" title="2">  <span class="dt">x =</span> quakes<span class="op">$</span>mag, <span class="dt">y =</span> quakes<span class="op">$</span>stations,</a>
<a class="sourceLine" id="cb13-3" title="3">  <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>, </a>
<a class="sourceLine" id="cb13-4" title="4">  <span class="dt">ylab =</span> <span class="st">&quot;nombre de stations rapportant le séisme&quot;</span></a>
<a class="sourceLine" id="cb13-5" title="5">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-9-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>La fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/pairs.html"><code>pairs</code></a> produit quant à elle une matrice de diagrammes de dispersion entre plusieurs paires de variables.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">pairs</span>( <span class="op">~</span><span class="st"> </span>depth <span class="op">+</span><span class="st"> </span>mag <span class="op">+</span><span class="st"> </span>stations, <span class="dt">data =</span> quakes)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-10-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>La fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/matplot.html"><code>matplot</code></a> permet de facilement superposer plusieurs diagrammes de dispersion. Elle associe les colonnes de la structure à deux dimensions fournie en <code>x</code> à celles de la structure à deux dimensions fournie en <code>y</code> (colonne <span class="math inline">\(i\)</span> de <code>x</code> associée à la colonne <span class="math inline">\(i\)</span> de <code>y</code>). Voici un exemple d’utilisation de cette fonction exploitant un jeu de données créé à partir de <code>quakes</code> contenant les valeurs des variables <code>mag</code> et <code>stations</code> dans des colonnes distinctes par région.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb15-2" title="2">quakes_wide &lt;-<span class="st"> </span><span class="kw">pivot_wider</span>(</a>
<a class="sourceLine" id="cb15-3" title="3">  <span class="dt">data =</span> quakes, </a>
<a class="sourceLine" id="cb15-4" title="4">  <span class="dt">names_from =</span> region,</a>
<a class="sourceLine" id="cb15-5" title="5">  <span class="dt">values_from =</span> <span class="kw">c</span>(mag, stations)</a>
<a class="sourceLine" id="cb15-6" title="6">)</a>
<a class="sourceLine" id="cb15-7" title="7"><span class="kw">matplot</span>(</a>
<a class="sourceLine" id="cb15-8" title="8">  <span class="dt">x =</span> quakes_wide[, <span class="kw">c</span>(<span class="st">&quot;mag_Est&quot;</span>, <span class="st">&quot;mag_Ouest&quot;</span>)], </a>
<a class="sourceLine" id="cb15-9" title="9">  <span class="dt">y =</span> quakes_wide[, <span class="kw">c</span>(<span class="st">&quot;stations_Est&quot;</span>, <span class="st">&quot;stations_Ouest&quot;</span>)], </a>
<a class="sourceLine" id="cb15-10" title="10">  <span class="dt">pch =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</a>
<a class="sourceLine" id="cb15-11" title="11">  <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>, </a>
<a class="sourceLine" id="cb15-12" title="12">  <span class="dt">ylab =</span> <span class="st">&quot;nombre de stations rapportant le séisme&quot;</span></a>
<a class="sourceLine" id="cb15-13" title="13">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-11-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Il faudrait ajouter une légende au graphique pour indiquer la signification des deux symboles et couleurs de points. La fonction <code>matplot</code> ne peut pas faire cet ajout. Il devra donc être fait avec la fonction <code>legend</code>, que nous verons plus loin.</p>
</div>
<div id="exemple-de-diagramme-en-lignes---fonctions-plot.default-et-matplot" class="section level3">
<h3>Exemple de diagramme en lignes - fonctions <code>plot.default</code> et <code>matplot</code></h3>
<p>En assignant la valeur <code>"l"</code> à l’argument <code>type</code> de la méthode <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.default.html"><code>plot.default</code></a>, celle-ci produit un <a href="https://en.wikipedia.org/wiki/Line_chart">diagramme en lignes (<em>line chart</em>)</a>, comme dans l’exemple suivant exploitant un jeu de données créé à partir de <code>quakes</code> contenant les valeurs moyennes de nombres de stations par valeur de magnitude.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">mean_stations_per_mag &lt;-<span class="st"> </span><span class="kw">aggregate</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> quakes, <span class="dt">FUN =</span> mean)</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">plot</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> mean_stations_per_mag, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-12-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Cet exemple illustre aussi le fait que la fonction <code>plot</code> accepte en entrée une formule.</p>
</div>
<div id="exemple-de-diagramme-en-secteurs---fonction-pie" class="section level3">
<h3>Exemple de diagramme en secteurs - fonction <code>pie</code></h3>
<p>La fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/pie.html"><code>pie</code></a> permet de créer des <a href="https://en.wikipedia.org/wiki/Pie_chart">diagrammes en secteurs (<em>pie charts</em>)</a>, aussi nommés diagrammes circulaires ou diagrammes en pointes de tarte ou en camembert. Ce type de graphique est à utiliser avec parcimonie. Il y a d’ailleurs une mise en garde concernant l’utilisation de ce type de graphique dans la <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/pie.html">fiche d’aide de la fonction <code>pie</code></a>.</p>
<p>Ce qui est reproché au diagramme en secteurs est qu’il difficile pour l’oeil humain de rapidement comparer les aires des secteurs (qui représentent les fréquences). Il est plus facile de comparer des hauteurs de barres. Donc le diagramme à barres serait un meilleur outil pour représenter des fréquences.</p>
<p>Malgré tout, je crois que le diagramme en secteur est utile pour représenter les fréquences d’une <strong>variable à peu de modalités</strong>, dans le cas où <strong>il n’y a pas de fréquences presque égales</strong>, comme dans l’exemple suivant.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">pie</span>(<span class="dt">x =</span> <span class="kw">table</span>(quakes<span class="op">$</span>mag_catego), <span class="dt">main =</span> <span class="st">&quot;Fréquences des modalités de magnitude de séismes&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-13-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="exemple-de-diagramme-à-barres---fonction-barplot" class="section level3">
<h3>Exemple de diagramme à barres - fonction <code>barplot</code></h3>
<p>La fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/barplot.html"><code>barplot</code></a> produit un <a href="https://en.wikipedia.org/wiki/Bar_chart">diagramme à barres (en anglais (<em>bar plot</em>))</a>, aussi nommé diagramme en bâtons ou à bandes. Celles-ci peuvent être placées à la verticale (fait par défaut) ou à l’horizontale (argument <code>horiz = TRUE</code>).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1"><span class="kw">barplot</span>(</a>
<a class="sourceLine" id="cb18-2" title="2">  <span class="dt">height =</span> <span class="kw">table</span>(quakes<span class="op">$</span>mag_catego), </a>
<a class="sourceLine" id="cb18-3" title="3">  <span class="dt">horiz =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb18-4" title="4">  <span class="dt">xlab =</span> <span class="st">&quot;fréquence&quot;</span>,</a>
<a class="sourceLine" id="cb18-5" title="5">  <span class="dt">ylab =</span> <span class="st">&quot;modalité de magnitude&quot;</span></a>
<a class="sourceLine" id="cb18-6" title="6">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-14-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>La hauteur des barres dans un diagramme à barres représentent souvent les fréquences d’une variable catégorique. C’est le cas dans l’exemple précédent. Ces sont ces fréquences qui doivent être fournies à la fonction <code>barplot</code> et non les observations d’origine. Un appel à la fonction <code>barplot</code> est donc souvent accompagné d’une appel à une fonction pour calculer des fréquences comme <a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/table.html"><code>table</code></a> ou <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/xtabs.html"><code>xtabs</code></a>.</p>
<p>Lorsque ce diagramme est utilisé pour représenter des fréquences croisées entre deux variables, les barres pour les différentes variables peuvent être empilés (comportement par défaut de <code>barplot</code>) :</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">barplot</span>(</a>
<a class="sourceLine" id="cb19-2" title="2">  <span class="dt">height =</span> <span class="kw">xtabs</span>(<span class="op">~</span><span class="st"> </span>region <span class="op">+</span><span class="st"> </span>mag_catego, <span class="dt">data =</span> quakes),</a>
<a class="sourceLine" id="cb19-3" title="3">  <span class="dt">legend.text =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb19-4" title="4">  <span class="dt">xlab =</span> <span class="st">&quot;modalité de magnitude&quot;</span>,</a>
<a class="sourceLine" id="cb19-5" title="5">  <span class="dt">ylab =</span> <span class="st">&quot;fréquence&quot;</span></a>
<a class="sourceLine" id="cb19-6" title="6">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-15-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>ou groupés (grâce à l’argument beside = TRUE) :</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">barplot</span>(</a>
<a class="sourceLine" id="cb20-2" title="2">  <span class="dt">height =</span> <span class="kw">table</span>(quakes<span class="op">$</span>region, quakes<span class="op">$</span>mag_catego), </a>
<a class="sourceLine" id="cb20-3" title="3">  <span class="dt">legend.text =</span> <span class="ot">TRUE</span>, </a>
<a class="sourceLine" id="cb20-4" title="4">  <span class="dt">beside =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb20-5" title="5">  <span class="dt">xlab =</span> <span class="st">&quot;modalité de magnitude&quot;</span>,</a>
<a class="sourceLine" id="cb20-6" title="6">  <span class="dt">ylab =</span> <span class="st">&quot;fréquence&quot;</span></a>
<a class="sourceLine" id="cb20-7" title="7">  )</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-16-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Il est important d’identifier à quelles modalités des variables sont associées les barres. Dans le cas d’un diagramme à barres bivarié, une légende est souvent nécessaire pour ce faire, car l’axe perpendiculaire aux barres ne suffit pas. La fonction <code>barplot</code> peut ajouter une légende au graphique grâce à son argument <code>legend.text</code>.</p>
</div>
<div id="exemple-de-diagramme-en-points-de-cleveland---fonction-dotchart" class="section level3">
<h3>Exemple de diagramme en points de Cleveland - fonction <code>dotchart</code></h3>
<p>Les <a href="https://en.wikipedia.org/wiki/Dot_plot_(statistics)">diagrammes en points de Cleveland (en anglais <em>Cleveland dot plots</em>)</a> peuvent remplacer les diagrammes à barres. Ils offrent une présentation allégée, donc une lisibilité potentiellement accrue dans certaines situations.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">quakes_freq &lt;-<span class="st"> </span><span class="kw">xtabs</span>(<span class="op">~</span><span class="st"> </span>region <span class="op">+</span><span class="st"> </span>mag_catego, <span class="dt">data =</span> quakes)</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">dotchart</span>(<span class="dt">x =</span> quakes_freq[<span class="dv">2</span><span class="op">:</span><span class="dv">1</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">1</span>], <span class="dt">bg =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">xlab =</span> <span class="st">&quot;Fréquence&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-17-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Voici quelques références pour en apprendre davantage à propos de ces graphiques et de leur création en R :</p>
<ul>
<li><a href="https://uc-r.github.io/cleveland-dot-plots" class="uri">https://uc-r.github.io/cleveland-dot-plots</a></li>
<li><a href="https://homepage.divms.uiowa.edu/~luke/classes/STAT4580/dotbar.html" class="uri">https://homepage.divms.uiowa.edu/~luke/classes/STAT4580/dotbar.html</a></li>
</ul>
</div>
<div id="exemple-de-diagramme-en-mosaïque---fonction-mosaicplot" class="section level3">
<h3>Exemple de diagramme en mosaïque - fonction <code>mosaicplot</code></h3>
<p>Une option de rechange au diagramme à barres empilées ou groupées pour représenter des fréquences croisées est le <a href="https://en.wikipedia.org/wiki/Mosaic_plot">diagramme en mosaïque</a>, qui peut être produit avec la fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/mosaicplot.html"><code>mosaicplot</code></a>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="kw">mosaicplot</span>(</a>
<a class="sourceLine" id="cb22-2" title="2">  <span class="dt">x =</span> <span class="kw">table</span>(quakes<span class="op">$</span>region, quakes<span class="op">$</span>mag_catego),</a>
<a class="sourceLine" id="cb22-3" title="3">  <span class="dt">color =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb22-4" title="4">  <span class="dt">main =</span> <span class="st">&quot;Fréquences croisées&quot;</span>,</a>
<a class="sourceLine" id="cb22-5" title="5">  <span class="dt">xlab =</span> <span class="st">&quot;région&quot;</span>,</a>
<a class="sourceLine" id="cb22-6" title="6">  <span class="dt">ylab =</span> <span class="st">&quot;modalité de magnitude&quot;</span>  </a>
<a class="sourceLine" id="cb22-7" title="7">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-18-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Voici quelques références pour en apprendre davantage à propos de ce type de graphique :</p>
<ul>
<li>Friendly, M. (2002). A brief history of the mosaic display. <em>Journal of Computational and Graphical Statistics</em>, 11(1), 89-107.</li>
<li>Few, S. and Edge, P. (2014). Are mosaic plots worthwhile?. <em>Perceptual Edge. Visual Business Intelligence Newsletter</em>, 1-14. URL <a href="https://www.perceptualedge.com/articles/visual_business_intelligence/are_mosaic_plots_worthwhile.pdf" class="uri">https://www.perceptualedge.com/articles/visual_business_intelligence/are_mosaic_plots_worthwhile.pdf</a></li>
</ul>
</div>
<div id="exemple-dhistogramme---fonction-hist" class="section level3">
<h3>Exemple d’histogramme - fonction <code>hist</code></h3>
<p>L’<a href="https://en.wikipedia.org/wiki/Histogram">histogramme</a> sert à représenter la distribution empirique d’une variable numérique. La fonction <a href="http://stat.ethz.ch/R-manual/R-devel/library/graphics/html/hist.html"><code>hist</code></a> permet d’en produire.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="kw">hist</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-20-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Un titre et des noms d’axes ont été produits par défaut par le fonction <code>hist</code>, mais il faudrait les adapter pour une poublication en français.</p>
<p>Mine de rien, cette fonction fait beaucoup de travail afin de pouvoir produire un histogramme. Elle commence par briser l’étendue des valeurs de la variable en intervalles disjoints mais contigus, puis elle calcule les fréquences des observations tombant dans les intervalles. Ensuite, elle trace un genre de diagramme à barres en insérant aucun espace entre les barres (puiqu’elles réfèrent à des intervalles contigus). La façon dont les intervalles sont formés peut être contrôlée par les arguments <code>breaks</code>, <code>include.lowest</code> et <code>right</code>. La fonction retourne aussi toutes les statistiques qu’elle calcule, mais il faut accompagner l’appel à la fonction <code>hist</code> d’une assignation pour garder une trace de ces statistiques</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">stats &lt;-<span class="st"> </span><span class="kw">hist</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag, <span class="dt">plot =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb24-2" title="2">stats</a></code></pre></div>
<pre><code>## $breaks
##  [1] 4.0 4.2 4.4 4.6 4.8 5.0 5.2 5.4 5.6 5.8 6.0 6.2 6.4
## 
## $counts
##  [1] 191 186 208 163 101  72  41  23   8   5   1   1
## 
## $density
##  [1] 0.955 0.930 1.040 0.815 0.505 0.360 0.205 0.115 0.040 0.025 0.005 0.005
## 
## $mids
##  [1] 4.1 4.3 4.5 4.7 4.9 5.1 5.3 5.5 5.7 5.9 6.1 6.3
## 
## $xname
## [1] &quot;quakes$mag&quot;
## 
## $equidist
## [1] TRUE
## 
## attr(,&quot;class&quot;)
## [1] &quot;histogram&quot;</code></pre>
</div>
<div id="exemple-de-diagramme-en-boîte---fonction-boxplot" class="section level3">
<h3>Exemple de diagramme en boîte - fonction <code>boxplot</code></h3>
<p>Un autre graphique conçu pour représenter la distribution empirique d’une variable numérique est le <a href="https://en.wikipedia.org/wiki/Box_plot">diagramme en boîte (<em>boxplot</em>)</a>. Ce type de graphique peut être produit en R avec la fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/boxplot.html"><code>boxplot</code></a>.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="kw">boxplot</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag, <span class="dt">main =</span> <span class="st">&quot;Distribution empirique de la magnitude&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-23-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>L’association entre une variable numérique et une variable catégorique peut être représentée par des diagrammes en boîtes juxtaposés.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="kw">boxplot</span>(mag <span class="op">~</span><span class="st"> </span>region, <span class="dt">data =</span> quakes)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-24-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Par exemple, pour produire des diagrammes en boîtes pour les observations de la variable numérique <code>mag</code> en fonction de la variable catégorique <code>region</code>, la fonction <code>boxplot</code> peut être appelée en lui fournissant en entrée une formule contenant dans sa partie de droite la variable numérique et dans sa partie de gauche la variable catégorique.</p>
</div>
<div id="exemple-de-courbe-destimation-de-densité-à-noyau---méthode-plot.density" class="section level3">
<h3>Exemple de courbe d’estimation de densité à noyau - méthode <code>plot.density</code></h3>
<p>La fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/density.html"><code>density</code></a> estime une densité empirique par la <a href="https://en.wikipedia.org/wiki/Kernel_density_estimation">méthode à noyau</a> à partir des observations d’une variable numérique. Une représentation graphique de cette densité empirique avec la méthode <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/plot.density.html"><code>plot.density</code></a> (via la fonction générique <code>plot</code> ou directement) est une autre alternative pour visualiser les observations d’une variable numérique.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"><span class="kw">plot</span>(<span class="dt">x =</span> <span class="kw">density</span>(quakes<span class="op">$</span>mag))</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-26-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Comme la fonction <code>hist</code>, la méthode <code>plot.density</code> produit un titre et des noms d’axes par défaut, qu’il faut bien souvent adapter avant d’intégrer le graphique à une publication.</p>
</div>
<div id="exemple-de-diagramme-quantile-quantile---fonctions-qqnorm-et-qqplot" class="section level3">
<h3>Exemple de diagramme quantile-quantile - fonctions <code>qqnorm</code> et <code>qqplot</code></h3>
<p>Les <a href="https://fr.wikipedia.org/wiki/Diagramme_Quantile-Quantile">diagrammes quantile-quantile</a> servent à comparer des distributions. Le plus connus des diagrammes quantile-quantile est probablement le diagramme quantile-quantile théorique normal qui permet de comparer une distribution empirique à une distribution théorique normale. Ce type de graphique peut être produit en R avec la fonction <a href="http://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqnorm</code></a>.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">qqnorm</span>(<span class="dt">y =</span> quakes<span class="op">$</span>mag)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-27-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Les <a href="https://www.itl.nist.gov/div898/handbook/eda/section3/qqplot.htm">diagrammes quantile-quantile empiriques</a> servent quant à eux à comparer deux distributions empiriques. La fonction <a href="http://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqplot</code></a> permet d’en produire.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"><span class="kw">qqplot</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag, <span class="dt">y =</span> quakes<span class="op">$</span>stations)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-29-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="exemple-de-représentation-graphique-dune-expression-mathématique---fonction-curve" class="section level3">
<h3>Exemple de représentation graphique d’une expression mathématique - fonction <code>curve</code></h3>
<p>La représentation graphique d’une fonction mathématique est possible en R avec la fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/curve.html"><code>curve</code></a>.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="kw">curve</span>(<span class="dt">expr =</span> log)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-30-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Par défaut, la fonction <code>curve</code> fait une évaluation de la valeur de la fonction en 101 points également répartis entre 0 et 1. Il est possible de modifier ces points grâce aux arguments <code>from</code>, <code>to</code> et <code>n</code> (une séquence de points est créée avec la fonction <code>seq</code>). De plus, le premier argument n’est pas contraint à être une fonction. Il peut s’agir de n’importe quelle expression écrite comme une fonction de <code>x</code>.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1"><span class="kw">curve</span>(<span class="dt">expr =</span> x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span><span class="op">*</span>x <span class="op">-</span><span class="st"> </span><span class="dv">25</span>, <span class="dt">from =</span> <span class="dv">-23</span>, <span class="dt">to =</span> <span class="dv">18</span>, <span class="dt">n =</span> <span class="dv">200</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-31-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Le code suivant produit le même graphique, mais l’utilisation de la fonction <code>curve</code> crée une commande plus succincte.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-23</span>, <span class="dt">to =</span> <span class="dv">18</span>, <span class="dt">length =</span> <span class="dv">200</span>)</a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">plot</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span><span class="op">*</span>x <span class="op">-</span><span class="st"> </span><span class="dv">25</span>, <span class="dt">type =</span> <span class="st">&quot;l&quot;</span>)</a></code></pre></div>
</div>
</div>
<div id="arguments-et-paramètres-graphiques" class="section level2">
<h2>Arguments et paramètres graphiques</h2>
<p>Les fonctions vues jusqu’à présent possèdent toutes des arguments pour contrôler la <strong>mise en forme</strong> et les <strong>annotations</strong> des graphiques. La liste complète de ces arguments varient d’une fonctions à l’autre, mais certains arguments sont communs à presque toutes les fonctions graphiques. Nous allons voir ici les arguments les plus utiles.</p>
<p>Les arguments permettant de contrôler la mise en forme sont appelés paramètres graphiques. La plupart peuvent être spécifiés soit dans l’appel à la fonction graphique, soit dans un appel à la fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/par.html"><code>par</code></a>. Par contre, certains paramètres graphiques peuvent uniquement être fixés avec <code>par</code>.</p>
<p>Un paramètre graphique fourni dans un appel à une fonction graphique est effectif seulement pour le graphique produit, alors qu’un paramètre graphique fourni dans un appel à <code>par</code> reste effectif jusqu’à ce que nous le modifions de nouveau. Alors, avant de modifier des paramètres graphiques avec <code>par</code>, il est bon d’enregistrer les valeurs par défaut des paramètres, comme suit,</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">par.default &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>afin de pouvoir facilement réattribuer ces valeurs par défaut aux paramètres, comme suit,</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">par</span>(par.default)</a></code></pre></div>
<p>à la fin des nos commandes pour produire un graphique. L’objet <code>par.default</code> est une liste contenant les valeurs par défaut de tous les paramètes graphiques modifiables. Il est aussi possible d’enregistrer seulement les paramètres graphiques modifiés par un appel à la fonction <code>par</code> en l’accompagnant d’une assignation. Par exemple, l’objet <code>par.default</code> obtenu ainsi :</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">par.default &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>))</a></code></pre></div>
<p>contient uniquement la valeur par défaut du paramètre <code>mar</code>.</p>
<p>Notons que les changements apportés aux paramètres graphiques ne sont pas conservés lors de la fermeture de la session R. À l’ouverture d’une session R, les paramètres graphiques prennent donc leurs valeurs par défaut.</p>
<p>Voici deux tableaux résumant les arguments et paramètres graphiques les plus communs :</p>
<table>
<colgroup>
<col width="27%" />
<col width="72%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Arguments</strong></th>
<th><strong>Éléments graphiques contrôlés</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>main</code></td>
<td>titre</td>
</tr>
<tr class="even">
<td><code>sub</code></td>
<td>note en bas de page</td>
</tr>
<tr class="odd">
<td> </td>
<td> </td>
</tr>
<tr class="even">
<td><code>xlab</code>, <code>ylab</code></td>
<td>noms des axes</td>
</tr>
<tr class="odd">
<td><code>xlim</code>, <code>ylim</code></td>
<td>étendue des axes</td>
</tr>
<tr class="even">
<td> </td>
<td> </td>
</tr>
<tr class="odd">
<td><code>type</code></td>
<td>type de représentation (<code>"p"</code> = points, <code>"l"</code> = lignes, <code>"b"</code> = les deux, etc.)</td>
</tr>
</tbody>
</table>
<p> </p>
<table>
<colgroup>
<col width="29%" />
<col width="70%" />
</colgroup>
<thead>
<tr class="header">
<th><strong>Paramètres</strong></th>
<th><strong>Éléments graphiques contrôlés</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>ann</code></td>
<td>si <code>FALSE</code>, retire le titre et les noms d’axes</td>
</tr>
<tr class="even">
<td><code>bty</code></td>
<td>si <code>"n"</code>, retire le cadre autour de la zone graphique</td>
</tr>
<tr class="odd">
<td> </td>
<td>(autres valeurs acceptées : <code>"o"</code>, <code>"l"</code>, <code>"7"</code>, <code>"c"</code>, <code>"u"</code> et <code>"]"</code>)</td>
</tr>
<tr class="even">
<td> </td>
<td> </td>
</tr>
<tr class="odd">
<td><code>lwd</code></td>
<td>épaisseur des lignes</td>
</tr>
<tr class="even">
<td><code>lty</code></td>
<td>type des lignes</td>
</tr>
<tr class="odd">
<td><code>pch</code></td>
<td>symbole pour les points</td>
</tr>
<tr class="even">
<td> </td>
<td> </td>
</tr>
<tr class="odd">
<td><code>font</code></td>
<td>type de <strong>police de caractères</strong> dans la zone graphique,</td>
</tr>
<tr class="even">
<td> </td>
<td>(<code>1</code> = normal, <code>2</code> = gras, <code>3</code> = italique, etc.)</td>
</tr>
<tr class="odd">
<td><code>font.main</code>, <code>font.sub</code>,</td>
<td>dans le titre, dans la note en bas de page,</td>
</tr>
<tr class="even">
<td><code>font.axis</code>, <code>font.lab</code></td>
<td>dans les marques des axes, dans les noms des axes</td>
</tr>
<tr class="odd">
<td><code>family</code></td>
<td>famille de police de caractères</td>
</tr>
<tr class="even">
<td> </td>
<td>(<code>"serif"</code>, <code>"sans"</code>, <code>"mono"</code>, <code>"symbol"</code>, etc.)</td>
</tr>
<tr class="odd">
<td> </td>
<td> </td>
</tr>
<tr class="even">
<td><code>cex</code></td>
<td><strong>taille des caractères</strong> dans la zone graphique,</td>
</tr>
<tr class="odd">
<td><code>cex.main</code>, <code>cex.sub</code>,</td>
<td>dans le titre, dans la note en bas de page,</td>
</tr>
<tr class="even">
<td><code>cex.axis</code>, <code>cex.lab</code></td>
<td>dans les marques des axes, dans les noms des axes</td>
</tr>
<tr class="odd">
<td> </td>
<td> </td>
</tr>
<tr class="even">
<td><code>col</code></td>
<td><strong>couleur</strong> des éléments de la zone graphique,</td>
</tr>
<tr class="odd">
<td><code>col.main</code>, <code>col.sub</code>,</td>
<td>du titre, de la note en bas de page,</td>
</tr>
<tr class="even">
<td><code>col.axis</code>, <code>col.lab</code></td>
<td>des marques des axes, des noms des axes</td>
</tr>
<tr class="odd">
<td><code>bg</code></td>
<td>couleur de l’intérieur du symbole pour les points lorsque <code>pch</code> prend une valeur entre 21 et 25 (pas la même signification dans <code>par</code>)</td>
</tr>
<tr class="even">
<td> </td>
<td> </td>
</tr>
<tr class="odd">
<td><code>par(mfrow = c( , ))</code></td>
<td>division de la fenêtre graphique</td>
</tr>
<tr class="even">
<td><code>par(mfcol = c( , ))</code></td>
<td> </td>
</tr>
<tr class="odd">
<td><code>par(new = TRUE)</code></td>
<td>superposition de graphiques</td>
</tr>
<tr class="even">
<td><code>par(mar = c( , , , ))</code></td>
<td>tailles des marges</td>
</tr>
<tr class="odd">
<td><code>par(oma = c( , , , ))</code></td>
<td>tailles des marges externes (par défaut nulles)</td>
</tr>
</tbody>
</table>
<p>La liste de tous les paramètes graphiques R est bien plus longue que ça. Il en existe plus de soixante-dix, tous documentés dans la <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/par.html">fiche d’aide de la fonction <code>par</code></a>.</p>
<p>L’utilisation de certains de ces arguments a déjà été illustré dans les exemples précédents. Voici un exemple supplémentaire dans lequel quelques éléments de la mise en forme sont modifiés dans le diagramme de dispersion de la variable <code>stations</code> en fonction de la variable <code>mag</code></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">plot</span>(</a>
<a class="sourceLine" id="cb37-2" title="2">  <span class="dt">x =</span> quakes<span class="op">$</span>mag,</a>
<a class="sourceLine" id="cb37-3" title="3">  <span class="dt">y =</span> quakes<span class="op">$</span>stations,</a>
<a class="sourceLine" id="cb37-4" title="4">  <span class="dt">main =</span> <span class="st">&quot;1000 séismes près de Fidji&quot;</span>,</a>
<a class="sourceLine" id="cb37-5" title="5">  <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>,</a>
<a class="sourceLine" id="cb37-6" title="6">  <span class="dt">ylab =</span> <span class="st">&quot;nombre de stations rapportant le séisme&quot;</span>,</a>
<a class="sourceLine" id="cb37-7" title="7">  <span class="dt">font.lab =</span> <span class="dv">3</span>,     <span class="co"># nom d&#39;axes en italique</span></a>
<a class="sourceLine" id="cb37-8" title="8">  <span class="dt">font.main =</span> <span class="dv">4</span>,    <span class="co"># titre en gras italique</span></a>
<a class="sourceLine" id="cb37-9" title="9">  <span class="dt">cex.axis =</span> <span class="fl">0.8</span>,   <span class="co"># marques des axes plus petites</span></a>
<a class="sourceLine" id="cb37-10" title="10">  <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>           <span class="co"># pas de cadre autour de la zone graphique</span></a>
<a class="sourceLine" id="cb37-11" title="11">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-36-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Remarquons que les accents ne causent pas de problèmes dans le titre et les noms d’axes.</p>
<p>Nous pouvons aussi modifier certains paramètres graphiques par un appel à la fonction <code>par</code> comme suit.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" title="1">par.default &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">font.lab =</span> <span class="dv">3</span>, <span class="dt">font.main =</span> <span class="dv">4</span>, <span class="dt">cex.axis =</span> <span class="fl">0.8</span>, <span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb38-2" title="2"><span class="kw">plot</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag, <span class="dt">y =</span> quakes<span class="op">$</span>stations, </a>
<a class="sourceLine" id="cb38-3" title="3">     <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>, </a>
<a class="sourceLine" id="cb38-4" title="4">     <span class="dt">ylab =</span> <span class="st">&quot;nombre de stations rapportant le séisme&quot;</span>,</a>
<a class="sourceLine" id="cb38-5" title="5">     <span class="dt">main =</span> <span class="st">&quot;1000 séismes près de Fidji&quot;</span>)</a>
<a class="sourceLine" id="cb38-6" title="6"><span class="kw">par</span>(par.default)</a></code></pre></div>
<p>Utiliser la fonction <code>par</code> est pratique si nous avons plusieurs graphiques à produire avec les mêmes paramètres.</p>
<div id="types-de-représentation---argument-type" class="section level4">
<h4>Types de représentation - argument <code>type</code></h4>

<p>Voici un graphique qui représente toutes les valeurs que peut prendre l’argument <code>type</code><a href="#fn6" class="footnote-ref" id="fnref6"><sup>6</sup></a>.</p>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-39-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="types-de-lignes---paramètre-lty" class="section level4">
<h4>Types de lignes - paramètre <code>lty</code></h4>

<p>Voici un graphique qui représente toutes les valeurs que peut prendre le paramètre <code>lty</code> <a href="#fn7" class="footnote-ref" id="fnref7"><sup>7</sup></a>.</p>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-40-1.png" width="50%" style="display: block; margin: auto;" /></p>
</div>
<div id="symboles-pour-les-points---paramètre-pch" class="section level4">
<h4>Symboles pour les points - paramètre <code>pch</code></h4>

<p>Voici un graphique qui représente toutes les valeurs numériques que peut prendre le paramètre <code>pch</code>. Ce paramètre accepte aussi comme valeur un caractère quelconque<a href="#fn8" class="footnote-ref" id="fnref8"><sup>8</sup></a>.</p>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-41-1.png" width="90%" style="display: block; margin: auto;" /></p>
</div>
<div id="couleurs" class="section level3">
<h3>Couleurs</h3>
<p>Une couleur peut être spécifiée de différentes façons :</p>
<ul>
<li>par une chaîne de caractère contenant un nom de couleur,</li>
<li>par une chaîne de caractères hexadécimaux de la forme <code>"#rrggbb"</code> ou <code>"#rrggbbaa"</code>,</li>
<li>par un nombre entier référant à une palette de couleur.</li>
</ul>
<div id="nom-de-couleur" class="section level4">
<h4>Nom de couleur :</h4>

<p>La commande suivante affiche tous les noms de couleurs compris par R.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="kw">colors</span>()</a></code></pre></div>
<pre><code>##  [1] &quot;white&quot;         &quot;aliceblue&quot;     &quot;antiquewhite&quot;  &quot;antiquewhite1&quot; &quot;antiquewhite2&quot;
##  [6] &quot;antiquewhite3&quot; &quot;antiquewhite4&quot; &quot;aquamarine&quot;    &quot;aquamarine1&quot;   &quot;aquamarine2&quot;  
## [11] &quot;aquamarine3&quot;   &quot;aquamarine4&quot;   &quot;azure&quot;         &quot;azure1&quot;        &quot;azure2&quot;       
##  [ reached getOption(&quot;max.print&quot;) -- omitted 642 entries ]</code></pre>
<p>Il y en a 657 (seulement les 15 premiers sont affichés ici). Certains de ces noms sont plutôt originaux, par exemple <code>"lemon chiffon"</code>, <code>"peach puff"</code> et <code>"papaya whip"</code><a href="#fn9" class="footnote-ref" id="fnref9"><sup>9</sup></a>! Ces couleurs sont représentées dans le graphique suivant, selon la position de la couleur dans le vecteur retourné par la commande <code>colors()</code><a href="#fn10" class="footnote-ref" id="fnref10"><sup>10</sup></a>.</p>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-44-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="chaîne-de-caractères-hexadécimaux-de-la-forme-rrggbb-ou-rrggbbaa" class="section level4">
<h4>Chaîne de caractères hexadécimaux de la forme <code>"#rrggbb"</code> ou <code>"#rrggbbaa"</code> :</h4>

<p>Dans une chaîne de caractères hexadécimaux de la forme <code>"#rrggbb"</code> ou <code>"#rrggbbaa"</code>, les paires des caractères <code>rr</code>, <code>gg</code>, <code>bb</code> et <code>aa</code> sont des digits hexadécimaux spécifiant une valeur entre <code>00</code> (minimum) et <code>FF</code> (maximum). Ces digits indiquent respectivement un niveau de rouge, de vert, de bleu et d’opacité. Le niveau d’opacité est facultatif. Par défaut les couleurs sont complètement opaques. Une valeur d’opacité minimale <code>00</code> représente une transparence complète et une valeur d’opacité maximale <code>FF</code> représente une opacité complète.</p>
<p>Pour déterminer un code hexadécimal de couleur, les fonctions suivantes sont utiles :</p>
<ul>
<li><code>rgb</code> : prend en entrée des niveaux de rouge (<code>red</code>), de vert (<code>green</code>), de bleu (<code>blue</code>) et optionnellement d’opacité (<code>alpha</code>), retourne en sortie le code hexadécimal associé;</li>
<li><code>hsv</code> : prend en entrée des niveaux de teinte (<code>hue</code>), de saturation (<code>saturation</code>), de valeur de luminosité (<code>value</code>) et optionnellement d’opacité, retourne en sortie le code hexadécimal associé;</li>
<li><code>hcl</code> : prend en entrée des niveaux de teinte (<code>hue</code>), de chroma (<code>chroma</code>), de luminance (<code>luminance</code>) et optionnellement d’opacité, retourne en sortie le code hexadécimal associé;</li>
<li><code>gray</code> ou <code>grey</code> : prend en entrée un niveau de gris entre 0 (noir) et 1 (blanc) et optionnellement d’opacité, retourne en sortie le code hexadécimal associé.</li>
</ul>
<p>Exemple d’un bleu avec différents niveaux d’opacité :</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">opacite &lt;-<span class="st"> </span><span class="kw">rgb</span>(<span class="dt">red =</span> <span class="dv">0</span>, <span class="dt">green =</span> <span class="dv">33</span><span class="op">/</span><span class="dv">255</span>, <span class="dt">blue =</span> <span class="dv">78</span><span class="op">/</span><span class="dv">255</span>,</a>
<a class="sourceLine" id="cb41-2" title="2">               <span class="dt">alpha =</span> <span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">by =</span> <span class="fl">0.1</span>))</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-46-1.png" width="70%" style="display: block; margin: auto;" /></p>
</div>
<div id="nombre-entier-référant-à-une-palette-de-couleur" class="section level4">
<h4>Nombre entier référant à une palette de couleur :</h4>

<p>Une palette de couleur est définie en R et il est possible de spécifier une couleur par un entier référant à une position dans cette palette. Par défaut, la palette de couleur est la suivante :</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" title="1"><span class="kw">palette</span>()</a></code></pre></div>
<pre><code>## [1] &quot;black&quot;   &quot;red&quot;     &quot;green3&quot;  &quot;blue&quot;    &quot;cyan&quot;    &quot;magenta&quot; &quot;yellow&quot;  &quot;gray&quot;</code></pre>
<p>Voici un diagramme représentant les couleurs de cette palette selon leur position.</p>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-48-1.png" width="60%" style="display: block; margin: auto;" /></p>
<p>Il est possible de modifier la palette en lui assignant un nouveau vecteur de noms de couleurs ou de chaînes de caractères hexadécimaux de la forme <code>"#rrggbb"</code> ou <code>"#rrggbbaa"</code> pour représenter des couleurs. Certaines fonction R sont pratiques pour créer de tels vecteurs contenant des dégradés de couleurs, particulièrement la fonction <a href="https://stat.ethz.ch/R-manual/R-patched/library/grDevices/html/palettes.html"><code>hcl.colors</code></a>. Par exemple, utilisons cette fonction pour modifier la palette de couleurs en un dégradé de 20 couleurs comme suit.</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">palette</span>(<span class="kw">hcl.colors</span>(<span class="dv">20</span>))</a></code></pre></div>
<p>Maintenant, le diagramme représentant les couleurs de la palette selon leur position devient :</p>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-50-1.png" width="90%" style="display: block; margin: auto;" /></p>
<p>La fonction <code>hcl.colors</code> peut créer des palettes de couleur selon plus d’une centaine de styles, à spécifier via son argument nommé <code>palette</code>. Le style par défaut est <code>"viridis"</code>. Il s’agit d’une palette de couleurs popularisée par la librairie graphique Python <code>Matplotlib</code>. Cette palette comporte les avantages de présenter un dégradé uniforme tant en couleur qu’en niveaux de gris (lors d’une impression par exemple) et d’être bien perçu par les daltoniens (du moins pour les formes les plus courantes de daltonisme). Les styles de palette de couleurs acceptés par <code>hcl.colors</code> peuvent être énumérés avec la commande <code>hcl.pals()</code> et visualisés sur la page web suivante : <a href="https://developer.r-project.org/Blog/public/2019/04/01/hcl-based-color-palettes-in-grdevices/">HCL-Based Color Palettes in grDevices</a>.</p>
<p>Pour ramener la palette de couleurs à ses valeurs par défaut, il faut soumettre la commande suivante.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1"><span class="kw">palette</span>(<span class="st">&quot;default&quot;</span>)</a></code></pre></div>
<p>Plusieurs packages R permettent de personnaliser les couleurs en R, notamment :</p>
<ul>
<li>le package <a href="https://emilhvitfeldt.github.io/paletteer/"><code>paletteer</code></a> qui regroupe un grand nombre de palettes de couleurs supplémentaires offertes par différents packages;</li>
<li>le package <a href="https://github.com/jonclayden/shades"><code>shades</code></a> qui offre différentes avenues de manipulation des couleurs (par exemple créer un dégradé entre deux couleurs de notre choix, rendre des couleurs plus foncées ou plus claires, etc.).</li>
</ul>
</div>
</div>
</div>
<div id="ajout-déléments-à-un-graphique" class="section level2">
<h2>Ajout d’éléments à un graphique</h2>
<p>Nous pouvons ajouter des éléments étape par étape à un graphique en R, en appelant les unes après les autres des fonctions graphiques. Le tableau suivant présente les principales fonctions graphiques qui ajoutent des éléments à un graphique initialisé.</p>
<table>
<thead>
<tr class="header">
<th><strong>Fonction(s) R</strong></th>
<th><strong>Élément(s) ajouté(s)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/points.html"><code>points</code></a> et <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/matplot.html"><code>matpoints</code></a></td>
<td>points selon des coordonnées</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/lines.html"><code>lines</code></a> et <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/matplot.html"><code>matlines</code></a></td>
<td>segments de droites reliant des points</td>
</tr>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/abline.html"><code>abline</code></a></td>
<td>droites traversant toute la zone graphique</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/segments.html"><code>segments</code></a></td>
<td>segments de droites entre des paires de coordonnées</td>
</tr>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/arrows.html"><code>arrows</code></a></td>
<td>flèches entre des paires de coordonnées</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/rect.html"><code>rect</code></a></td>
<td>rectangles</td>
</tr>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/polygon.html"><code>polygon</code></a></td>
<td>polygones quelconques</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/legend.html"><code>legend</code></a></td>
<td>légende</td>
</tr>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/text.html"><code>text</code></a></td>
<td>texte dans la zone graphique</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/mtext.html"><code>mtext</code></a></td>
<td>texte dans la marge</td>
</tr>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/title.html"><code>title</code></a></td>
<td>titre</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/axis.html"><code>axis</code></a></td>
<td>axe</td>
</tr>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/box.html"><code>box</code></a></td>
<td>boîte autour de la zone graphique</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqline</code></a></td>
<td>ligne dans un graphique quantile-quantile théorique</td>
</tr>
</tbody>
</table>
<p>Aussi, certaines fonctions de création de graphique peuvent devenir des fonctions d’ajout d’éléments à un graphique grâce à l’argument <code>add</code>. C’est la cas notamment des fonctions suivantes :</p>
<blockquote>
<p><code>matplot</code>, <code>barplot</code>, <code>hist</code>, <code>boxplot</code> et <code>curve</code>.</p>
</blockquote>
<p>En donnant la valeur <code>TRUE</code> à l’argument <code>add</code> lors de l’appel de ces fonctions, elle ajoute des éléments au graphique de la fenêtre graphique active au lieu de créer un nouveau graphique.</p>
<div id="exemple-dajout-de-lignes---fonctions-abline-vs-lines" class="section level3">
<h3>Exemple d’ajout de lignes - fonctions <code>abline</code> vs <code>lines</code></h3>
<p>La fonction <code>abline</code> permet d’ajouter une droite à un graphique qui traverse toute la zone graphique.</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" title="1">lmout &lt;-<span class="st"> </span><span class="kw">lm</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> quakes) <span class="co"># ajustement d&#39;une droite de régression</span></a>
<a class="sourceLine" id="cb46-2" title="2"></a>
<a class="sourceLine" id="cb46-3" title="3"><span class="kw">plot</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> quakes, <span class="dt">pch =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb46-4" title="4"><span class="kw">abline</span>(lmout)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-53-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Avec la fonction <code>lines</code>, nous pouvons ajouter des segments de droites reliant des points pour lesquels les coordonnées sont fournies.</p>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="co"># Calcul des médianes de stations par modalité de mag_catego</span></a>
<a class="sourceLine" id="cb47-2" title="2">aggout &lt;-<span class="st"> </span><span class="kw">aggregate</span>(stations <span class="op">~</span><span class="st"> </span>mag_catego, <span class="dt">data =</span> quakes, <span class="dt">FUN =</span> median)</a>
<a class="sourceLine" id="cb47-3" title="3">aggout<span class="op">$</span>mag_catego &lt;-<span class="st"> </span><span class="kw">as.numeric</span>(aggout<span class="op">$</span>mag_catego)</a>
<a class="sourceLine" id="cb47-4" title="4"></a>
<a class="sourceLine" id="cb47-5" title="5"><span class="kw">boxplot</span>(stations <span class="op">~</span><span class="st"> </span>mag_catego, <span class="dt">data =</span> quakes)</a>
<a class="sourceLine" id="cb47-6" title="6"><span class="kw">lines</span>(<span class="dt">x =</span> aggout, <span class="dt">lty =</span> <span class="dv">6</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">4</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-54-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="exemple-dajout-dune-légende---fonction-legend" class="section level3">
<h3>Exemple d’ajout d’une légende - fonction <code>legend</code></h3>
<p>Nous avions mentionné précédemment que le graphique que nous avons produit avec la fonction <code>matplot</code> devrait contenir une légende. Ajoutons-lui en une maintenant.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="kw">matplot</span>(</a>
<a class="sourceLine" id="cb48-2" title="2">  <span class="dt">x =</span> quakes_wide[, <span class="kw">c</span>(<span class="st">&quot;mag_Est&quot;</span>, <span class="st">&quot;mag_Ouest&quot;</span>)], </a>
<a class="sourceLine" id="cb48-3" title="3">  <span class="dt">y =</span> quakes_wide[, <span class="kw">c</span>(<span class="st">&quot;stations_Est&quot;</span>, <span class="st">&quot;stations_Ouest&quot;</span>)], </a>
<a class="sourceLine" id="cb48-4" title="4">  <span class="dt">pch =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</a>
<a class="sourceLine" id="cb48-5" title="5">  <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>, </a>
<a class="sourceLine" id="cb48-6" title="6">  <span class="dt">ylab =</span> <span class="st">&quot;nombre de stations rapportant le séisme&quot;</span></a>
<a class="sourceLine" id="cb48-7" title="7">)</a>
<a class="sourceLine" id="cb48-8" title="8"><span class="kw">legend</span>(</a>
<a class="sourceLine" id="cb48-9" title="9">  <span class="dt">x =</span> <span class="st">&quot;topleft&quot;</span>,</a>
<a class="sourceLine" id="cb48-10" title="10">  <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Est&quot;</span>, <span class="st">&quot;Ouest&quot;</span>),</a>
<a class="sourceLine" id="cb48-11" title="11">  <span class="dt">pch =</span> <span class="dv">2</span><span class="op">:</span><span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</a>
<a class="sourceLine" id="cb48-12" title="12">  <span class="dt">title =</span> <span class="st">&quot;région&quot;</span></a>
<a class="sourceLine" id="cb48-13" title="13">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-56-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>La localisation de la légende peut être spécifiée comme ici par un mot clé founi à l’argument <code>x</code> (<code>"bottomright"</code>, <code>"bottom"</code>, <code>"bottomleft"</code>, <code>"left"</code>, <code>"topleft"</code>, <code>"top"</code>, <code>"topright"</code>, <code>"right"</code> ou <code>"center"</code>), ou par des coordonnées exactes (arguments <code>x</code> et <code>y</code>).</p>
</div>
<div id="exemple-dajout-de-courbes-à-un-histogramme-et-dune-légende" class="section level3">
<h3>Exemple d’ajout de courbes à un histogramme et d’une légende</h3>
<p>Voici un exemple plus élaboré, dans lequel nous exploitons notamment l’argument <code>add</code> de la fonction <code>curve</code> pour ajouter des éléments à un graphique.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1"><span class="co"># Initialisation de l&#39;histogramme</span></a>
<a class="sourceLine" id="cb49-2" title="2"><span class="kw">hist</span>(quakes<span class="op">$</span>mag, <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;densité&quot;</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb49-3" title="3">     <span class="dt">main =</span> <span class="st">&quot;Densité empirique des magnitudes</span><span class="ch">\n</span><span class="st">dans le jeu de données quakes&quot;</span>)</a>
<a class="sourceLine" id="cb49-4" title="4"></a>
<a class="sourceLine" id="cb49-5" title="5"><span class="co"># Ajout de la courbe de densité à noyau</span></a>
<a class="sourceLine" id="cb49-6" title="6"><span class="kw">lines</span>(<span class="kw">density</span>(quakes<span class="op">$</span>mag), <span class="dt">xlim =</span> <span class="kw">range</span>(quakes<span class="op">$</span>mag))</a>
<a class="sourceLine" id="cb49-7" title="7"></a>
<a class="sourceLine" id="cb49-8" title="8"><span class="co"># Ajout de courbes de densité théoriques avec paramètres estimés à partir des données</span></a>
<a class="sourceLine" id="cb49-9" title="9">moy &lt;-<span class="st"> </span><span class="kw">mean</span>(quakes<span class="op">$</span>mag)</a>
<a class="sourceLine" id="cb49-10" title="10">et &lt;-<span class="st"> </span><span class="kw">sd</span>(quakes<span class="op">$</span>mag)</a>
<a class="sourceLine" id="cb49-11" title="11"><span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean =</span> moy, <span class="dt">sd =</span> et), </a>
<a class="sourceLine" id="cb49-12" title="12">      <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">7</span>))</a>
<a class="sourceLine" id="cb49-13" title="13"><span class="kw">curve</span>(<span class="kw">dlnorm</span>(x, <span class="dt">meanlog =</span> <span class="kw">mean</span>(<span class="kw">log</span>(quakes<span class="op">$</span>mag)), <span class="dt">sdlog =</span> <span class="kw">sd</span>(<span class="kw">log</span>(quakes<span class="op">$</span>mag))), </a>
<a class="sourceLine" id="cb49-14" title="14">      <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">7</span>))</a>
<a class="sourceLine" id="cb49-15" title="15"><span class="kw">curve</span>(<span class="kw">dgamma</span>(x, <span class="dt">shape =</span> moy<span class="op">^</span><span class="dv">2</span><span class="op">/</span>et<span class="op">^</span><span class="dv">2</span>, <span class="dt">rate =</span> moy<span class="op">/</span>et<span class="op">^</span><span class="dv">2</span>), </a>
<a class="sourceLine" id="cb49-16" title="16">      <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">7</span>))</a>
<a class="sourceLine" id="cb49-17" title="17"></a>
<a class="sourceLine" id="cb49-18" title="18"><span class="co"># Ajout d&#39;une légende</span></a>
<a class="sourceLine" id="cb49-19" title="19"><span class="kw">legend</span>(<span class="dt">x =</span> <span class="st">&quot;topright&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>, </a>
<a class="sourceLine" id="cb49-20" title="20">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</a>
<a class="sourceLine" id="cb49-21" title="21">       <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;Densité à noyau&quot;</span>, <span class="st">&quot;Densité normale&quot;</span>, </a>
<a class="sourceLine" id="cb49-22" title="22">                  <span class="st">&quot;Densité log-normale&quot;</span>, <span class="st">&quot;Densité Gamma&quot;</span>))</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-57-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div id="astuce" class="section level4">
<h4>Astuce :</h4>
<p>Il est possible d’insérer des sauts de ligne dans un élément textuel. Ceux-ci sont représentés par la chaîne de caractères <code>"\n"</code>. Cette astuce a été utilisée dans le graphique précédent pour obtenir un titre s’étalant sur deux lignes.</p>
</div>
</div>
</div>
<div id="possibilités-graphiques-spécifiques" class="section level2">
<h2>Possibilités graphiques spécifiques</h2>
<div id="annotations-mathématiques" class="section level3">
<h3>Annotations mathématiques</h3>
<p>Des annotations mathématiques sont des caractères spéciaux communs en science, telle que des exposants, des indices, des fractions, des lettres grecques, etc. Tout élément textuel d’un graphique peut en contenir (p. ex. les valeurs données à un argument <code>main</code>, <code>xlab</code>, <code>ylab</code>, <code>labels</code>, <code>legend</code>, <code>text</code>, etc.). La <a href="https://stat.ethz.ch/R-manual/R-devel/library/grDevices/html/plotmath.html">fiche d’aide intitulée <code>plotmat</code></a> énumère toutes les annotations possibles. Ces annotations impliquent une syntaxe particulière, qui ressemble un peu à du LaTeX. Elles doivent être exprimée sous la forme d’une expression R. La fonction <code>expression</code> permet de créer une telle expression.</p>
<div id="exemple-dappel-à-la-fonction-expression" class="section level4">
<h4>Exemple d’appel à la fonction <code>expression</code> :</h4>

<p>Pour qu’un élément textuel puisse contenir une annotation mathématique, il doit être créé par un appel à la fonction <code>expression</code>, comme c’est le cas pour les valeurs fournies aux arguments <code>xlab</code>, <code>ylab</code> et <code>labels</code> dans la commande de création de graphique suivante.</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1"><span class="kw">curve</span>(</a>
<a class="sourceLine" id="cb50-2" title="2">  <span class="dt">expr =</span> sin, <span class="dt">from =</span> <span class="dv">-4</span>, <span class="dt">to =</span> <span class="dv">4</span>, </a>
<a class="sourceLine" id="cb50-3" title="3">  <span class="dt">main =</span> <span class="st">&quot;Fonction sinus&quot;</span>,</a>
<a class="sourceLine" id="cb50-4" title="4">  <span class="dt">xlab =</span> <span class="kw">expression</span>(theta),</a>
<a class="sourceLine" id="cb50-5" title="5">  <span class="dt">ylab =</span> <span class="kw">expression</span>(sin<span class="op">~</span>(theta)),</a>
<a class="sourceLine" id="cb50-6" title="6">  <span class="dt">xaxt =</span> <span class="st">&quot;n&quot;</span>  <span class="co"># pour omettre la création automatique de l&#39;axe des x   </span></a>
<a class="sourceLine" id="cb50-7" title="7">)</a>
<a class="sourceLine" id="cb50-8" title="8"><span class="kw">axis</span>(         <span class="co"># pour créer manuellement l&#39;axe des x  </span></a>
<a class="sourceLine" id="cb50-9" title="9">  <span class="dt">side =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb50-10" title="10">  <span class="dt">at =</span> <span class="kw">c</span>(<span class="op">-</span>pi, <span class="op">-</span>pi<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, pi<span class="op">/</span><span class="dv">2</span>, pi),</a>
<a class="sourceLine" id="cb50-11" title="11">  <span class="dt">labels =</span> <span class="kw">expression</span>(<span class="op">-</span>pi, <span class="op">-</span>pi<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, pi<span class="op">/</span><span class="dv">2</span>, pi)</a>
<a class="sourceLine" id="cb50-12" title="12">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-58-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Les valeurs <code>theta</code> et <code>pi</code> ont été remplacées par leurs lettres grecques correspondantes (<span class="math inline">\(\theta\)</span> et <span class="math inline">\(\pi\)</span>) dans le graphique. Le symbole <code>~</code> est quant à lui devenu un espace.</p>
<p>Remarquons qu’en fournissant plusieurs arguments à la fonction <code>expression</code> lors de la spécification des valeurs de <code>labels</code>, nous avons créé un vecteur d’éléments textuels comprenant des annotations mathématiques.</p>
</div>
<div id="exemple-dappel-à-la-fonction-paste-dans-une-expression" class="section level4">
<h4>Exemple d’appel à la fonction <code>paste</code> dans une <code>expression</code></h4>

<p>Reprenons le graphique représentant une fonction polynomiale de degré deux que nous avons créé précédemment avec la fonction <code>curve</code>. Modifions le nom de l’axe des y de façon à y faire apparaître l’exposant 2 réellement en exposant.</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1"><span class="kw">curve</span>(</a>
<a class="sourceLine" id="cb51-2" title="2">  <span class="dt">expr =</span> x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span><span class="dv">5</span><span class="op">*</span>x <span class="op">-</span><span class="st"> </span><span class="dv">25</span>, </a>
<a class="sourceLine" id="cb51-3" title="3">  <span class="dt">from =</span> <span class="dv">-23</span>, <span class="dt">to =</span> <span class="dv">18</span>, <span class="dt">n =</span> <span class="dv">200</span>,</a>
<a class="sourceLine" id="cb51-4" title="4">  <span class="dt">main =</span> <span class="st">&quot;Fonction polynomiale de degré deux&quot;</span>,</a>
<a class="sourceLine" id="cb51-5" title="5">  <span class="dt">ylab =</span> <span class="kw">expression</span>(<span class="kw">paste</span>(x<span class="op">^</span><span class="dv">2</span>, <span class="st">&quot;+ 5x - 25&quot;</span>))</a>
<a class="sourceLine" id="cb51-6" title="6">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-59-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si un élément textuel doit être formé de parties à interpréter sous forme d’expressions mathématiques et d’autres sous forme de chaînes de caractères ordinaires, il faut assembler ces parties avec la fonction <code>paste</code>, comme dans l’exemple précédent. Notons que la fonction <code>paste</code> n’agit pas ici tout à fait comme d’habitude. Dans des expressions mathématiques, <code>paste</code> ne travaille pas de façon vectorielle et ne possède pas d’arguments. La fonction ne fait que juxtaposer des parties d’éléments textuels.</p>
</div>
<div id="exemple-dannotations-mathématiques-plus-poussées" class="section level4">
<h4>Exemple d’annotations mathématiques plus poussées</h4>

<p>Dans le graphique intitulé « Densité empirique des magnitudes dans le jeu de données quakes », introduisons des notations mathématiques dans la légende.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1"><span class="co"># Initialisation de l&#39;histogramme</span></a>
<a class="sourceLine" id="cb52-2" title="2"><span class="kw">hist</span>(quakes<span class="op">$</span>mag, <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;densité&quot;</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb52-3" title="3">     <span class="dt">main =</span> <span class="st">&quot;Densité empirique des magnitudes</span><span class="ch">\n</span><span class="st">dans le jeu de données quakes&quot;</span>)</a>
<a class="sourceLine" id="cb52-4" title="4"></a>
<a class="sourceLine" id="cb52-5" title="5"><span class="co"># Ajout de la courbe de densité à noyau</span></a>
<a class="sourceLine" id="cb52-6" title="6"><span class="kw">lines</span>(<span class="kw">density</span>(quakes<span class="op">$</span>mag), <span class="dt">xlim =</span> <span class="kw">range</span>(quakes<span class="op">$</span>mag))</a>
<a class="sourceLine" id="cb52-7" title="7"></a>
<a class="sourceLine" id="cb52-8" title="8"><span class="co"># Ajout de courbes de densité théoriques avec paramètres estimés à partir des données</span></a>
<a class="sourceLine" id="cb52-9" title="9">moy &lt;-<span class="st"> </span><span class="kw">mean</span>(quakes<span class="op">$</span>mag)</a>
<a class="sourceLine" id="cb52-10" title="10">et &lt;-<span class="st"> </span><span class="kw">sd</span>(quakes<span class="op">$</span>mag)</a>
<a class="sourceLine" id="cb52-11" title="11"><span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean =</span> moy, <span class="dt">sd =</span> et), </a>
<a class="sourceLine" id="cb52-12" title="12">      <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">7</span>))</a>
<a class="sourceLine" id="cb52-13" title="13"><span class="kw">curve</span>(<span class="kw">dlnorm</span>(x, <span class="dt">meanlog =</span> <span class="kw">mean</span>(<span class="kw">log</span>(quakes<span class="op">$</span>mag)), <span class="dt">sdlog =</span> <span class="kw">sd</span>(<span class="kw">log</span>(quakes<span class="op">$</span>mag))), </a>
<a class="sourceLine" id="cb52-14" title="14">      <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">7</span>))</a>
<a class="sourceLine" id="cb52-15" title="15"><span class="kw">curve</span>(<span class="kw">dgamma</span>(x, <span class="dt">shape =</span> moy<span class="op">^</span><span class="dv">2</span><span class="op">/</span>et<span class="op">^</span><span class="dv">2</span>, <span class="dt">rate =</span> moy<span class="op">/</span>et<span class="op">^</span><span class="dv">2</span>), </a>
<a class="sourceLine" id="cb52-16" title="16">      <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">3.5</span>, <span class="dv">7</span>))</a>
<a class="sourceLine" id="cb52-17" title="17"></a>
<a class="sourceLine" id="cb52-18" title="18"><span class="co"># Ajout d&#39;une légende</span></a>
<a class="sourceLine" id="cb52-19" title="19"><span class="kw">legend</span>(</a>
<a class="sourceLine" id="cb52-20" title="20">  <span class="dt">x =</span> <span class="st">&quot;topright&quot;</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>,</a>
<a class="sourceLine" id="cb52-21" title="21">  <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>),</a>
<a class="sourceLine" id="cb52-22" title="22">  <span class="dt">legend =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb52-23" title="23">    <span class="st">&quot;Densité à noyau&quot;</span>, </a>
<a class="sourceLine" id="cb52-24" title="24">    <span class="kw">expression</span>(</a>
<a class="sourceLine" id="cb52-25" title="25">      <span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb52-26" title="26">        <span class="st">&quot;N&quot;</span>, </a>
<a class="sourceLine" id="cb52-27" title="27">        <span class="kw">bgroup</span>(<span class="st">&quot;(&quot;</span>,<span class="kw">list</span>(mu <span class="op">==</span><span class="st"> </span><span class="kw">bar</span>(x), sigma<span class="op">^</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span>s[x]<span class="op">^</span><span class="dv">2</span>),<span class="st">&quot;)&quot;</span>)</a>
<a class="sourceLine" id="cb52-28" title="28">      )</a>
<a class="sourceLine" id="cb52-29" title="29">    ), </a>
<a class="sourceLine" id="cb52-30" title="30">    <span class="kw">expression</span>(</a>
<a class="sourceLine" id="cb52-31" title="31">      <span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb52-32" title="32">        <span class="st">&quot;Log-N&quot;</span>, </a>
<a class="sourceLine" id="cb52-33" title="33">        <span class="kw">bgroup</span>(<span class="st">&quot;(&quot;</span>,<span class="kw">list</span>(mu <span class="op">==</span><span class="st"> </span><span class="kw">bar</span>(y), sigma<span class="op">^</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span>s[y]<span class="op">^</span><span class="dv">2</span>),<span class="st">&quot;)&quot;</span>), </a>
<a class="sourceLine" id="cb52-34" title="34">        <span class="st">&quot; avec &quot;</span>, </a>
<a class="sourceLine" id="cb52-35" title="35">        y <span class="op">==</span><span class="st"> </span><span class="kw">ln</span>(x)</a>
<a class="sourceLine" id="cb52-36" title="36">      )</a>
<a class="sourceLine" id="cb52-37" title="37">    ), </a>
<a class="sourceLine" id="cb52-38" title="38">    <span class="kw">expression</span>(</a>
<a class="sourceLine" id="cb52-39" title="39">      <span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb52-40" title="40">        <span class="st">&quot;Gamma&quot;</span>, </a>
<a class="sourceLine" id="cb52-41" title="41">        <span class="kw">bgroup</span>(<span class="st">&quot;(&quot;</span>,<span class="kw">list</span>(alpha <span class="op">==</span><span class="st"> </span><span class="kw">bar</span>(x)<span class="op">^</span><span class="dv">2</span><span class="op">/</span>s[x]<span class="op">^</span><span class="dv">2</span>, beta <span class="op">==</span><span class="st"> </span><span class="kw">bar</span>(x)<span class="op">/</span>s[x]<span class="op">^</span><span class="dv">2</span>),<span class="st">&quot;)&quot;</span>)</a>
<a class="sourceLine" id="cb52-42" title="42">      )</a>
<a class="sourceLine" id="cb52-43" title="43">    )</a>
<a class="sourceLine" id="cb52-44" title="44">  )</a>
<a class="sourceLine" id="cb52-45" title="45">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-60-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Dans ce code, les trois derniers éléments du vecteur fourni à l’argument <code>legend</code> de la fonction du même nom sont des expressions. Ces éléments sont créés par des appels à la fonction <code>expression</code>. Penchons-nous sur un de ces appels pour tenter de mieux le comprendre.</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="kw">expression</span>(</a>
<a class="sourceLine" id="cb53-2" title="2">  <span class="kw">paste</span>(</a>
<a class="sourceLine" id="cb53-3" title="3">    <span class="st">&quot;Log-N&quot;</span>, </a>
<a class="sourceLine" id="cb53-4" title="4">    <span class="kw">bgroup</span>(<span class="st">&quot;(&quot;</span>,<span class="kw">list</span>(mu <span class="op">==</span><span class="st"> </span><span class="kw">bar</span>(y), sigma<span class="op">^</span><span class="dv">2</span> <span class="op">==</span><span class="st"> </span>s[y]<span class="op">^</span><span class="dv">2</span>),<span class="st">&quot;)&quot;</span>), </a>
<a class="sourceLine" id="cb53-5" title="5">    <span class="st">&quot; avec &quot;</span>, </a>
<a class="sourceLine" id="cb53-6" title="6">    y <span class="op">==</span><span class="st"> </span><span class="kw">ln</span>(x)</a>
<a class="sourceLine" id="cb53-7" title="7">  )</a>
<a class="sourceLine" id="cb53-8" title="8">)</a></code></pre></div>
<p>L’appel à la fonction <code>expression</code> contient un appel à la fonction <code>paste</code>. Comme expliqué à l’exemple précédent, nous sommes contraints à cette syntaxe parce que le libellé doit contenir à la fois des chaînes de caractères ordinaires (ici <code>"Log-N"</code> et <code>" avec "</code>) et des expressions mathématiques. La première expression mathématique dans le <code>paste</code> précédent est <code>bgroup("(",list(mu == bar(y), sigma^2 == s[y]^2),")")</code>. Cette expression permet de créer l’annotation ressemblant à <span class="math inline">\(\left( \mu = \bar{y}, \sigma^2 = s_y^2 \right)\)</span> grâce aux interprétations suivantes de ses éléments:</p>
<ul>
<li><code>bgroup("(", x, ")")</code> permet d’encadrer des éléments de parenthèses dont la hauteur s’adapte à la hauteur des éléments,</li>
<li><code>list(x, y)</code> sépare des éléments par une virgule (pas la même signification que la fonction <code>list</code> régulière),</li>
<li><code>mu</code> devient la lettre grecque <span class="math inline">\(\mu\)</span>,</li>
<li><code>==</code> devient un signe d’égalité,</li>
<li><code>bar(y)</code> devient <span class="math inline">\(\bar{y}\)</span>,</li>
<li><code>sigma</code> devient la lettre grecque <span class="math inline">\(\sigma\)</span>,</li>
<li><code>^2</code> devient un exposant,</li>
<li><code>[y]</code> devient un indice,</li>
<li>etc.</li>
</ul>
<p><strong>Autres options</strong> :</p>
<p>Certains packages permettent de carrément de mettre des équations LaTeX dans les annotations de graphiques R, notamment les deux packages suivants.</p>
<ul>
<li><a href="https://CRAN.R-project.org/package=latex2exp" class="uri">https://CRAN.R-project.org/package=latex2exp</a></li>
<li><a href="https://CRAN.R-project.org/package=tikzDevice" class="uri">https://CRAN.R-project.org/package=tikzDevice</a></li>
</ul>
</div>
</div>
<div id="plusieurs-graphiques-dans-une-même-fenêtre" class="section level3">
<h3>Plusieurs graphiques dans une même fenêtre</h3>
<p>Il est possible de diviser la fenêtre graphique en sous-fenêtres. Les deux principaux outils offerts dans le système de base pour effectuer cette division sont les suivants :</p>
<ul>
<li>arguments <code>mfrow</code> ou <code>mfcol</code> de la fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/par.html"><code>par</code></a> : produit une grille de sous-fenêtres de tailles égales;</li>
<li>fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/layout.html"><code>layout</code></a> : permet de contrôler les dimensions des sous-fenêtres.</li>
</ul>
<div id="exemple-sous-fenêtres-de-tailles-égales---argument-mfrow-ou-mfcol-de-par" class="section level4">
<h4>Exemple : Sous-fenêtres de tailles égales - argument <code>mfrow</code> ou <code>mfcol</code> de <code>par</code></h4>

<p>Réunissons quatre représentations de la variable <code>mag</code> du jeu de données <code>quakes</code> dans un seul graphique.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="co"># Modification du paramètre graphique mfrow de façon à diviser la</span></a>
<a class="sourceLine" id="cb54-2" title="2"><span class="co"># fenêtre graphique en 4 sous-fenêtres sur une grille 2 par 2</span></a>
<a class="sourceLine" id="cb54-3" title="3">par.default &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb54-4" title="4"></a>
<a class="sourceLine" id="cb54-5" title="5"><span class="co"># Graphique dans la première sous-fenêtre</span></a>
<a class="sourceLine" id="cb54-6" title="6"><span class="kw">hist</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag, <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;densité&quot;</span>, </a>
<a class="sourceLine" id="cb54-7" title="7">     <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb54-8" title="8"></a>
<a class="sourceLine" id="cb54-9" title="9"><span class="co"># Graphique dans la deuxième sous-fenêtre</span></a>
<a class="sourceLine" id="cb54-10" title="10"><span class="kw">plot</span>(<span class="dt">x =</span> <span class="kw">density</span>(quakes<span class="op">$</span>mag), <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;densité&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb54-11" title="11"></a>
<a class="sourceLine" id="cb54-12" title="12"><span class="co"># Graphique dans la troisième sous-fenêtre</span></a>
<a class="sourceLine" id="cb54-13" title="13"><span class="kw">boxplot</span>(quakes<span class="op">$</span>mag, <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>)</a>
<a class="sourceLine" id="cb54-14" title="14"></a>
<a class="sourceLine" id="cb54-15" title="15"><span class="co"># Graphique dans la quatrième sous-fenêtre</span></a>
<a class="sourceLine" id="cb54-16" title="16"><span class="kw">qqnorm</span>(quakes<span class="op">$</span>mag, <span class="dt">xlab =</span> <span class="st">&quot;quantiles théoriques normaux&quot;</span>, </a>
<a class="sourceLine" id="cb54-17" title="17">       <span class="dt">ylab =</span> <span class="st">&quot;quantiles empiriques&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb54-18" title="18"><span class="kw">qqline</span>(quakes<span class="op">$</span>mag)</a>
<a class="sourceLine" id="cb54-19" title="19"></a>
<a class="sourceLine" id="cb54-20" title="20"><span class="co"># Réattribution des valeurs par défaut aux paramètres graphiques</span></a>
<a class="sourceLine" id="cb54-21" title="21"><span class="kw">par</span>(par.default)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-62-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>L’argument <code>mfrow = c(2, 2)</code> a provoqué la division de la fenêtre graphique en une grille de sous-fenêtres comprenant 2 lignes et 2 colonnes. Les quatre graphiques produits après avoir modifié cet argument ont été distribués, ligne par ligne, dans cette grille. Si l’argument <code>mfcol</code> avait été utilisé au lieu de <code>mfrow</code>, les graphiques auraient été distribués en remplissant la grille une colonne à la fois, de la première à la dernière. Afin de retrouver une fenêtre graphique non divisée en sous-fenêtre, il ne faut pas oublier de remettre à <code>c(1, 1)</code> la valeur du paramètre graphique <code>mfrow</code> ou <code>mfcol</code> (ce qui est fait ci-dessus par la commande <code>par(par.default)</code>).</p>
</div>
<div id="exemple-sous-fenêtres-de-tailles-inégales---fonction-layout" class="section level4">
<h4>Exemple : Sous-fenêtres de tailles inégales - fonction <code>layout</code></h4>

<p>La fonction <code>layout</code> découpe aussi la fenêtre graphique en grille de sous-fenêtres. Cependant, les hauteurs et largeurs des bandes du quadrillage peuvent être personnalisées à l’aide d’arguments de la fonction (<code>widths</code> et <code>heights</code>). Le premier argument à fournir à la fonction <code>layout</code>, nommé <code>mat</code>, est une matrice de même dimension que la grille à créer. Cette matrice peut uniquement contenir des nombres entiers entre 0 et le nombre total de sous-graphiques à insérer dans la fenêtre, inclusivement. Dans les commandes qui suivent l’appel à la fonction <code>layout</code>, le premier graphique produit est affiché dans la sous-fenêtre associée au chiffre 1, le deuxième dans la sous-fenêtre associée au chiffre 2 et ainsi de suite. L’attribution du chiffre zéro à une sous-fenêtre signifie qu’aucun graphique ne doit être affiché dans cette sous-fenêtre. L’attribution d’un même entier positif à plusieurs sous-fenêtres adjacentes permet de les fusionner en une seule sous-fenêtre.</p>
<p>La fonction <code>layout.show</code> permet de visualiser les sous-fenêtres créées.</p>
<p>Voici un exemple de découpage en sous-fenêtre avec <code>layout</code>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>), <span class="dt">widths =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">layout.show</span>(<span class="dt">n =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-63-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Maintenant, répartissons des graphiques concernant les données <code>quakes</code> dans les sous-fenêtres de la disposition que nous venons de créer avec <code>layout</code>.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="co"># Configuration des sous-fenêtres</span></a>
<a class="sourceLine" id="cb56-2" title="2"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>), <span class="dt">widths =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb56-3" title="3"></a>
<a class="sourceLine" id="cb56-4" title="4"><span class="co"># Graphique dans la première sous-fenêtre</span></a>
<a class="sourceLine" id="cb56-5" title="5"><span class="kw">hist</span>(quakes<span class="op">$</span>mag, <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;densité&quot;</span>, </a>
<a class="sourceLine" id="cb56-6" title="6">     <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb56-7" title="7"><span class="co"># Graphique dans la deuxième sous-fenêtre</span></a>
<a class="sourceLine" id="cb56-8" title="8"><span class="kw">boxplot</span>(quakes<span class="op">$</span>mag, <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>)</a>
<a class="sourceLine" id="cb56-9" title="9"></a>
<a class="sourceLine" id="cb56-10" title="10"><span class="co"># Graphique dans la troisième sous-fenêtre</span></a>
<a class="sourceLine" id="cb56-11" title="11"><span class="kw">qqnorm</span>(quakes<span class="op">$</span>mag, <span class="dt">xlab =</span> <span class="st">&quot;quantiles théoriques normaux&quot;</span>, </a>
<a class="sourceLine" id="cb56-12" title="12">       <span class="dt">ylab =</span> <span class="st">&quot;quantiles empiriques de la magnitude&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb56-13" title="13"><span class="kw">qqline</span>(quakes<span class="op">$</span>mag)</a>
<a class="sourceLine" id="cb56-14" title="14"></a>
<a class="sourceLine" id="cb56-15" title="15"><span class="co"># Réattribution de la valeur par défaut de layout</span></a>
<a class="sourceLine" id="cb56-16" title="16"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span>))</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-64-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Comme pour les paramètres modifés avec la fonction <code>par</code>, le découpage effectué par <code>layout</code> est effectif tant qu’il n’est pas modifé de nouveau avec <code>layout</code> ou jusqu’à la fin de la session R. Une bonne pratique est donc de redonner à <code>layout</code> sa valeur par défaut à la fin du code de création du graphique avec l’instruction <code>layout(matrix(1))</code>, comme nous l’avons fait ci-dessus.</p>
<p>Nous pourrions améliorer ce graphique en ajustant les marges. Nous pourrions également mettre des sous-titres et un titre global.</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="co"># Enregistrement des valeurs par défaut aux paramètres graphiques</span></a>
<a class="sourceLine" id="cb57-2" title="2">par.default &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">no.readonly =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb57-3" title="3"></a>
<a class="sourceLine" id="cb57-4" title="4"><span class="co"># Configuration des sous-fenêtres</span></a>
<a class="sourceLine" id="cb57-5" title="5"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="dt">nrow =</span> <span class="dv">2</span>), <span class="dt">widths =</span> <span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb57-6" title="6"></a>
<a class="sourceLine" id="cb57-7" title="7"><span class="co"># Pour créer un espace pour le titre global (dans la marge externe)</span></a>
<a class="sourceLine" id="cb57-8" title="8"><span class="kw">par</span>(<span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>, <span class="dv">0</span>))</a>
<a class="sourceLine" id="cb57-9" title="9"></a>
<a class="sourceLine" id="cb57-10" title="10"><span class="co"># Graphique dans la première sous-fenêtre</span></a>
<a class="sourceLine" id="cb57-11" title="11"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">3.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>), <span class="dt">cex.main =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb57-12" title="12"><span class="kw">hist</span>(quakes<span class="op">$</span>mag, <span class="dt">ylab =</span> <span class="st">&quot;densité&quot;</span>, <span class="dt">freq =</span> <span class="ot">FALSE</span>, <span class="dt">main =</span> <span class="st">&quot;Histogramme&quot;</span>)</a>
<a class="sourceLine" id="cb57-13" title="13"></a>
<a class="sourceLine" id="cb57-14" title="14"><span class="co"># Graphique dans la deuxième sous-fenêtre</span></a>
<a class="sourceLine" id="cb57-15" title="15"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">2.1</span>, <span class="fl">2.1</span>))</a>
<a class="sourceLine" id="cb57-16" title="16"><span class="kw">boxplot</span>(quakes<span class="op">$</span>mag, <span class="dt">horizontal =</span> <span class="ot">TRUE</span>, <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>,</a>
<a class="sourceLine" id="cb57-17" title="17">        <span class="dt">main =</span> <span class="st">&quot;Diagramme en boîte&quot;</span>)</a>
<a class="sourceLine" id="cb57-18" title="18"></a>
<a class="sourceLine" id="cb57-19" title="19"><span class="co"># Graphique dans la troisième sous-fenêtre</span></a>
<a class="sourceLine" id="cb57-20" title="20"><span class="kw">qqnorm</span>(quakes<span class="op">$</span>mag, <span class="dt">xlab =</span> <span class="st">&quot;quantiles théoriques normaux&quot;</span>, </a>
<a class="sourceLine" id="cb57-21" title="21">       <span class="dt">ylab =</span> <span class="st">&quot;quantiles empiriques de la magnitude&quot;</span>, </a>
<a class="sourceLine" id="cb57-22" title="22">       <span class="dt">main =</span> <span class="st">&quot;Diagramme quantile-quantile&quot;</span>)</a>
<a class="sourceLine" id="cb57-23" title="23"><span class="kw">qqline</span>(quakes<span class="op">$</span>mag)</a>
<a class="sourceLine" id="cb57-24" title="24"></a>
<a class="sourceLine" id="cb57-25" title="25"><span class="co"># Ajout du titre global dans la marge externe</span></a>
<a class="sourceLine" id="cb57-26" title="26"><span class="kw">mtext</span>(<span class="st">&quot;Densité empirique des magnitudes dans le jeu de données quakes&quot;</span>,</a>
<a class="sourceLine" id="cb57-27" title="27">      <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">cex =</span> <span class="fl">1.2</span>, <span class="dt">line =</span> <span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb57-28" title="28"></a>
<a class="sourceLine" id="cb57-29" title="29"><span class="co"># Réattribution des valeurs par défaut aux paramètres graphiques</span></a>
<a class="sourceLine" id="cb57-30" title="30"><span class="kw">par</span>(par.default)</a>
<a class="sourceLine" id="cb57-31" title="31"><span class="kw">layout</span>(<span class="kw">matrix</span>(<span class="dv">1</span>))</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-65-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p><strong>Autres exemples d’utilisation de layout</strong> :</p>
<ul>
<li><a href="http://www.statmethods.net/advgraphs/layout.html" class="uri">http://www.statmethods.net/advgraphs/layout.html</a></li>
<li><a href="http://sas-and-r.blogspot.com/2012/09/example-103-enhanced-scatterplot-with.html" class="uri">http://sas-and-r.blogspot.com/2012/09/example-103-enhanced-scatterplot-with.html</a></li>
</ul>
</div>
</div>
</div>
<div id="aspects-techniques" class="section level2">
<h2>Aspects techniques</h2>
<p>Créer un graphique en R signifie soumettre un programme R qui génère le graphique. Pour produire de nouveau le même graphique, il suffit de conserver le programme permettant de générer le graphique et de le soumettre de nouveau dans la console. Le fait de produire le graphique par un programme plutôt que par un menu dans lequel nous sélectionnons des options permet d’automatiser le travail et de sauver du temps lorsque nous avons à produire plusieurs graphiques similaires.</p>
<div id="fenêtres-graphiques" class="section level3">
<h3>Fenêtres graphiques</h3>
<p>En R, les graphiques sont par défaut tous créés dans la même fenêtre. RStudio conserve un historique des graphiques, ce qui permet de réafficher un graphique produit antérieurement, mais au cours d’une même session R.</p>
<p>Nous pouvons aussi choisir d’ouvrir une nouvelle fenêtre graphique avec la commande <code>dev.new()</code> ou avec</p>
<ul>
<li><code>windows()</code> sur Windows,</li>
<li><code>quartz()</code> sur Mac OS X / OS X / macOS,</li>
<li><code>X11()</code> sur Unix / Linux.</li>
</ul>
<p>Les dimensions de la fenêtre graphique courante sont les suivantes</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">par</span>(<span class="st">&quot;din&quot;</span>)</a></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb59-1" title="1"><span class="co"># ou</span></a>
<a class="sourceLine" id="cb59-2" title="2"><span class="kw">dev.size</span>()</a></code></pre></div>
<pre><code>## [1] 7 5</code></pre>
<p>Ce paramètre graphique n’est pas modifiable (R.O. = <em>Read Only</em> dans la documentation de la fonction <code>par</code>). Cependant, les dimensions d’une nouvelle fenêtre ouverte avec <code>windows</code>, <code>quartz</code> ou <code>X11</code> peuvent être spécifiée avec les arguments <code>width</code> et <code>height</code>. Exemple :</p>
<!--
Comment modifier les dimensions de la fenêtre graphique ?

1. Redimensionner la fenêtre graphique avec la souris.  En Windows, dans une fenêtre ouverte avec `windows()`, les modes de redimensionnement sont les suivants :
    + mode R : dimensions fenêtres = dimensions du graphique;
    + ajuster à la fenêtre : dimensions du graphique ajustées aux dimensions de la fenêtre, mais ratio largeur/hauteur conservé;
    + taille fixe : dimensions du graphique fixes, donc non affectées par les dimensions de la fenêtre.
2. Ouvrir une nouvelle fenêtre avec `X11` (Unix / Linux), `windows` (Windows) ou `quartz` (Mac) et spécifier ses dimensions  avec les arguments `width` et `height`. Exemple :
-->
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb61-1" title="1"><span class="kw">windows</span>(<span class="dt">width =</span> <span class="dv">10</span>, <span class="dt">height =</span> <span class="fl">7.5</span>)</a></code></pre></div>
<p>Commandes utiles :</p>
<ul>
<li><code>dev.list()</code> : pour voir la liste de toutes les fenêtres graphiques ouvertes,</li>
<li><code>dev.cur()</code> : pour connaître la fenêtre graphique courante,</li>
<li><code>dev.off()</code> : pour fermer la fenêtre graphique courante (peut aussi être fermée avec la souris).</li>
</ul>
<p>Pour d’informations sont offertes dans la fiche d’aide R nommée <a href="https://stat.ethz.ch/R-manual/R-devel/library/grDevices/html/dev.html"><code>dev</code></a>.</p>
</div>
<div id="enregistrer-un-graphique" class="section level3">
<h3>Enregistrer un graphique</h3>
<p>En RStudio, nous pouvons enregistrer un graphique dans l’onglet « Plots » par le menu Export. Nous pouvons aussi le faire, comme dans l’exemple suivant, avec les fonctions <code>bmp</code>, <code>postscript</code>, <code>pdf</code>, <code>png</code>, <code>tiff</code>, <code>svg</code> ou <code>jpeg</code>, selon le format désiré.</p>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1"><span class="co"># Ouverture de la connexion avec un fichier</span></a>
<a class="sourceLine" id="cb62-2" title="2"><span class="kw">png</span>(<span class="st">&quot;test.png&quot;</span>)</a>
<a class="sourceLine" id="cb62-3" title="3"></a>
<a class="sourceLine" id="cb62-4" title="4"><span class="co"># Code pour créer le graphique</span></a>
<a class="sourceLine" id="cb62-5" title="5"><span class="kw">plot</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag, <span class="dt">y =</span> quakes<span class="op">$</span>stations)</a>
<a class="sourceLine" id="cb62-6" title="6"><span class="co"># potentiellement plusieurs lignes de code ici</span></a>
<a class="sourceLine" id="cb62-7" title="7"></a>
<a class="sourceLine" id="cb62-8" title="8"><span class="co"># Fermeture de la connexion avec le fichier</span></a>
<a class="sourceLine" id="cb62-9" title="9"><span class="kw">dev.off</span>()</a></code></pre></div>
<p>En fait, ces fonctions redirigent l’affichage de graphiques vers un fichier. L’instruction <code>dev.off()</code> est nécessaire pour mettre un terme à la communication entre R et le fichier ouvert.</p>
</div>
<div id="autres-fonctions-et-trucs-utiles" class="section level3">
<h3>Autres fonctions et trucs utiles</h3>
<p>À titre de référence, voici une liste de quelques autres fonctions utiles avec des graphiques produits à l’aide du système de base en R.</p>
<ul>
<li><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/locator.html"><code>locator</code></a> : pour identifier avec la souris une position;</li>
<li><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/identify.html"><code>identify</code></a> : pour identifier avec la souris des observations;</li>
<li><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/clip.html"><code>clip</code></a> : pour restreindre la zone d’ajouts dans un graphique;</li>
<li><a href="http://stat.ethz.ch/R-manual/R-devel/library/base/html/jitter.html"><code>jitter</code></a> : pour ajouter un peu de bruits à des valeurs numériques, ce qui peut permettre de visualiser plus facilement des observations superposées.</li>
</ul>
<p>Aussi, il est bon de savoir que plusieurs fonctions graphiques de base peuvent, tout comme <code>hist</code>, retourner des valeurs en plus de créer un graphique. Les valeurs retournées contiennent, par exemple :</p>
<ul>
<li>les <strong>coordonnées</strong> de certains éléments dans le graphique, par exemple :
<ul>
<li>dans un histogramme produit avec <code>hist</code> : les coordonnées des limites et des centres des barres (en d’autres mots des intervalles),</li>
<li>dans un diagramme à barres produit avec <code>barplot</code> : les coordonnées centrales des barres sur l’axe de la variable catégorique;</li>
<li>etc.;</li>
</ul></li>
<li>des <strong>statistiques</strong> calculées pour produire le graphique, par exemple :
<ul>
<li>dans un histogramme produit avec <code>hist</code> : les fréquences des observations dans les intervalles,</li>
<li>dans des diagrammes en boîte produits par la fonction <code>boxplot</code> : les statistiques représentées dans les diagrammes,</li>
<li>etc.</li>
</ul></li>
</ul>
<div id="exemple-dutilisation-des-valeurs-retournées-par-la-fonction-barplot." class="section level4">
<h4>Exemple d’utilisation des valeurs retournées par la fonction <code>barplot</code>.</h4>

<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb63-1" title="1"><span class="co"># Calcul des fréquences</span></a>
<a class="sourceLine" id="cb63-2" title="2">freq &lt;-<span class="st"> </span><span class="kw">table</span>(quakes<span class="op">$</span>mag_catego)</a>
<a class="sourceLine" id="cb63-3" title="3"><span class="co"># Production du diagramme à barres</span></a>
<a class="sourceLine" id="cb63-4" title="4">out_barplot &lt;-<span class="st"> </span><span class="kw">barplot</span>(freq)</a>
<a class="sourceLine" id="cb63-5" title="5">out_barplot</a></code></pre></div>
<pre><code>##      [,1]
## [1,]  0.7
## [2,]  1.9
## [3,]  3.1</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb65-1" title="1"><span class="co"># Ajout de texte au-dessus du deuxième bâton</span></a>
<a class="sourceLine" id="cb65-2" title="2"><span class="kw">text</span>(</a>
<a class="sourceLine" id="cb65-3" title="3">  <span class="dt">x =</span> out_barplot[<span class="dv">2</span>, <span class="dv">1</span>],  <span class="co"># coordonnée en x du centre du bâton tirée de out_barplot</span></a>
<a class="sourceLine" id="cb65-4" title="4">  <span class="dt">y =</span> freq[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb65-5" title="5">  <span class="dt">labels =</span> freq[<span class="dv">2</span>],</a>
<a class="sourceLine" id="cb65-6" title="6">  <span class="dt">pos =</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb65-7" title="7">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-70-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="résumé-et-point-de-vue" class="section level2">
<h2>Résumé et point de vue</h2>
<p>La fonction générique <code>plot</code> choisit un bon type de graphique à produire selon le <strong>nombre</strong> et la <strong>nature des variables</strong> reçues en entrée.</p>
<p>Sinon, les fonctions graphiques de base en R font très peu de choix pour l’utilisateur.</p>
<p>Les graphiques initialisés sont typiquement minimalistes. Nous y ajoutons ce que nous voulons. Et les possibilités sont nombreuses.</p>
<ul>
<li>Avantage : Nous avons le plein contrôle sur l’apparence du graphique.</li>
<li>Désavantage : Il faut parfois travailler fort pour arriver à nos fins.</li>
</ul>
<div id="faiblesse-du-système-graphique-de-base" class="section level4">
<h4>Faiblesse du système graphique de base :</h4>
<p>Les représentations multivariables ne sont pas simples à produire. Il n’est pas toujours facile, avec les fonctions graphiques de base, de représenter trois variables et plus sur le même graphique.</p>
</div>
<div id="exemple---représenter-deux-variables-numériques-et-une-variable-catégorique" class="section level4">
<h4>Exemple - Représenter deux variables numériques et une variable catégorique</h4>

<p>Tentons de représenter la relation entre les variables numériques <code>stations</code> et <code>mag</code> de <code>quakes</code> en fonction de la variable catégorique <code>region</code>.</p>
<div id="option-1-sous-fenêtres-selon-la-variable-catégorique" class="section level5">
<h5>Option 1 : Sous-fenêtres selon la variable catégorique</h5>

<p>Graphiques par niveau du facteur placés côte-à-côte.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1">par.default &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb66-2" title="2"><span class="kw">plot</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> quakes, <span class="dt">subset =</span> region <span class="op">==</span><span class="st"> &quot;Ouest&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Region Ouest&quot;</span>)</a>
<a class="sourceLine" id="cb66-3" title="3"><span class="kw">plot</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> quakes, <span class="dt">subset =</span> region <span class="op">==</span><span class="st"> &quot;Est&quot;</span>, <span class="dt">main =</span> <span class="st">&quot;Region Est&quot;</span>)</a>
<a class="sourceLine" id="cb66-4" title="4"><span class="kw">par</span>(par.default)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-71-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Il faudrait idéalement :</p>
<ul>
<li>ajuster les axes afin que tous les graphiques couvrent la même région,</li>
<li>éviter la redondance dans les noms des axes.</li>
</ul>
</div>
<div id="option-2-superposition-avec-aspect-distinctif-selon-la-variable-catégorique" class="section level5">
<h5>Option 2 : Superposition avec aspect distinctif selon la variable catégorique</h5>

<p>Faisons varier le symbole utilisé pour les points et sa couleur selon le niveau du facteur <code>region</code>.</p>
<p>Nous pouvons donner aux arguments graphiques un vecteur de valeurs, plutôt qu’une seule valeur. Ce vecteur doit être de même longueur que le nombre d’observations à représenter (sinon il sera recyclé ou tronqué).</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb67-1" title="1"><span class="kw">plot</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> quakes, </a>
<a class="sourceLine" id="cb67-2" title="2">     <span class="dt">pch =</span> <span class="kw">as.numeric</span>(region), <span class="dt">col =</span> <span class="kw">as.numeric</span>(region) <span class="op">+</span><span class="st"> </span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-72-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Notons que nous avions déjà produit un graphique similaire avec <code>matplot</code>. Ce graphique pourrait aussi être produit en ajoutant les points pour chaque groupe dans des étapes séparées, comme suit.</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb68-1" title="1"><span class="co"># Initialisation d&#39;un graphique vide, mais avec les bonnes étendues</span></a>
<a class="sourceLine" id="cb68-2" title="2"><span class="kw">plot</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> quakes, <span class="dt">type =</span> <span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb68-3" title="3"><span class="co"># Ajout des points pour la région Ouest</span></a>
<a class="sourceLine" id="cb68-4" title="4"><span class="kw">points</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> quakes, <span class="dt">subset =</span> region <span class="op">==</span><span class="st"> &quot;Ouest&quot;</span>, <span class="dt">pch =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="dv">3</span>)</a>
<a class="sourceLine" id="cb68-5" title="5"><span class="co"># Ajout des points pour la région Est</span></a>
<a class="sourceLine" id="cb68-6" title="6"><span class="kw">points</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> quakes, <span class="dt">subset =</span> region <span class="op">==</span><span class="st"> &quot;Est&quot;</span>, <span class="dt">pch =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="dv">4</span>)</a></code></pre></div>
<p>Il faudrait ajouter une légende pour identifier à quoi réfère les couleurs et les symboles.</p>
</div>
</div>
<div id="exemple---représenter-trois-variables-numériques-et-une-variable-catégorique" class="section level4">
<h4>Exemple - Représenter trois variables numériques et une variable catégorique</h4>

<p>Tentons maintenant de représenter dans un même graphique les variables suivantes de <code>quakes</code> : <code>lat</code>, <code>long</code>, <code>mag</code> et <code>region</code>.</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb69-1" title="1">par.default &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">pty =</span> <span class="st">&quot;s&quot;</span>)</a>
<a class="sourceLine" id="cb69-2" title="2"><span class="co"># pty = &quot;s&quot; permet d&#39;avoir une région graphique carrée</span></a>
<a class="sourceLine" id="cb69-3" title="3"><span class="kw">plot</span>(lat <span class="op">~</span><span class="st"> </span>long, <span class="dt">data =</span> quakes, <span class="dt">asp =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb69-4" title="4">     <span class="co"># asp = 1 permet d&#39;avoir des axes sur la même échelle, </span></a>
<a class="sourceLine" id="cb69-5" title="5">     <span class="co"># ce qui est préférable ici, car les variables sont des coordonnées géographiques</span></a>
<a class="sourceLine" id="cb69-6" title="6">     <span class="dt">cex =</span> <span class="dv">3</span><span class="op">*</span>(mag <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(mag))<span class="op">/</span>(<span class="kw">max</span>(mag) <span class="op">-</span><span class="st"> </span><span class="kw">min</span>(mag)) <span class="op">+</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">pch =</span> <span class="dv">20</span>,</a>
<a class="sourceLine" id="cb69-7" title="7">     <span class="co"># la taille du symbole dépend de la valeur de la variable mag</span></a>
<a class="sourceLine" id="cb69-8" title="8">     <span class="dt">col =</span> <span class="kw">ifelse</span>(region <span class="op">==</span><span class="st"> &quot;Ouest&quot;</span>, <span class="kw">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.3</span>)))</a>
<a class="sourceLine" id="cb69-9" title="9">     <span class="co"># la couleur du symbole dépend du facteur région</span></a>
<a class="sourceLine" id="cb69-10" title="10">     <span class="co"># des couleurs transparentes sont utilisées</span></a>
<a class="sourceLine" id="cb69-11" title="11"><span class="kw">par</span>(par.default)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-74-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Il faudrait ajouter une légende pour identifier à quoi réfère les couleurs différents (<code>region</code>) et les tailles différentes (<code>mag</code>).</p>
<p>Nous avons réussis à créer des représentations multivariables avec le système graphique de base, mais celles-ci devraient être encore travaillés un peu pour être vraiment adéquates. Les autres systèmes graphiques en R permettent de créer ce genre de graphiques plus rapidement.</p>
<hr />
</div>
</div>
</div>
<div id="package-lattice" class="section level1">
<h1>Package <code>lattice</code></h1>
<p>Le <a href="http://lattice.r-forge.r-project.org/">package <code>lattice</code></a> fut le premier à palier aux faiblesses de R quant aux représentations multivariables. Il a été développé par Deepayan Sarkar et publié pour la première fois en 2001. Il est basé sur le « trellis » système de S-PLUS, qui implémente le système graphique présenté dans : « Cleveland, W. S. (1993). <em>Visualizing data</em>. Hobart Press ». Il permet de facilement produire des graphiques conditionnels à la valeur d’un ou de plusieurs facteurs.</p>
<p>Le package <code>lattice</code> a une importance historique indéniable et a déjà été l’outil de prédilection pour les représentations multivariables en R. Il faut admettre cependant qu’il semble avoir été éclipsé par <code>ggplot2</code>. Pour cette raison, je ne présente ici que quelques exemples d’utilisation de ce package, faisant principalement appel à sa fonction <code>xyplot</code> servant à créer des diagrammes de dispersion. Des ressources pour en apprendre davantage à propos du package <code>lattice</code> sont mentionnées dans les références.</p>
<div id="caractéristiques" class="section level5">
<h5>Caractéristiques :</h5>

<ul>
<li>Les fonctions prennent idéalement une formule en entrée.
<ul>
<li>L’opérateur <code>|</code> sert à créer des grilles de sous-graphiques,
<ul>
<li>chacun des sous-graphiques est conditionnel à la valeur de facteurs(s), il représente donc seulement le sous-ensemble des observations ayant une modalité particulière pour ce(s) facteur(s).</li>
</ul></li>
</ul></li>
<li>L’argument <code>groups</code> sert à superposer des éléments avec un aspect (couleur, forme, taille, etc.) qui varie selon les niveaux d’un facteur.</li>
<li>Un graphique est créé par un seul appel à une fonction du package.
<ul>
<li>Les fonctions ont beaucoup de paramètres.</li>
<li>Il n’est pas possible d’ajouter des éléments à un graphique comme dans le système de base.</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="co"># Chargement du package</span></a>
<a class="sourceLine" id="cb70-2" title="2"><span class="kw">library</span>(lattice)</a></code></pre></div>
</div>
<div id="exemples-diagrammes-de-dispersion---fonction-xyplot" class="section level4">
<h4>Exemples : Diagrammes de dispersion - fonction <code>xyplot</code></h4>

<div id="diagramme-de-dispersion" class="section level5">
<h5>Diagramme de dispersion</h5>

<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb71-1" title="1"><span class="kw">xyplot</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> quakes)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-76-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="diagrammes-de-dipersion-juxtaposés" class="section level5">
<h5>Diagrammes de dipersion juxtaposés</h5>

<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">xyplot</span>(stations <span class="op">~</span><span class="st"> </span>mag <span class="op">|</span><span class="st"> </span>region, <span class="dt">data =</span> quakes)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-77-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="ajout-dune-courbe-de-lissage" class="section level5">
<h5>Ajout d’une courbe de lissage :</h5>

<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb73-1" title="1"><span class="kw">xyplot</span>(</a>
<a class="sourceLine" id="cb73-2" title="2">  stations <span class="op">~</span><span class="st"> </span>mag <span class="op">|</span><span class="st"> </span>region, <span class="dt">data =</span> quakes, </a>
<a class="sourceLine" id="cb73-3" title="3">  <span class="dt">type =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;smooth&quot;</span>), <span class="dt">lwd =</span> <span class="dv">3</span></a>
<a class="sourceLine" id="cb73-4" title="4">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-78-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="diagrammes-de-dispersion-superposés" class="section level5">
<h5>Diagrammes de dispersion superposés</h5>

<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">xyplot</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> quakes, <span class="dt">groups =</span> region, <span class="dt">auto.key =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-79-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>L’argument <code>auto.key</code> permet d’ajouter automatiquement une légende.</p>
</div>
<div id="exemple-complet-de-représentation-simultané-de-quatre-variables" class="section level5">
<h5>Exemple complet de représentation simultané de quatre variables</h5>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb75-1" title="1"><span class="kw">xyplot</span>(</a>
<a class="sourceLine" id="cb75-2" title="2">  stations <span class="op">~</span><span class="st"> </span>depth <span class="op">|</span><span class="st"> </span>region, <span class="dt">data =</span> quakes, <span class="dt">groups =</span> mag_catego,</a>
<a class="sourceLine" id="cb75-3" title="3">  <span class="dt">main =</span> <span class="st">&quot;Nombres de stations ayant rapporté les séismes</span><span class="ch">\n</span><span class="st">selon différentes variables&quot;</span>,</a>
<a class="sourceLine" id="cb75-4" title="4">  <span class="dt">xlab =</span> <span class="st">&quot;profondeur&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;nombre de stations&quot;</span>,</a>
<a class="sourceLine" id="cb75-5" title="5">  <span class="dt">auto.key =</span> <span class="kw">list</span>(<span class="dt">title =</span> <span class="st">&quot;classe de</span><span class="ch">\n</span><span class="st">magnitude&quot;</span>, <span class="dt">space =</span> <span class="st">&quot;right&quot;</span>, <span class="dt">cex.title =</span> <span class="fl">0.8</span>)</a>
<a class="sourceLine" id="cb75-6" title="6">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-80-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="exemple-diagramme-en-points-de-cleveland---fonction-dotplot" class="section level4">
<h4>Exemple : Diagramme en points de Cleveland - fonction <code>dotplot</code></h4>

<p>L’auteur du système graphique derrière le package <code>lattice</code>, soit William S. Cleveland, est aussi celui qui a proposé les diagrammes en points pouvant remplacer les diagrammes à barres. Le package <code>lattice</code> possède une fonction pour créer facilement de type de graphique : la fonction <code>dotplot</code>.</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1">quakes_freq &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">xtabs</span>(<span class="op">~</span><span class="st"> </span>region <span class="op">+</span><span class="st"> </span>mag_catego, <span class="dt">data =</span> quakes))</a>
<a class="sourceLine" id="cb76-2" title="2"><span class="kw">dotplot</span>(</a>
<a class="sourceLine" id="cb76-3" title="3">  mag_catego <span class="op">~</span><span class="st"> </span>Freq, <span class="dt">data =</span> quakes_freq, <span class="dt">groups =</span> region, </a>
<a class="sourceLine" id="cb76-4" title="4">  <span class="dt">xlab =</span> <span class="st">&quot;Fréquence&quot;</span>, <span class="dt">auto.key =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-81-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Remarquons que contrairement au diagramme similaire créé précédemment avec la fonction <code>dotchart</code> du système graphique de base, les points pour les deux niveaux de la variable <code>region</code> sont ici placés sur la même ligne, facilitant encore plus la visualisation de la différence entre les deux fréquences associées.</p>
</div>
</div>
<div id="package-ggplot2" class="section level1">
<h1>Package <code>ggplot2</code></h1>
<p>Le <a href="http://ggplot2.tidyverse.org/">package <code>ggplot2</code></a> a été publié pour la première fois en 2006 sous le nom de <code>ggplot</code>. Il fut amélioré de façon importante et renommé <code>ggplot2</code> en 2007. Son créateur est Hadley Wickham, qui est aussi derrière plusieurs des packages du <a href="https://www.tidyverse.org/"><code>tidyverse</code></a>, duquel <code>ggplot2</code> fait partie. Le package est maintenant <a href="https://CRAN.R-project.org/package=ggplot2">développé par toute une équipe</a>, dont des employés de RStudio. Il implémente la <strong>grammaire graphique</strong> présentée dans : « Wilkinson, L. (2005). <em>The grammar of graphics</em>, Second Edition. Springer ».</p>
<p>Le package <code>ggplot2</code> a été conçu en ayant comme objectif la <strong>simplicité d’utilisation</strong> et la <strong>qualité des graphiques produits</strong>. Il reprend les forces suivantes des systèmes graphiques R précédents :</p>
<ul>
<li>système de base : création de graphiques par <strong>couches</strong> (ajouts séquentiels d’éléments);</li>
<li>package <code>lattice</code> : <strong>représentations multivariables</strong> simples.</li>
</ul>
<p>tout en apportant les améliorations suivantes :</p>
<ul>
<li><strong>esthétique</strong> par défaut pensée de façon à transmettre plus efficacement les informations contenues dans le graphique;</li>
<li><strong>automatisation de certaines configurations</strong> graphiques, notamment les légendes;</li>
<li><strong>ajout de transformations statistiques</strong> communes (p. ex. courbes de lissage, barres d’erreur) facilité.</li>
</ul>
<p>Dans le package <code>ggplot2</code>, tout a été repensé pour être plus simple d’utilisation et surtout pour que le graphique produit transmette plus efficacement l’information qu’il contient.</p>
<p><img src="fig/ggplot2_masterpiece.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Illustration de <span class="citation">@allison_horst</span> <a href="https://github.com/allisonhorst/stats-illustrations" class="uri">https://github.com/allisonhorst/stats-illustrations</a></p>
<p> </p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb77-1" title="1"><span class="co"># Chargement du package</span></a>
<a class="sourceLine" id="cb77-2" title="2"><span class="kw">library</span>(ggplot2)</a></code></pre></div>
<div id="la-grammaire-graphique" class="section level2">
<h2>La grammaire graphique</h2>
<p>Le principe de base derrière la <strong>g</strong>rammaire <strong>g</strong>raphique (d’où le <code>gg</code> dans <code>ggplot</code>) est qu’un graphique statistique est une représentation de <strong>données</strong>, dans un <strong>système de coordonnées</strong> spécifique, divisée en éléments de base :</p>
<ul>
<li><strong>éléments géométriques</strong> (<em>geoms</em>) : points, lignes, barres, etc.;</li>
<li><strong>propriétés visuelles</strong> (<em>aesthetics</em>) des éléments géométriques : axes, couleurs, formes, tailles, etc.</li>
<li><strong>transformations statistiques</strong>, si désiré : courbe de régression ou de lissage, région d’erreur, etc.</li>
</ul>
<p>Un graphique est spécifié en <strong>associant des variables</strong>, provenant des données, <strong>à des propriétés visuelles</strong> des éléments géométriques du graphique. Ces principes sont représentés comme suit sur la feuille de triche officielle du package<a href="#fn11" class="footnote-ref" id="fnref11"><sup>11</sup></a>.</p>
<p><img src="fig/grammarBasics.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
<div id="principales-fonctions-et-gabarit-de-code" class="section level2">
<h2>Principales fonctions et gabarit de code</h2>
<p>Les principales fonctions du package <code>ggplot2</code> sont les suivantes :</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/ggplot.html"><code>ggplot</code></a> : initialisation d’un objet de classe <code>ggplot</code>;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/qplot.html"><code>qplot</code></a> : initialisation rapide (<code>q</code> pour <em>quick</em>) d’un objet <code>ggplot</code>;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/gg-add.html"><code>+</code></a> : opérateur pour l’ajout de couches ou la modification de configurations dans un objet <code>ggplot</code>;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html#section-layer-geoms">fonctions de type <code>geom_</code></a> (p. ex. <code>geom_point</code>, <code>geom_boxplot</code>, <code>geom_bar</code>, etc.) : spécification de couches à ajouter à un graphique;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/aes.html"><code>aes</code></a> : création d’un <code>mapping</code>, soit une association entre entre des propriétés visuelles et des variables;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/ggsave.html"><code>ggsave</code></a> : enregistrement d’un graphique.</li>
</ul>
<p>Notons que l’utilisation de la fonction <code>qplot</code> est plus intuitive que celle de <code>ggplot</code> pour des gens familiers avec <code>plot</code>. La fonction <code>qplot</code> n’offre cependant pas toutes les possibilités de <code>ggplot</code>. Elle ne sera pas couverte dans ce document.</p>
<p>Voici un gabarit minimaliste de code de création d’un graphique <code>ggplot2</code><a href="#fn12" class="footnote-ref" id="fnref12"><sup>12</sup></a> :</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb78-2" title="2"><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>))</a></code></pre></div>
<p>ou encore la version « tout sur la même ligne » :</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb79-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>))</a></code></pre></div>
<p>Dans ce gabarit, il faut remplacer les éléments entre <code>&lt;</code> et <code>&gt;</code> comme suit :</p>
<ul>
<li><code>&lt;DATA&gt;</code> = jeu de données, stocké dans un <strong>data frame</strong> (ou un tibble), dans lequel les variables catégoriques doivent être des <strong>facteurs</strong> (dont <strong>les libellés des niveaux ont avantage à être informatifs</strong>, car ils apparaîtront dans le graphique);</li>
<li><code>&lt;GEOM_FUNCTION&gt;</code> = le nom d’une fonction de type <code>geom_</code> pour ajouter une couche au graphique;</li>
<li><code>&lt;MAPPINGS&gt;</code> = arguments à fournir à la fonction <code>aes</code> (les arguments acceptés varient un peu selon la <code>&lt;GEOM_FUNCTION&gt;</code>).</li>
</ul>
<p>Voici un premier exemple simple.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag, <span class="dt">y =</span> stations))</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-87-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Les arguments <code>data</code> et <code>mapping</code> peuvent être fournis :</p>
<ul>
<li>à la fonction <code>ggplot</code> : leur valeur est alors commune à toutes le couches<br />
(il est tout de même possible de forcer l’utilisation d’autres données ou d’autres associations pour des couches spécifiques);</li>
<li>ou à une <code>&lt;GEOM_FUNCTION&gt;</code> : leur valeur est alors spécifique à la couche produite.</li>
</ul>
<p>Étant donné que le graphique produit par le gabarit minimaliste ne comprend qu’une seule couche, les syntaxes suivantes sont donc équivalentes à celle du gabarit.</p>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb81-1" title="1"><span class="co"># Argument data spécifique (fourni dans l&#39;appel à la &lt;GEOM_FUNCTION&gt;)</span></a>
<a class="sourceLine" id="cb81-2" title="2"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>))</a></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="co"># Argument mapping global (fourni dans l&#39;appel à ggplot)</span></a>
<a class="sourceLine" id="cb82-2" title="2"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>)) <span class="op">+</span><span class="st"> </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>()</a></code></pre></div>
<div id="quelques-fonctions-de-type-geom_" class="section level4">
<h4>Quelques fonctions de type <code>geom_</code> :</h4>

<table>
<colgroup>
<col width="16%" />
<col width="29%" />
<col width="54%" />
</colgroup>
<thead>
<tr class="header">
<th>Fonction</th>
<th>Type de graphique</th>
<th>Élément(s) ajouté(s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_point.html"><code>geom_point</code></a></td>
<td>diagramme de dispersion</td>
<td>points selon des coordonnées</td>
</tr>
<tr class="even">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_path.html"><code>geom_line</code></a></td>
<td>diagramme en lignes</td>
<td>segments de droites reliant des points</td>
</tr>
<tr class="odd">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_bar.html"><code>geom_bar</code></a></td>
<td>diagramme à barres</td>
<td>barres disjointes, de hauteurs spécifiées ou calculées = fréquences des niveaux d’un facteur</td>
</tr>
<tr class="even">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_histogram.html"><code>geom_histogram</code></a></td>
<td>histogramme</td>
<td>barres collées, de hauteurs calculées = fréquences d’observations d’une variable numérique tombant dans des intervalles joints (<em>bin</em>)</td>
</tr>
<tr class="odd">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_boxplot.html"><code>geom_boxplot</code></a></td>
<td>diagramme en boîte</td>
<td><em>boxplots</em></td>
</tr>
<tr class="even">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_density.html"><code>geom_density</code></a></td>
<td>courbe de densité à noyau</td>
<td>courbe de la densité estimée par noyau (<em>kernel density</em>)</td>
</tr>
<tr class="odd">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_qq.html"><code>geom_qq</code></a></td>
<td>diagramme quantile-quantile théorique</td>
<td>points pour les couples de quantiles empiriques et théoriques</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\vdots\)</span></td>
<td>il en existe plusieurs autres</td>
<td>voir <a href="http://ggplot2.tidyverse.org/reference/" class="uri">http://ggplot2.tidyverse.org/reference/</a></td>
</tr>
</tbody>
</table>
<p>La plupart de ces fonctions cachent des transformations statistiques (p. ex. <code>geom_bar</code> et <code>geom_histogram</code> calculent des fréquences, <code>geom_boxplot</code> calcule des quantiles, <code>geom_density</code> estime une densité, etc.)</p>
</div>
<div id="quelques-autres-fonctions-communes" class="section level4">
<h4>Quelques autres fonctions communes :</h4>

<p>Voici quelques autres fonctions communes de <code>ggplot2</code> servant à ajouter des couches ou modifier des configurations dans un objet <code>ggplot</code> initialisé :</p>
<ul>
<li>fonctions <a href="http://ggplot2.tidyverse.org/reference/labs.html"><code>labs</code>, <code>ggtitle</code>, <code>xlab</code>, <code>ylab</code></a> : ajouter un titre, modifier les noms d’axes;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html#section-coordinate-systems">fonctions de type <code>coord_</code></a> : modifier des configurations reliées au système de coordonnées;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html#section-facetting">fonctions de type <code>facet_</code></a> : créer des grilles de sous-graphiques
<ul>
<li>chacun des sous-graphiques est conditionnel à la valeur de facteurs(s), il représente donc seulement le sous-ensemble des observations ayant une modalité particulière pour ce(s) facteur(s);</li>
</ul></li>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html#section-scales">fonctions de type <code>scale_</code></a> : modifier les échelles de certaines propriétés visuelles (p. ex. couleurs, formes, tailles, etc.)</li>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html#section-themes">fonctions de type <code>theme_</code></a> : modifier des configurations reliées à l’apparence du graphique;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html#section-layer-stats">fonctions de type <code>stat_</code></a> : ajouts d’éléments tirés d’un calcul mathématique ou statistique.</li>
</ul>
<p>Le gabarit minimaliste présenté précédemment pourrait être rendu plus complet comme suit<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a>.</p>
<p><img src="fig/template.png" width="60%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="objet-de-classe-ggplot---production-et-enregistrement-du-graphique" class="section level2">
<h2>Objet de classe <code>ggplot</code> - production et enregistrement du graphique</h2>
<p>Notons qu’un graphique produit en <code>ggplot2</code> est en fait un objet de classe <code>ggplot</code>. La fonction <code>ggplot</code> initialise un objet de cette classe.</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb83-1" title="1">mon_graph &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes)</a></code></pre></div>
<p>Nous pouvons ajouter des couches à un objet <code>ggplot</code> avec l’opérateur <code>+</code>.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1">mon_graph &lt;-<span class="st"> </span>mon_graph <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag, <span class="dt">y =</span> stations))</a></code></pre></div>
<p>Il est possible d’observer le contenu de l’objet.</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb85-1" title="1"><span class="kw">str</span>(mon_graph)  <span class="co"># non évalué, car la sortie est longue</span></a></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">summary</span>(mon_graph)</a></code></pre></div>
<pre><code>## data: lat, long, depth, mag, stations, mag_catego, region [1000x7]
## faceting: &lt;ggproto object: Class FacetNull, Facet, gg&gt;
##     compute_layout: function
##     draw_back: function
##     draw_front: function
##     draw_labels: function
##     draw_panels: function
##     finish_data: function
##     init_scales: function
##     map_data: function
##     params: list
##     setup_data: function
##     setup_params: function
##     shrink: TRUE
##     train_scales: function
##     vars: function
##     super:  &lt;ggproto object: Class FacetNull, Facet, gg&gt;
## -----------------------------------
## mapping: x = ~mag, y = ~stations 
## geom_point: na.rm = FALSE
## stat_identity: na.rm = FALSE
## position_identity</code></pre>
<p>C’est en affichant une objet de classe <code>ggplot</code> qu’un graphique est produit.</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">mon_graph <span class="co"># ou print(mon_graph)</span></a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-95-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>La fonction <a href="http://ggplot2.tidyverse.org/reference/ggsave.html"><code>ggsave</code></a> permet quant à elle d’enregistrer un graphique <code>ggpot2</code>.</p>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb89-1" title="1"><span class="kw">ggsave</span>(<span class="dt">file =</span> <span class="st">&quot;ExempleGraphique_ggplot2.pdf&quot;</span>, <span class="dt">plot =</span> mon_graph)</a></code></pre></div>
<p>Le format du fichier à créer (p. ex. PDF, PNG, EPS, etc.) est déduit de l’extension du fichier si l’argument <code>device</code> n’est pas spécifié. Aussi, si aucune valeur n’est fourni à l’argument <code>plot</code>, c’est le dernier graphique <code>ggpot2</code> produit qui est enregistré. La dimension du graphique enregistré peut être contrôlée à l’aide des arguments <code>width</code>, <code>height</code> et <code>units</code>.</p>
</div>
<div id="démarche-de-création-dun-graphique-ggplot2" class="section level2">
<h2>Démarche de création d’un graphique <code>ggplot2</code></h2>
<p>Voici une suggestion de démarche à suivre lors de la création d’une graphique <code>ggplot2</code>.</p>
<ol style="list-style-type: decimal">
<li><strong>Planifier</strong> le travail - Répondre aux questions suivantes :
<ol style="list-style-type: lower-alpha">
<li>Je veux représenter <strong>quelles variables</strong>, de <strong>quel jeu de données</strong> ?</li>
<li>Je veux créer <strong>quel type de graphique</strong> ?</li>
<li><strong>Quelle fonction de type <code>geom_</code></strong> me permettra de produire les éléments géométriques de ce graphique ?</li>
<li>Cette fonction accepte <strong>quelles propriétés visuelles</strong> ? (voir <a href="http://ggplot2.tidyverse.org/reference/" class="uri">http://ggplot2.tidyverse.org/reference/</a>)</li>
<li>Je veux <strong>associer</strong> les variables concernées à quelles propriétés visuelles ?</li>
</ol></li>
<li>Écrire et soumettre la <strong>première version</strong> du code de création du graphique.</li>
<li>Modifier le code de création du graphique pour <strong>ajuster la mise en forme</strong> (titre, nom d’axes, autres annotations, palette de couleur, etc.) selon mes besoins,
<ul>
<li>travail itératif : cycle « modification code » <span class="math inline">\(\rightarrow\)</span> « jugement du graphique créé » répété jusqu’à l’obtention d’un résultat satisfaisant.</li>
</ul></li>
</ol>
<p>La planification effectuée avant de produire le premier exemple de graphique <code>ggplot</code> pourrait être représentée comme suit.</p>
<p><img src="fig/mapping.png" width="90%" style="display: block; margin: auto;" /></p>
<p>Pour réaliser cette planification, il a fallu obtenir de la fiche d’aide de la fonction <a href="https://ggplot2.tidyverse.org/reference/geom_point.html"><code>geom_point</code></a> la liste des propriétés visuelles qu’elle accepte.</p>
</div>
<div id="exemples-de-configurations-graphiques-simples" class="section level2">
<h2>Exemples de configurations graphiques simples</h2>
<div id="ajout-dun-titre-et-de-noms-daxes---fonction-labs" class="section level3">
<h3>Ajout d’un titre et de noms d’axes - fonction <code>labs</code></h3>
<p>Ajoutons un titre et des noms d’axes à note premier graphique <code>ggplot</code>.</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb90-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag, <span class="dt">y =</span> stations)) <span class="op">+</span></a>
<a class="sourceLine" id="cb90-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1000 séismes près de Fidji&quot;</span>) <span class="op">+</span><span class="st">         </span><span class="co"># ou ggtitle(&quot;...&quot;) +</span></a>
<a class="sourceLine" id="cb90-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;magnitude du séisme&quot;</span>) <span class="op">+</span><span class="st">                    </span><span class="co"># ou xlab(&quot;...&quot;) +</span></a>
<a class="sourceLine" id="cb90-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;nombre de stations rapportant le séisme&quot;</span>)  <span class="co"># ou ylab(&quot;...&quot;)</span></a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-98-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Vous avez envie de centrer le titre du graphique ? Voici comment faire.</p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb91-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb91-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag, <span class="dt">y =</span> stations)) <span class="op">+</span></a>
<a class="sourceLine" id="cb91-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1000 séismes près de Fidji&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb91-4" title="4"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span><span class="st">  </span><span class="co"># permet de centrer le titre</span></a>
<a class="sourceLine" id="cb91-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;magnitude du séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb91-6" title="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;nombre de stations rapportant le séisme&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-99-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Références :</p>
<ul>
<li>Ajout d’un titre et de noms d’axes :
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="uri">https://ggplot2.tidyverse.org/reference/labs.html</a></li>
</ul></li>
<li>Modification de l’alignement du titre :
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="uri">https://ggplot2.tidyverse.org/reference/theme.html</a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/element.html" class="uri">https://ggplot2.tidyverse.org/reference/element.html</a></li>
</ul></li>
</ul>
</div>
<div id="ajout-dune-variable-associée-à-une-propriété-visuelle-autre-quun-axe" class="section level3">
<h3>Ajout d’une variable associée à une propriété visuelle autre qu’un axe</h3>
<p>Le graphique précédent représente deux variables. Ajoutons une troisième variable au graphique, qui fera varier la couleur des points. Si la palette de couleur utilisée par défaut ne nous plaît pas, nous pouvons la changer.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1">scatterplot &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb92-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb92-3" title="3">    <span class="dt">x =</span> mag, </a>
<a class="sourceLine" id="cb92-4" title="4">    <span class="dt">y =</span> stations, </a>
<a class="sourceLine" id="cb92-5" title="5">    <span class="dt">colour =</span> depth  <span class="co"># permet de faire varier la couleur des points en fonction de depth</span></a>
<a class="sourceLine" id="cb92-6" title="6">  )) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-7" title="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1000 séismes près de Fidji&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-8" title="8"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">plot.title =</span> <span class="kw">element_text</span>(<span class="dt">hjust =</span> <span class="fl">0.5</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-9" title="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;magnitude du séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-10" title="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;nombre de stations rapportant le séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb92-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">colour =</span> <span class="st">&quot;profondeur&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="co"># permet de modifier le titre de la légende</span></a>
<a class="sourceLine" id="cb92-12" title="12"><span class="st">  </span><span class="kw">scale_colour_viridis_c</span>()       <span class="co"># permet d&#39;utiliser la palette de couleur viridis</span></a>
<a class="sourceLine" id="cb92-13" title="13"></a>
<a class="sourceLine" id="cb92-14" title="14">scatterplot</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-100-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Référence :</p>
<ul>
<li>Modification de la palette de couleur :
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html" class="uri">https://ggplot2.tidyverse.org/reference/scale_colour_continuous.html</a></li>
</ul></li>
</ul>
</div>
<div id="échelles-de-couleurs---fonctions-de-type-scale_colour_-et-scale_fill_" class="section level3">
<h3>Échelles de couleurs - fonctions de type <code>scale_colour_</code> et <code>scale_fill_</code></h3>
<p>Deux propriétés visuelles (<em>aesthetics</em>) permettent de spécifier des couleurs :</p>
<ul>
<li><code>colour</code> = couleur de points et de lignes,</li>
<li><code>fill</code> = couleur de remplissage.</li>
</ul>
<p>Les fonctions permettant de contrôler les palettes de couleurs utilisées pour ses propriétés visuelles ont toutes un nom débutant par <code>scale_</code> suivi du nom de la propriété visuelle concernée et de <code>_</code>. Le nom de la fonction peut se terminer par :</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html"><code>viridis_d</code> ou <code>viridis_c</code></a> : utiliser une palette de couleur offerte dans le package R <a href="https://github.com/sjmgarnier/viridisLite"><code>viridisLite</code></a>, soit discrète (<code>_d</code>) ou continue (<code>_c</code>);</li>
<li><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html"><code>brewer</code> ou <code>distiller</code></a> : utiliser une palette de couleur de <a href="http://colorbrewer2.org"><code>ColorBrewer</code></a>;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/scale_grey.html"><code>grey</code></a> : utiliser un dégradé de gris,</li>
<li><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html"><code>manual</code></a> : utiliser une palette discrète spécifiée manuellement;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/scale_gradient.html"><code>gradient</code>, <code>gradient2</code> ou <code>gradientn</code></a> : utiliser dégradé continu spécifié manuellement;</li>
<li>etc.</li>
</ul>
<p>Une de ces fonctions a été utilisée dans l’exemple précédent : la fonction <code>scale_colour_viridis_c</code>.</p>
</div>
<div id="ajout-de-variables-par-lintermédiaire-dune-grille-de-sous-graphiques-facets" class="section level3">
<h3>Ajout de variables par l’intermédiaire d’une grille de sous-graphiques (<em>facets</em>)</h3>
<div id="graphiques-côte-à-côte-selon-les-niveaux-dune-variable-catégorique" class="section level4">
<h4>Graphiques côte à côte selon les niveaux d’une variable catégorique</h4>

<p>Ajoutons maintenant une quatrième variable au graphique, celle-ci catégorique, en créant des graphiques disjoints selon le niveau de la variable.</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb93-1" title="1">scatterplot <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb93-2" title="2"><span class="st">  </span><span class="kw">facet_wrap</span>(<span class="dt">facets =</span> <span class="op">~</span><span class="st"> </span>region)   <span class="co"># permet de créer un sous-graphique par niveau de la variable region</span></a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-101-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Référence :</p>
<ul>
<li>Utilisation de <code>facet_wrap</code> :
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="uri">https://ggplot2.tidyverse.org/reference/facet_wrap.html</a></li>
</ul></li>
</ul>
</div>
<div id="grilles-de-graphiques-selon-les-niveaux-de-deux-variables-catégoriques" class="section level4">
<h4>Grilles de graphiques selon les niveaux de deux variables catégoriques</h4>

<p>Nous pourrions même facilement ajouter une cinquième variable en créant une grille à deux dimensions de sous-graphiques côte à côte.</p>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb94-1" title="1">scatterplot <span class="op">+</span></a>
<a class="sourceLine" id="cb94-2" title="2"><span class="st">  </span><span class="kw">facet_grid</span>(mag_catego <span class="op">~</span><span class="st"> </span>region)  <span class="co"># ou facet_grid(rows = vars(mag_catego), cols = vars(region))</span></a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-102-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Référence :</p>
<ul>
<li>Utilisation de <code>facet_grid</code> :
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/facet_grid.html" class="uri">https://ggplot2.tidyverse.org/reference/facet_grid.html</a></li>
</ul></li>
</ul>
</div>
<div id="modification-des-libellés-des-niveaux-dune-variable-catégorique" class="section level4">
<h4>Modification des libellés des niveaux d’une variable catégorique</h4>

<p>Les libellés des niveaux d’un facteur peuvent être modifiés ainsi.</p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="co"># Création d&#39;un vecteur faisant office de « lookup table », contenant l&#39;association entre </span></a>
<a class="sourceLine" id="cb95-2" title="2"><span class="co"># - les niveaux d&#39;un facteur (nom des éléments dans le vecteur) et</span></a>
<a class="sourceLine" id="cb95-3" title="3"><span class="co"># - leurs étiquettes à afficher dans le graphique (éléments du vecteur)</span></a>
<a class="sourceLine" id="cb95-4" title="4">mag_catego_labels &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb95-5" title="5">  <span class="st">&quot;4&quot;</span> =<span class="st"> &quot;mag 4&quot;</span>,</a>
<a class="sourceLine" id="cb95-6" title="6">  <span class="st">&quot;5&quot;</span> =<span class="st"> &quot;mag 5&quot;</span>,</a>
<a class="sourceLine" id="cb95-7" title="7">  <span class="st">&quot;6&quot;</span> =<span class="st"> &quot;mag 6&quot;</span></a>
<a class="sourceLine" id="cb95-8" title="8">)</a>
<a class="sourceLine" id="cb95-9" title="9"><span class="co"># Production du graphique</span></a>
<a class="sourceLine" id="cb95-10" title="10">scatterplot <span class="op">+</span></a>
<a class="sourceLine" id="cb95-11" title="11"><span class="st">  </span><span class="kw">facet_grid</span>(</a>
<a class="sourceLine" id="cb95-12" title="12">    mag_catego <span class="op">~</span><span class="st"> </span>region, </a>
<a class="sourceLine" id="cb95-13" title="13">    <span class="dt">labeller =</span> <span class="kw">labeller</span>(<span class="dt">mag_catego =</span> mag_catego_labels)</a>
<a class="sourceLine" id="cb95-14" title="14">  )</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-103-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Références :</p>
<ul>
<li>Modification des libellés des niveaux d’un facteur :
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/labeller.html" class="uri">https://ggplot2.tidyverse.org/reference/labeller.html</a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/labellers.html" class="uri">https://ggplot2.tidyverse.org/reference/labellers.html</a></li>
</ul></li>
</ul>
</div>
</div>
</div>
<div id="exemples-de-graphiques-de-différents-types" class="section level2">
<h2>Exemples de graphiques de différents types</h2>
<p>Voici quelques exemples faisant intervenir divers types de graphiques, pour illustrer des possibilités de <code>ggplot2</code>. Si vous souhaitez voir encore plus d’exemples de code de création de graphique avec <code>ggplot2</code>, le web en regorge. Je recommande particulièrement la ressource suivante :</p>
<ul>
<li><a href="https://evamaerey.github.io/ggplot_flipbook/ggplot_flipbook_xaringan.html#1" class="uri">https://evamaerey.github.io/ggplot_flipbook/ggplot_flipbook_xaringan.html#1</a></li>
</ul>
<p>Il s’agit d’un <em>flipbook</em> très instructif, qui permet de visualiser l’impact de chaque petit ajout au code de création du graphique.</p>
<div id="diagramme-à-barres---fonctions-geom_bar-et-geom_col" class="section level3">
<h3>Diagramme à barres - fonctions <code>geom_bar</code> et <code>geom_col</code></h3>
<p>La fonction <code>geom_bar</code> calcule les fréquences des niveaux de facteurs et produit des diagrammes à barres. Avec cette fonction, pas besoin d’utiliser <code>table</code> ou une aute fonction similaire pour calculer les fréquences.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb96-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb96-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag_catego)) <span class="op">+</span></a>
<a class="sourceLine" id="cb96-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;classe de magnitude du séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb96-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;fréquences&quot;</span>)  </a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-104-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si nous avons déjà en main les fréquences, il faut utiliser la fonction <code>geom_bar</code> avec l’argument <code>stat = "identity"</code>, ou encore la fonction <code>geom_col</code>, comme suit.</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb97-1" title="1">quakes_mag &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">xtabs</span>(<span class="op">~</span><span class="st"> </span>mag_catego, <span class="dt">data =</span> quakes))</a>
<a class="sourceLine" id="cb97-2" title="2">quakes_mag</a></code></pre></div>
<pre><code>##   mag_catego Freq
## 1          4  802
## 2          5  193
## 3          6    5</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb99-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes_mag) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb99-2" title="2"><span class="st">  </span><span class="kw">geom_col</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag_catego, <span class="dt">y =</span> Freq)) <span class="op">+</span><span class="st">  </span><span class="co"># aesthetic y ajoutée</span></a>
<a class="sourceLine" id="cb99-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;classe de magnitude du séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb99-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;fréquences&quot;</span>)  </a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-106-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Pour obtenir des barres horizontales plutôt que verticales, il faut inverser les deux axes avec <code>coord_flip</code>.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb100-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag_catego)) <span class="op">+</span></a>
<a class="sourceLine" id="cb100-3" title="3"><span class="st">  </span><span class="kw">coord_flip</span>() <span class="op">+</span><span class="st">                               </span><span class="co"># permet d&#39;inverser les axes</span></a>
<a class="sourceLine" id="cb100-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;classe de magnitude du séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb100-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;fréquences&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-107-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>La fonction <code>geom_text</code> permet d’ajouter des annotations textuelles dans le graphique.</p>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb101-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag_catego)) <span class="op">+</span><span class="st"> </span><span class="co"># aesthetics communs ici</span></a>
<a class="sourceLine" id="cb101-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb101-3" title="3"><span class="st">  </span><span class="kw">geom_text</span>(</a>
<a class="sourceLine" id="cb101-4" title="4">    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">label=</span><span class="kw">stat</span>(count)),                  <span class="co"># texte ajouté = fréquences</span></a>
<a class="sourceLine" id="cb101-5" title="5">    <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>,</a>
<a class="sourceLine" id="cb101-6" title="6">    <span class="dt">stat =</span> <span class="st">&quot;count&quot;</span>,                                    <span class="co"># calcul des fréquences demandé ici </span></a>
<a class="sourceLine" id="cb101-7" title="7">    <span class="dt">vjust =</span> <span class="fl">-0.2</span>                                       <span class="co"># ajustement vertical</span></a>
<a class="sourceLine" id="cb101-8" title="8">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-9" title="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;classe de magnitude du séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb101-10" title="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;fréquences&quot;</span>)  </a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-108-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Pour représenter des fréquences croisées, on peut ajouter une variable catégorique au graphique via l’argument <code>fill</code>.</p>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb102-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag_catego, <span class="dt">fill =</span> region)) <span class="op">+</span><span class="st">  </span><span class="co"># aesthetic fill ajoutée</span></a>
<a class="sourceLine" id="cb102-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;classe de magnitude du séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;fréquences&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb102-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;région&quot;</span>) </a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-109-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Pour avoir des bâtons groupés plutôt qu’empilés, il faut modifier la valeur de l’argument <code>position</code>.</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb103-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb103-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(</a>
<a class="sourceLine" id="cb103-3" title="3">    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag_catego, <span class="dt">fill =</span> region), </a>
<a class="sourceLine" id="cb103-4" title="4">    <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>                             <span class="co"># position des bâtons modifiée</span></a>
<a class="sourceLine" id="cb103-5" title="5">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-6" title="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;classe de magnitude du séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-7" title="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;fréquences&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb103-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;région&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-110-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Afin de présenter des fréquences relatives plutôt que brutes.</p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb104-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(</a>
<a class="sourceLine" id="cb104-3" title="3">    <span class="dt">mapping =</span> <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb104-4" title="4">      <span class="dt">x =</span> mag_catego, </a>
<a class="sourceLine" id="cb104-5" title="5">      <span class="dt">y =</span> <span class="kw">stat</span>(prop),  <span class="co"># permet le calcul de fréquences relatives (proportions)</span></a>
<a class="sourceLine" id="cb104-6" title="6">      <span class="dt">group =</span> region,  <span class="co"># pour avoir les fréq. relatives de mag conditionnelles à region</span></a>
<a class="sourceLine" id="cb104-7" title="7">      <span class="dt">fill =</span> region), </a>
<a class="sourceLine" id="cb104-8" title="8">    <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span></a>
<a class="sourceLine" id="cb104-9" title="9">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb104-10" title="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Proportions de séismes par classe de magnitude selon la région&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb104-11" title="11"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;classe de magnitude du séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb104-12" title="12"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;fréquences relatives&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb104-13" title="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;région&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-111-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Références :</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html" class="uri">https://ggplot2.tidyverse.org/reference/geom_bar.html</a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html" class="uri">https://ggplot2.tidyverse.org/reference/coord_flip.html</a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/geom_text.html" class="uri">https://ggplot2.tidyverse.org/reference/geom_text.html</a></li>
</ul>
</div>
<div id="diagramme-en-secteurs---coordonnées-polaires-avec-coord_polar" class="section level3">
<h3>Diagramme en secteurs - coordonnées polaires avec <code>coord_polar</code></h3>
<p>Les auteurs de <code>ggplot2</code> n’offrent pas de fonction conviviale pour la création de diagrammes en secteurs, probablement parce qu’ils ne recommandent pas leur utilisation. Malgré tout, tenter de tracer un diagramme en secteurs avec <code>ggplot2</code> aide à comprendre davantage les possibilités du package.</p>
<p>Pour produire un diagramme en secteurs avec <code>ggplot2</code>, il faut d’abord produire un diagramme à barres empilées, puis demander l’utilisation d’un système de coordonnées polaires par un appel à la fonction <code>coord_polar</code>.</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb105-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span></a>
<a class="sourceLine" id="cb105-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">fill =</span> mag_catego)) <span class="op">+</span></a>
<a class="sourceLine" id="cb105-3" title="3"><span class="st">  </span><span class="kw">coord_polar</span>(<span class="dt">theta =</span> <span class="st">&quot;y&quot;</span>) <span class="op">+</span><span class="st">                     </span><span class="co"># coordonnées polaires</span></a>
<a class="sourceLine" id="cb105-4" title="4"><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st">                                 </span><span class="co"># thème vide</span></a>
<a class="sourceLine" id="cb105-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;classe de</span><span class="ch">\n</span><span class="st">magnitude&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-112-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="conversion-dune-variable-en-facteur---fonction-factor" class="section level3">
<h3>Conversion d’une variable en facteur - fonction <code>factor</code></h3>
<p>Si la variable n’avait pas été stockée sous forme de facteur, la fonction <code>factor</code> aurait été utile.</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1"><span class="co"># Créons une copie de quakes, contenant une version numérique de la classe de magnitude</span></a>
<a class="sourceLine" id="cb106-2" title="2">quakes2 &lt;-<span class="st"> </span>quakes</a>
<a class="sourceLine" id="cb106-3" title="3">quakes2<span class="op">$</span>mag_floor &lt;-<span class="st"> </span><span class="kw">floor</span>(quakes2<span class="op">$</span>mag)</a>
<a class="sourceLine" id="cb106-4" title="4"><span class="kw">str</span>(quakes2)</a>
<a class="sourceLine" id="cb106-5" title="5"><span class="co"># Production d&#39;un diagramme en secteurs</span></a>
<a class="sourceLine" id="cb106-6" title="6"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes2) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-7" title="7"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="kw">factor</span>(mag_floor))) <span class="op">+</span></a>
<a class="sourceLine" id="cb106-8" title="8"><span class="st">  </span><span class="kw">coord_polar</span>(<span class="dt">theta =</span> <span class="st">&quot;y&quot;</span>) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb106-9" title="9"><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb106-10" title="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;classe de</span><span class="ch">\n</span><span class="st">magnitude&quot;</span>)</a></code></pre></div>
<p>Références :</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/coord_polar.html" class="uri">https://ggplot2.tidyverse.org/reference/coord_polar.html</a></li>
</ul>
</div>
<div id="courbes-de-densité-à-noyau-superposées---fonction-geom_density" class="section level3">
<h3>Courbes de densité à noyau superposées - fonction <code>geom_density</code></h3>
<p>Il est facile avec <code>ggplot2</code> de superposer des histogrammes ou des courbes de densités à noyau (comme ci-dessous).</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb107-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb107-2" title="2"><span class="st">  </span><span class="kw">geom_density</span>(</a>
<a class="sourceLine" id="cb107-3" title="3">    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag, <span class="dt">fill =</span> region), </a>
<a class="sourceLine" id="cb107-4" title="4">    <span class="dt">alpha =</span> <span class="fl">0.5</span>        <span class="co"># niveau d&#39;opacité (0 = transparent, 1 = complètement opaque)</span></a>
<a class="sourceLine" id="cb107-5" title="5">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-6" title="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;magnitude du séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-7" title="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;densité&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb107-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;région&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-114-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Référence :</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/geom_density.html" class="uri">https://ggplot2.tidyverse.org/reference/geom_density.html</a></li>
</ul>
</div>
<div id="diagrammes-en-violon-juxtaposés---fonction-geom_violin" class="section level3">
<h3>Diagrammes en violon juxtaposés - fonction <code>geom_violin</code></h3>
<p>Un autre outil, dérivé des courbes de densités à noyau, permettant d’explorer l’association potentielle entre une variable numérique et d’une variable catégorique est le <a href="https://en.wikipedia.org/wiki/Violin_plot">diagramme en violon (<em>violin plot</em>)</a>.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1">violinplots &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb108-2" title="2"><span class="st">  </span><span class="kw">geom_violin</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> region, <span class="dt">y =</span> mag)) <span class="op">+</span></a>
<a class="sourceLine" id="cb108-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;région&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb108-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;magnitude du séisme&quot;</span>)</a>
<a class="sourceLine" id="cb108-5" title="5"></a>
<a class="sourceLine" id="cb108-6" title="6">violinplots</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-115-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Référence :</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="uri">https://ggplot2.tidyverse.org/reference/geom_violin.html</a></li>
</ul>
</div>
<div id="diagrammes-en-boîtes-juxtaposés---fonction-geom_boxplot" class="section level3">
<h3>Diagrammes en boîtes juxtaposés - fonction <code>geom_boxplot</code></h3>
<p>Le diagramme en violon est en fait d’un mélange entre les courbes de densité à noyau et les diagrammes en boîtes (<em>boxplots</em>).</p>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb109-1" title="1">boxplots &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb109-2" title="2"><span class="st">  </span><span class="kw">geom_boxplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> region, <span class="dt">y =</span> mag)) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;région&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb109-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;magnitude du séisme&quot;</span>)</a>
<a class="sourceLine" id="cb109-5" title="5"></a>
<a class="sourceLine" id="cb109-6" title="6">boxplots</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-116-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Référence :</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html" class="uri">https://ggplot2.tidyverse.org/reference/geom_boxplot.html</a></li>
</ul>
</div>
</div>
<div id="exemples-divers-plus-poussés" class="section level2">
<h2>Exemples divers plus poussés</h2>
<div id="solutions-aux-observations-superposées-overplotting" class="section level3">
<h3>Solutions aux observations superposées (<em>overplotting</em>)</h3>
<p>Dans le diagramme de dispersion du nombre de stations rapportant le séisme en fonction de la magnitude du séisme (premier exemple), plusieurs points représentent en fait plus d’une observation. Cet <em>overplotting</em> est dû au fait que la variable <code>stations</code> ne prend que des valeurs entières (il s’agit d’un dénombrement) et la précision de mesure de la variable <code>mag</code> est limitée au dixième.</p>
<div id="solution-1-ajout-de-jitter-aux-observations" class="section level4">
<h4>Solution 1 : Ajout de <em>jitter</em> aux observations</h4>

<p>Ajouter du <em>jitter</em> à des observations signifie de leur ajouter de petites quantités aléatoires, parfois appelées du bruit blanc.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb110-2" title="2"><span class="st">  </span><span class="kw">geom_jitter</span>(                             <span class="co"># geom_jitter est utilisé au lieu de geom_point</span></a>
<a class="sourceLine" id="cb110-3" title="3">    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag, <span class="dt">y =</span> stations),</a>
<a class="sourceLine" id="cb110-4" title="4">    <span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>, </a>
<a class="sourceLine" id="cb110-5" title="5">    <span class="dt">alpha =</span> <span class="fl">0.3</span></a>
<a class="sourceLine" id="cb110-6" title="6">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-7" title="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1000 séismes près de Fidji&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;magnitude du séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb110-9" title="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;nombre de stations rapportant le séisme&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-117-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Référence :</p>
<ul>
<li>Utilisation de <code>geom_jitter</code> :
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="uri">https://ggplot2.tidyverse.org/reference/geom_jitter.html</a></li>
</ul></li>
</ul>
</div>
<div id="solution-2-estimation-à-noyau-de-densité-2d" class="section level4">
<h4>Solution 2 : Estimation à noyau de densité 2D</h4>

<p>Nous pourrions ajouter en arrière-plan une estimation à noyau de la densité bivariée entre les deux représentées.</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb111-1" title="1"><span class="kw">ggplot</span>(</a>
<a class="sourceLine" id="cb111-2" title="2">  <span class="dt">data =</span> quakes, </a>
<a class="sourceLine" id="cb111-3" title="3">  <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag, <span class="dt">y =</span> stations)                  <span class="co"># aesthetics communs placées ici</span></a>
<a class="sourceLine" id="cb111-4" title="4">) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-5" title="5"><span class="st">  </span><span class="kw">stat_density_2d</span>(                                      <span class="co"># ajout de l&#39;estimation de densité 2D</span></a>
<a class="sourceLine" id="cb111-6" title="6">    <span class="kw">aes</span>(<span class="dt">fill =</span> <span class="kw">stat</span>(density)),</a>
<a class="sourceLine" id="cb111-7" title="7">    <span class="dt">geom =</span> <span class="st">&quot;tile&quot;</span>,</a>
<a class="sourceLine" id="cb111-8" title="8">    <span class="dt">contour =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb111-9" title="9">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-10" title="10"><span class="st">  </span><span class="kw">geom_point</span>(</a>
<a class="sourceLine" id="cb111-11" title="11">    <span class="dt">shape =</span> <span class="dv">20</span>,                                         <span class="co"># pour modifier le symbole des points</span></a>
<a class="sourceLine" id="cb111-12" title="12">    <span class="dt">colour =</span> <span class="st">&quot;dodgerblue4&quot;</span></a>
<a class="sourceLine" id="cb111-13" title="13">    ) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-14" title="14"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;1000 séismes près de Fidji&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-15" title="15"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;magnitude du séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-16" title="16"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;nombre de stations rapportant le séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-17" title="17"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;densité&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb111-18" title="18"><span class="st">  </span><span class="kw">scale_fill_gradient</span>(                                  <span class="co"># pour modifier l&#39;échelle de couleur</span></a>
<a class="sourceLine" id="cb111-19" title="19">    <span class="dt">low =</span> <span class="st">&quot;white&quot;</span>, </a>
<a class="sourceLine" id="cb111-20" title="20">    <span class="dt">high =</span> <span class="st">&quot;dodgerblue3&quot;</span></a>
<a class="sourceLine" id="cb111-21" title="21">  ) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb111-22" title="22"><span class="st">  </span><span class="kw">theme_classic</span>()                                       <span class="co"># pour avoir rapidement un fond blanc</span></a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-118-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Plus la couleur de fond est foncée, plus la densité de points est forte dans la région.</p>
<p>Références :</p>
<ul>
<li>Densité 2D :
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/geom_density_2d.html" class="uri">https://ggplot2.tidyverse.org/reference/geom_density_2d.html</a></li>
<li><a href="https://www.inwt-statistics.com/read-blog/smoothscatter-with-ggplot2-513.html" class="uri">https://www.inwt-statistics.com/read-blog/smoothscatter-with-ggplot2-513.html</a></li>
</ul></li>
<li>Type de points :
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html" class="uri">https://ggplot2.tidyverse.org/reference/aes_linetype_size_shape.html</a></li>
</ul></li>
<li>Thèmes complets :
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="uri">https://ggplot2.tidyverse.org/reference/ggtheme.html</a></li>
</ul></li>
</ul>
</div>
<div id="autres-solutions" class="section level4">
<h4>Autres solutions</h4>

<p>D’autres solutions sont proposées ici : <a href="https://ggplot2.tidyverse.org/reference/geom_point.html#overplotting" class="uri">https://ggplot2.tidyverse.org/reference/geom_point.html#overplotting</a></p>
</div>
</div>
<div id="représentation-graphique-dune-fonction" class="section level3">
<h3>Représentation graphique d’une fonction</h3>
<p>La fonction <code>stat_function</code> permet de représenter une fonction mathématique, un peu comme le fait la fonction <code>curve</code> du système graphique de base.</p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="co"># Statistique dont nous aurons besoin</span></a>
<a class="sourceLine" id="cb112-2" title="2">moy &lt;-<span class="st"> </span><span class="kw">mean</span>(quakes<span class="op">$</span>mag)</a>
<a class="sourceLine" id="cb112-3" title="3">et &lt;-<span class="st"> </span><span class="kw">sd</span>(quakes<span class="op">$</span>mag)</a></code></pre></div>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb113-1" title="1">histogramme &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-2" title="2"><span class="st">  </span><span class="kw">geom_histogram</span>(</a>
<a class="sourceLine" id="cb113-3" title="3">    <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">y =</span> <span class="kw">stat</span>(density)), </a>
<a class="sourceLine" id="cb113-4" title="4">    <span class="dt">binwidth =</span> <span class="fl">0.1</span>, </a>
<a class="sourceLine" id="cb113-5" title="5">    <span class="dt">colour =</span> <span class="st">&quot;black&quot;</span>, </a>
<a class="sourceLine" id="cb113-6" title="6">    <span class="dt">fill =</span> <span class="st">&quot;white&quot;</span></a>
<a class="sourceLine" id="cb113-7" title="7">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="st">&quot;Densité empirique des magnitudes dans le jeu de données quakes&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb113-9" title="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;magnitude du séisme&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb113-10" title="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;densité&quot;</span>)</a>
<a class="sourceLine" id="cb113-11" title="11">  </a>
<a class="sourceLine" id="cb113-12" title="12">histogramme <span class="op">+</span><span class="st"> </span><span class="kw">stat_function</span>(           <span class="co"># ajout d&#39;une courbe de densité normale </span></a>
<a class="sourceLine" id="cb113-13" title="13">    <span class="dt">fun =</span> dnorm, </a>
<a class="sourceLine" id="cb113-14" title="14">    <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> moy, <span class="dt">sd =</span> et),  <span class="co"># avec paramètres estimés à partir des données</span></a>
<a class="sourceLine" id="cb113-15" title="15">    <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">3.95</span>, <span class="fl">6.45</span>)</a>
<a class="sourceLine" id="cb113-16" title="16">  )</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-120-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Référence :</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="uri">https://ggplot2.tidyverse.org/reference/geom_histogram.html</a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/stat_function.html" class="uri">https://ggplot2.tidyverse.org/reference/stat_function.html</a></li>
</ul>
</div>
<div id="mise-en-forme-dune-légende" class="section level3">
<h3>Mise en forme d’une légende</h3>
<p>Ajoutons une courbe supplémentaire au graphique précédent.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">histogramme <span class="op">+</span></a>
<a class="sourceLine" id="cb114-2" title="2"><span class="st">  </span><span class="kw">geom_density</span>(   <span class="co"># ajout d&#39;une courbe de densité normale</span></a>
<a class="sourceLine" id="cb114-3" title="3">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb114-4" title="4"><span class="st">  </span><span class="kw">stat_function</span>(  <span class="co"># ajout d&#39;une courbe d’estimation de densité à noyau</span></a>
<a class="sourceLine" id="cb114-5" title="5">    <span class="dt">fun =</span> dnorm, </a>
<a class="sourceLine" id="cb114-6" title="6">    <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> moy, <span class="dt">sd =</span> et),</a>
<a class="sourceLine" id="cb114-7" title="7">    <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">3.95</span>, <span class="fl">6.45</span>)</a>
<a class="sourceLine" id="cb114-8" title="8">  )</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-121-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Afin de pouvoir identifier chacune des courbes, il faudrait choisir une propriété visuelle pour les distinguer. Choisissions la couleur.</p>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb115-1" title="1">histogramme &lt;-<span class="st"> </span>histogramme <span class="op">+</span></a>
<a class="sourceLine" id="cb115-2" title="2"><span class="st">  </span><span class="kw">geom_density</span>(</a>
<a class="sourceLine" id="cb115-3" title="3">    <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;density&quot;</span>),  <span class="co"># association de la propriété visuelle colour à une valeur</span></a>
<a class="sourceLine" id="cb115-4" title="4">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb115-5" title="5"><span class="st">  </span><span class="kw">stat_function</span>(</a>
<a class="sourceLine" id="cb115-6" title="6">    <span class="kw">aes</span>(<span class="dt">colour =</span> <span class="st">&quot;dnorm&quot;</span>),    <span class="co"># association de la propriété visuelle colour à une valeur</span></a>
<a class="sourceLine" id="cb115-7" title="7">    <span class="dt">fun =</span> dnorm, </a>
<a class="sourceLine" id="cb115-8" title="8">    <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span> moy, <span class="dt">sd =</span> et),</a>
<a class="sourceLine" id="cb115-9" title="9">    <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="fl">3.95</span>, <span class="fl">6.45</span>)</a>
<a class="sourceLine" id="cb115-10" title="10">  )</a></code></pre></div>
<pre><code>## Warning: `mapping` is not used by stat_function()</code></pre>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1">histogramme</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-122-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Dans les appels aux fonctions ajoutant les courbes, nous avons associé la propriété visuelle <code>colour</code> à une valeur fixe (et non à une variable comme nous avons l’habitude de le faire). Cet ajout a eu pour effet de provoquer un ajout automatique d’une légende. Les valeurs associées à <code>colour</code> se sont retrouvées par défaut dans la légende.</p>
<p>Modifions les couleurs ainsi que les étiquettes des courbes et retirons le titre de la légende.</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1">histogramme <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(</a>
<a class="sourceLine" id="cb118-2" title="2">    <span class="dt">name =</span> <span class="st">&quot;&quot;</span>,                                        <span class="co"># pour retirer le titre de la légende</span></a>
<a class="sourceLine" id="cb118-3" title="3">    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>),                        <span class="co"># pour modifier les couleurs</span></a>
<a class="sourceLine" id="cb118-4" title="4">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Densité à noyau&quot;</span>, <span class="st">&quot;Densité normale&quot;</span>)  <span class="co"># pour modifier les étiquettes</span></a>
<a class="sourceLine" id="cb118-5" title="5">  )</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-123-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div id="remarque" class="section level4">
<h4>Remarque :</h4>

<p>Les annotations mathématiques sont toujours possibles avec <code>ggplot2</code>, comme dans le système graphique de base. La dernière couche du graphique prédécent pourrait par exemple être remplacée par la suivante.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">histogramme <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(</a>
<a class="sourceLine" id="cb119-2" title="2">    <span class="dt">name =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb119-3" title="3">    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>),</a>
<a class="sourceLine" id="cb119-4" title="4">    <span class="dt">labels =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb119-5" title="5">      <span class="st">&quot;Densité à noyau&quot;</span>, </a>
<a class="sourceLine" id="cb119-6" title="6">      <span class="kw">expression</span>(<span class="kw">paste</span>(<span class="st">&quot;N(&quot;</span>, mu, <span class="st">&quot; = &quot;</span>, <span class="kw">bar</span>(x), <span class="st">&quot;, &quot;</span>, sigma<span class="op">^</span><span class="dv">2</span>, <span class="st">&quot; = &quot;</span>,  s[x]<span class="op">^</span><span class="dv">2</span>, <span class="st">&quot;)&quot;</span>))</a>
<a class="sourceLine" id="cb119-7" title="7">    )</a>
<a class="sourceLine" id="cb119-8" title="8">  )</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-124-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="configuration-de-lapparence-de-la-légende" class="section level4">
<h4>Configuration de l’apparence de la légende</h4>

<p>Grâce à la fonction <code>theme</code>, nous pouvons aussi contrôler l’allure de la légende.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb120-1" title="1">histogramme <span class="op">+</span><span class="st"> </span><span class="kw">scale_colour_manual</span>(</a>
<a class="sourceLine" id="cb120-2" title="2">    <span class="dt">name =</span> <span class="st">&quot;&quot;</span>,</a>
<a class="sourceLine" id="cb120-3" title="3">    <span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;blue&quot;</span>, <span class="st">&quot;red&quot;</span>),</a>
<a class="sourceLine" id="cb120-4" title="4">    <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;Densité à noyau&quot;</span>, <span class="st">&quot;Densité normale&quot;</span>)</a>
<a class="sourceLine" id="cb120-5" title="5">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb120-6" title="6"><span class="st">  </span><span class="kw">theme</span>(</a>
<a class="sourceLine" id="cb120-7" title="7">    <span class="dt">legend.position=</span><span class="st">&quot;top&quot;</span>,             <span class="co"># modification de la position de la légende</span></a>
<a class="sourceLine" id="cb120-8" title="8">    <span class="dt">legend.background =</span> <span class="kw">element_rect</span>(  <span class="co"># ajout d&#39;une bordure rectangulaire autour de la légende</span></a>
<a class="sourceLine" id="cb120-9" title="9">      <span class="dt">size=</span><span class="fl">0.5</span>, <span class="dt">linetype=</span><span class="st">&quot;solid&quot;</span>, <span class="dt">colour =</span><span class="st">&quot;black&quot;</span></a>
<a class="sourceLine" id="cb120-10" title="10">    )</a>
<a class="sourceLine" id="cb120-11" title="11">  )</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-125-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Références :</p>
<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="uri">https://ggplot2.tidyverse.org/reference/scale_manual.html</a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="uri">https://ggplot2.tidyverse.org/reference/theme.html</a></li>
<li><a href="https://ggplot2.tidyverse.org/reference/element.html" class="uri">https://ggplot2.tidyverse.org/reference/element.html</a></li>
<li><a href="http://www.sthda.com/french/wiki/ggplot2-legende-modifier-facilement-la-legende-d-un-graphique-logiciel-r-et-visualisation-de-donnees" class="uri">http://www.sthda.com/french/wiki/ggplot2-legende-modifier-facilement-la-legende-d-un-graphique-logiciel-r-et-visualisation-de-donnees</a></li>
</ul>
</div>
</div>
</div>
<div id="packages-souvent-utilisés-avec-ggplot2-et-extensions-de-ggplot2" class="section level2">
<h2>Packages souvent utilisés avec <code>ggplot2</code> et extensions de <code>ggplot2</code></h2>
<div id="le-tidyverse" class="section level3">
<h3>Le <code>tidyverse</code></h3>
<p>Le package <code>ggplot2</code> est souvent utilisé conjointement à d’autres packages du <code>tidyverse</code>, notamment :</p>
<ul>
<li><a href="https://dplyr.tidyverse.org/"><code>dplyr</code></a> pour la manipulation / le prétraitement de données;</li>
<li><a href="https://magrittr.tidyverse.org/"><code>magrittr</code></a> qui offre l’opérateur « pipe » <code>%&gt;%</code>;</li>
<li><a href="https://forcats.tidyverse.org/"><code>forcats</code></a> pour la manipulation de facteurs.</li>
</ul>
<div id="exemple-production-dun-graphique-à-partir-dun-sous-ensemble-de-données" class="section level4">
<h4>Exemple : production d’un graphique à partir d’un sous-ensemble de données</h4>

<p>Supposons que nous voulions produire le diagramme de dispersion entre les variables <code>mag</code> et <code>stations</code> de <code>quakes</code> uniquement avec les observations dans la région Ouest. Nous pourrions nous servir de la fonction <code>filter</code> de <code>dplyr</code> de l’opérateur <code>%&gt;%</code> comme suit.</p>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<pre><code>## Warning: package &#39;dplyr&#39; was built under R version 3.6.3</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1">quakes <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb123-2" title="2"><span class="st">  </span><span class="kw">filter</span>(region <span class="op">==</span><span class="st"> &quot;Ouest&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb123-3" title="3"><span class="st">  </span><span class="kw">ggplot</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag, <span class="dt">y =</span> stations)) <span class="op">+</span></a>
<a class="sourceLine" id="cb123-4" title="4"><span class="st">  </span><span class="kw">geom_jitter</span>(<span class="dt">colour =</span> <span class="st">&quot;blue&quot;</span>, <span class="dt">alpha =</span> <span class="fl">0.3</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb123-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;magnitude du séisme&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb123-6" title="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">y =</span> <span class="st">&quot;nombre de stations rapportant le séisme&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-126-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="exemple-modification-de-lordre-des-niveaux-dun-facteur" class="section level4">
<h4>Exemple : modification de l’ordre des niveaux d’un facteur</h4>

<p>Supposons maintenant que nous voulons inverser l’ordre des niveaux du facteur <code>mag_catego</code> dans le dernier diagramme en secteurs produit. La fonction <code>fct_rev</code> du package <code>forcats</code> nous serait utile.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1"><span class="kw">library</span>(forcats)</a></code></pre></div>
<pre><code>## Warning: package &#39;forcats&#39; was built under R version 3.6.3</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes) <span class="op">+</span></a>
<a class="sourceLine" id="cb126-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> <span class="dv">1</span>, <span class="dt">fill =</span> <span class="kw">fct_rev</span>(mag_catego))) <span class="op">+</span></a>
<a class="sourceLine" id="cb126-3" title="3"><span class="st">  </span><span class="kw">coord_polar</span>(<span class="dt">theta =</span> <span class="st">&quot;y&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb126-4" title="4"><span class="st">  </span><span class="kw">theme_void</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb126-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">fill =</span> <span class="st">&quot;classe de</span><span class="ch">\n</span><span class="st">magnitude&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-127-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="extensions" class="section level3">
<h3>Extensions</h3>
<p>Un nombre important d’extensions de <code>ggplot2</code> sont offertes. Plusieurs sont énumérées sur le site web suivant : <a href="http://www.ggplot2-exts.org/gallery/" class="uri">http://www.ggplot2-exts.org/gallery/</a></p>
<p>Voici une liste de quelques extensions intéressantes suivie de quelques exemples.</p>
<ul>
<li><a href="https://jrnold.github.io/ggthemes/"><code>ggthemes</code></a> : thèmes complets supplémentaires;</li>
<li><a href="https://ggrepel.slowkow.com/"><code>ggrepel</code></a> : fonction <code>geom_text_repel</code> pour éviter les textes superposés;</li>
<li><a href="https://wilkelab.org/cowplot/"><code>cowplot</code></a> : thème adapté aux publications scientifiques et possibilité de combiner plusieurs graphiques en un;</li>
<li><a href="https://github.com/daattali/ggExtra"><code>ggExtra</code></a> : ajout facile d’histogrammes marginaux;</li>
<li><a href="http://ggobi.github.io/ggally/"><code>GGally</code></a> : matrice de diagrammes de dispersion (équivalent de <code>pairs</code>) et plus;</li>
<li><a href="https://davidgohel.github.io/ggiraph/"><code>ggiraph</code></a> : graphiques interactifs (format HTML);</li>
<li><a href="https://gganimate.com/"><code>gganimate</code></a> : gif animés (ou autres formats d’animation);</li>
<li>ajout de cartes en arrière-plan :
<ul>
<li><a href="https://CRAN.R-project.org/package=maps"><code>maps</code></a> et <a href="https://CRAN.R-project.org/package=mapdata"><code>mapdata</code></a> (s’utilisent aussi avec le système graphique de base),</li>
<li><a href="%60https://cran.r-project.org/web/packages/ggmap/index.html%60"><code>ggmap</code></a> : intégration de données Google Maps (mais requière un compte Google avec facturation activée);</li>
</ul></li>
<li>etc.</li>
</ul>
<div id="package-ggthemes" class="section level4">
<h4>Package <code>ggthemes</code></h4>

<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">library</span>(ggthemes)</a></code></pre></div>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1">scatterplot <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb128-2" title="2"><span class="st">  </span><span class="kw">theme_economist</span>()</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-129-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1">scatterplot <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb129-2" title="2"><span class="st">  </span><span class="kw">theme_excel</span>()</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-130-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Référence :</p>
<ul>
<li><a href="https://jrnold.github.io/ggthemes/" class="uri">https://jrnold.github.io/ggthemes/</a></li>
</ul>
</div>
<div id="package-cowplot" class="section level4">
<h4>Package <code>cowplot</code></h4>

<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="kw">library</span>(cowplot)</a></code></pre></div>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1">title &lt;-<span class="st"> </span><span class="kw">ggdraw</span>() <span class="op">+</span><span class="st"> </span><span class="kw">draw_label</span>(<span class="st">&quot;Lesquels préférez-vous ?&quot;</span>, <span class="dt">fontface=</span><span class="st">&#39;bold&#39;</span>)</a>
<a class="sourceLine" id="cb131-2" title="2"><span class="kw">plot_grid</span>(</a>
<a class="sourceLine" id="cb131-3" title="3">  title, </a>
<a class="sourceLine" id="cb131-4" title="4">  <span class="kw">plot_grid</span>(</a>
<a class="sourceLine" id="cb131-5" title="5">    violinplots <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Violin plots&quot;</span>), </a>
<a class="sourceLine" id="cb131-6" title="6">    boxplots <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Boxplots&quot;</span>)</a>
<a class="sourceLine" id="cb131-7" title="7">  ),</a>
<a class="sourceLine" id="cb131-8" title="8">  <span class="dt">ncol=</span><span class="dv">1</span>, <span class="dt">rel_heights=</span><span class="kw">c</span>(<span class="fl">0.1</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb131-9" title="9">)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-132-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb132-1" title="1"><span class="kw">detach</span>(<span class="st">&quot;package:cowplot&quot;</span>, <span class="dt">unload=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>Référence :</p>
<ul>
<li><a href="https://wilkelab.org/cowplot/" class="uri">https://wilkelab.org/cowplot/</a></li>
<li>tutoriel rédigé par d’anciens étudiants du cours : <a href="https://stt4230.rbind.io/tutoriels_etudiants/hiver_2019/cowplot/" class="uri">https://stt4230.rbind.io/tutoriels_etudiants/hiver_2019/cowplot/</a></li>
</ul>
<!--

#### Package `ggExtra`

\mbox{}


```r
library(ggExtra)
```


```r
ggMarginal(scatterplot, type = "histogram")
```

<img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-135-1.png" width="100%" style="display: block; margin: auto;" />

Référence :

- https://github.com/daattali/ggExtra

-->
</div>
<div id="package-ggally" class="section level4">
<h4>Package <code>GGally</code></h4>

<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="kw">library</span>(GGally)</a></code></pre></div>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb134-1" title="1"><span class="kw">ggpairs</span>(datasets<span class="op">::</span>quakes)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-137-1.png" width="100%" height="100%" style="display: block; margin: auto;" /></p>
<p>Référence :</p>
<ul>
<li><a href="http://ggobi.github.io/ggally/" class="uri">http://ggobi.github.io/ggally/</a></li>
</ul>
</div>
</div>
</div>
<div id="comparaison-entre-ggplot2-et-le-système-graphique-r-de-base" class="section level2">
<h2>Comparaison entre <code>ggplot2</code> et le système graphique R de base</h2>
<p>Entre <code>ggplot2</code> et le système graphique R de base, lequel devrions-nous utiliser ? Le graphique suivant<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> résume bien ma réponse à cette question.</p>
<p><img src="fig/gg-vs-base.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Lorsque le nombre de variables à représenter dans un graphique est grand (<em>Number of dimensions</em> élevé), utiliser <code>ggplot2</code> peut potentiellement permettre de sauver beaucoup de temps. Les représentations multivariables sont plus faciles à produire avec <code>ggplot2</code> qu’avec le système graphique R de base. En grande partie pour cette raison, la production de graphiques pour de l’analyse exploratoire de données est souvent plus rapide à réaliser avec <code>ggplot2</code> qu’avec le système graphique de base. Malgré tout, il existe encore une situation dans laquelle le système de base surpasse <code>ggplot2</code> : la production de graphiques à mises en formes spécifiques pour des publications scientifiques. Les configurations graphiques sont souvent plus simples à réaliser avec le système de base qu’avec <code>ggplot2</code>.</p>
<hr />
</div>
</div>
<div id="autres-possibilités-graphiques-en-r-seulement-mentionnées" class="section level1">
<h1>Autres possibilités graphiques en R (seulement mentionnées)</h1>
<ul>
<li>Graphiques 3D orientables :
<ul>
<li>fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/persp.html"><code>persp</code></a> du système de base,</li>
<li>package <a href="https://cran.r-project.org/web/packages/rgl/vignettes/rgl.html"><code>rgl</code></a> : fonction <code>plot3d</code> et autres.</li>
</ul></li>
<li>Cartes géographiques :
<ul>
<li>packages <a href="https://CRAN.R-project.org/package=maps"><code>maps</code></a> et <a href="https://CRAN.R-project.org/package=mapdata"><code>mapdata</code></a>,</li>
<li>plusieurs packages sont offerts.</li>
</ul></li>
<li>Graphiques interactifs :
<ul>
<li>package <a href="https://plot.ly/r/"><code>plotly</code></a> pour créer des graphiques <a href="https://plot.ly/">Plotly</a>,</li>
<li>plusieurs packages sont offerts.</li>
</ul></li>
<li><a href="https://shiny.rstudio.com/">Shiny App</a>
<ul>
<li>quelques exemples de shiny apps : <a href="https://github.com/kbodwin/Shiny-Apps-for-Education" class="uri">https://github.com/kbodwin/Shiny-Apps-for-Education</a></li>
</ul></li>
<li>et bien d’autres : <a href="https://CRAN.R-project.org/view=Graphics" class="uri">https://CRAN.R-project.org/view=Graphics</a></li>
</ul>
<div id="graphiques-3d" class="section level2">
<h2>Graphiques 3D</h2>
<p>L’utilisation de 3D pour la représentation de données catégoriques est à éviter, car elle nuit à la lisibilité du graphique<a href="#fn15" class="footnote-ref" id="fnref15"><sup>15</sup></a>. Les graphiques 3D peuvent cependant être utiles pour visualiser une surface.</p>
<div id="fonction-persp-du-système-de-base" class="section level3">
<h3>Fonction <code>persp</code> du système de base</h3>
<p>Graphique 3D produit avec la fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/persp.html"><code>persp</code></a> du système graphique de base :</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1">x &lt;-<span class="st"> </span>y &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="dv">-1</span>, <span class="dt">to =</span> <span class="dv">1</span>, <span class="dt">length =</span> <span class="dv">100</span>)</a>
<a class="sourceLine" id="cb135-2" title="2">grille &lt;-<span class="st"> </span><span class="kw">expand.grid</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y)</a>
<a class="sourceLine" id="cb135-3" title="3">z &lt;-<span class="st"> </span>grille<span class="op">$</span>x<span class="op">^</span><span class="dv">2</span> <span class="op">+</span><span class="st"> </span>grille<span class="op">$</span>y<span class="op">^</span><span class="dv">2</span></a>
<a class="sourceLine" id="cb135-4" title="4"><span class="kw">persp</span>(<span class="dt">x =</span> x, <span class="dt">y =</span> y, <span class="dt">z =</span>  <span class="kw">matrix</span>(z, <span class="dt">ncol =</span> <span class="kw">length</span>(x)), <span class="dt">zlab =</span> <span class="st">&quot;z&quot;</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-139-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Cette fonction ne permet pas de représenter un nuage de points en 3 dimensions. Elle permet plutôt de tracer une fonction mathématique de 2 variables. Il faut fournir à l’argument <code>z</code> la valeur de la fonction mathématique pour toutes les combinaisons des valeurs en <code>x</code> et et <code>y</code>. Les angles de vue du graphique peuvent être contrôlés à l’aide des arguments <code>theta</code> et <code>phi</code>.</p>
</div>
<div id="graphiques-3d-orientables---package-rgl" class="section level3">
<h3>Graphiques 3D orientables - package <code>rgl</code></h3>
<p>Le package <a href="https://cran.r-project.org/web/packages/rgl/index.html"><code>rgl</code></a> permet de produire des graphiques 3D. Ces graphiques sont affichés dans une fenêtre interactive dans laquelle il est possible de tourner le graphique. Voici un exemple de commande pour créer un graphique 3D avec la fonction <a href="https://www.rdocumentation.org/packages/rgl/versions/0.99.9/topics/plot3d"><code>plot3d</code></a> du package <code>rgl</code>.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb136-1" title="1"><span class="kw">library</span>(rgl)</a>
<a class="sourceLine" id="cb136-2" title="2"><span class="kw">plot3d</span>(<span class="dt">x =</span> quakes<span class="op">$</span>long, <span class="dt">y =</span> quakes<span class="op">$</span>lat, <span class="dt">z =</span> quakes<span class="op">$</span>depth,</a>
<a class="sourceLine" id="cb136-3" title="3">       <span class="dt">col =</span> <span class="kw">ifelse</span>(quakes<span class="op">$</span>region <span class="op">==</span><span class="st"> &quot;Ouest&quot;</span>, <span class="kw">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.3</span>)),</a>
<a class="sourceLine" id="cb136-4" title="4">       <span class="dt">aspect =</span> <span class="ot">TRUE</span>, <span class="dt">type =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">size =</span> <span class="dv">1</span>)</a></code></pre></div>
<p>Le graphique produit ne peut pas être intégré au fichier PDF des notes de cours, car il est interactif alors que les documents PDF sont statiques. Il pourrait cependant être affiché dans le document HTML, mais un problème technique l’empêche d’apparaître ici. Pour le visualiser, il vous suffit de soumettre le code dans une console R.</p>
<p>D’autres graphiques produit avec le package <code>rgl</code> peuvent aussi être visualisés dans le tutoriel suivant, produit par d’anciens étudiants du cours, qui initie à l’utilisation de ce package : <a href="https://stt4230.rbind.io/tutoriels_etudiants/hiver_2019/rgl/" class="uri">https://stt4230.rbind.io/tutoriels_etudiants/hiver_2019/rgl/</a></p>
</div>
</div>
<div id="cartes-géographiques" class="section level2">
<h2>Cartes géographiques</h2>
<div id="packages-maps-et-mapdata" class="section level3">
<h3>Packages <code>maps</code> et <code>mapdata</code></h3>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="kw">library</span>(maps)</a></code></pre></div>
<p>Carte tirée de banques de données accessibles par l’intermédiaire du package <code>maps</code>.</p>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb138-1" title="1"><span class="kw">map</span>(<span class="dt">database =</span> <span class="st">&quot;world&quot;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">115</span>, <span class="dv">190</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">0</span>),</a>
<a class="sourceLine" id="cb138-2" title="2">    <span class="dt">col =</span> <span class="st">&quot;gray90&quot;</span>, <span class="dt">fill =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb138-3" title="3"><span class="kw">points</span>(<span class="dt">x =</span> quakes<span class="op">$</span>long, <span class="dt">y =</span> quakes<span class="op">$</span>lat, <span class="dt">pch =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb138-4" title="4">       <span class="dt">col =</span> <span class="kw">ifelse</span>(quakes<span class="op">$</span>region <span class="op">==</span><span class="st"> &quot;Ouest&quot;</span>, <span class="kw">rgb</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.3</span>), <span class="kw">rgb</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.3</span>)))</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-143-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Au besoin, encore plus de cartes sont accessibles par l’intermédiaire du package <code>mapdata</code>.</p>
<p>Voici un exemple d’utilisation d’une carte avec <code>ggplot2</code> :</p>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1">monde &lt;-<span class="st"> </span><span class="kw">map_data</span>(<span class="st">&quot;world&quot;</span>)  <span class="co"># va chercher des données provenant du package maps ou mapdata</span></a>
<a class="sourceLine" id="cb139-2" title="2"><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb139-3" title="3"><span class="st">  </span><span class="kw">geom_polygon</span>(</a>
<a class="sourceLine" id="cb139-4" title="4">    <span class="dt">data =</span> monde,</a>
<a class="sourceLine" id="cb139-5" title="5">    <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">group =</span> group), </a>
<a class="sourceLine" id="cb139-6" title="6">    <span class="dt">fill =</span> <span class="st">&quot;gray90&quot;</span>, </a>
<a class="sourceLine" id="cb139-7" title="7">    <span class="dt">col =</span> <span class="st">&quot;black&quot;</span></a>
<a class="sourceLine" id="cb139-8" title="8">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb139-9" title="9"><span class="st">  </span><span class="kw">geom_point</span>(</a>
<a class="sourceLine" id="cb139-10" title="10">    <span class="dt">data =</span> quakes, </a>
<a class="sourceLine" id="cb139-11" title="11">    <span class="kw">aes</span>(<span class="dt">x =</span> long, <span class="dt">y =</span> lat, <span class="dt">colour =</span> region), </a>
<a class="sourceLine" id="cb139-12" title="12">    <span class="dt">alpha =</span> <span class="fl">.3</span></a>
<a class="sourceLine" id="cb139-13" title="13">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb139-14" title="14"><span class="st">  </span><span class="kw">coord_fixed</span>(</a>
<a class="sourceLine" id="cb139-15" title="15">    <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">115</span>, <span class="dv">190</span>),  </a>
<a class="sourceLine" id="cb139-16" title="16">    <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="op">-</span><span class="dv">50</span>, <span class="dv">0</span>), </a>
<a class="sourceLine" id="cb139-17" title="17">    <span class="dt">ratio =</span> <span class="fl">1.3</span></a>
<a class="sourceLine" id="cb139-18" title="18">  ) <span class="op">+</span></a>
<a class="sourceLine" id="cb139-19" title="19"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x =</span> <span class="st">&quot;longitude&quot;</span>, <span class="dt">y =</span> <span class="st">&quot;latitude&quot;</span>, <span class="dt">colour =</span> <span class="st">&quot;région&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb139-20" title="20"><span class="st">  </span><span class="kw">theme_bw</span>()</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-144-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Références :</p>
<ul>
<li><a href="http://www.michaeljgrogan.com/creating-maps-ggplot2-libraries/" class="uri">http://www.michaeljgrogan.com/creating-maps-ggplot2-libraries/</a></li>
<li><a href="http://eriqande.github.io/rep-res-web/lectures/making-maps-with-R.html" class="uri">http://eriqande.github.io/rep-res-web/lectures/making-maps-with-R.html</a></li>
</ul>
</div>
<div id="autres-packages-pour-lintégration-de-cartes-géographiques-dans-un-graphique-r" class="section level3">
<h3>Autres packages pour l’intégration de cartes géographiques dans un graphique R</h3>
<p>Il existe plusieurs autres packages pour la création de cartes en R :</p>
<ul>
<li>CRAN task view : <a href="https://CRAN.R-project.org/view=Spatial" class="uri">https://CRAN.R-project.org/view=Spatial</a></li>
<li>ressources web sur le sujet :
<ul>
<li><a href="https://statnmap.com/fr/" class="uri">https://statnmap.com/fr/</a></li>
<li><a href="https://geocompr.robinlovelace.net/adv-map.html" class="uri">https://geocompr.robinlovelace.net/adv-map.html</a></li>
</ul></li>
<li>package <a href="https://r-spatial.github.io/sf/"><code>sf</code></a> : manipulation de données spatiales</li>
<li>package <a href="https://github.com/dkahle/ggmap"><code>ggmap</code></a> : permet d’intégrer une carte <a href="https://developers.google.com/maps/documentation/maps-static/intro?hl=en">Google Maps</a> (requière un compte sur <a href="https://cloud.google.com/maps-platform/" class="uri">https://cloud.google.com/maps-platform/</a> pour avoir accès aux cartes) ou <a href="http://maps.stamen.com/#toner/12/37.7706/-122.3782">Stamen Maps</a> à un graphique produit avec <code>ggplot2</code></li>
<li>package <a href="https://github.com/mtennekes/tmap"><code>tmap</code></a> : permet notammenet de facilement créer des <a href="https://en.wikipedia.org/wiki/Choropleth_map">cartes choroplèthes</a></li>
<li>package <a href="https://rstudio.github.io/leaflet/"><code>leaflet</code></a> : permet de créer des cartes interactives avec la librairie JavaScript du même nom <a href="https://leafletjs.com/" class="uri">https://leafletjs.com/</a></li>
<li>package <a href="https://github.com/riatelab/cartography/"><code>cartography</code></a> : permet de créer différentes représentations cartographiques en R</li>
<li>etc.</li>
</ul>
<!--

### Packages `ggmap`

Carte tirée de Google Maps.





Il est possible d'ajouter des éléments à ces cartes. 

-->
</div>
</div>
<div id="graphiques-interactifs" class="section level2">
<h2>Graphiques interactifs</h2>
<p>Un graphique interactif est un graphique qui n’est pas statique (une image fixe), mais qui est plutôt capable d’interagir avec la personne qui l’observe. La forme la plus simple d’interaction est de fournir de l’information supplémentaire lorsque la souris est placée sur certains éléments du graphique. Une forme plus avancée d’interaction est de modifier certains éléments du graphique en fonction de choix fait par l’observateur, par exemple via des boutons ou un menu cliquable.</p>
<p>Ce genre de graphique se visualise typiquement dans un navigateur internet. Il s’intègre facilement à un document HTML (comme une page web), mais pas à un document PDF puisque ce type de document est statique.</p>
<div id="graphiques-interactifs-plotly---package-plotly" class="section level3">
<h3>Graphiques interactifs Plotly - package <code>plotly</code></h3>
<p>L’application web Plotly (<a href="https://plot.ly/" class="uri">https://plot.ly/</a>) est devenue très populaire pour produire des graphiques interactifs. Le package R <a href="https://plot.ly/r/"><code>plotly</code></a> permet de créer facilement des graphiques Plotly en R. Voici un exemple affiché seulement dans la version HTML des notes.</p>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb140-1" title="1"><span class="kw">library</span>(plotly)</a></code></pre></div>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1"><span class="kw">plot_ly</span>(quakes, <span class="dt">x =</span> <span class="op">~</span>mag, <span class="dt">y =</span> <span class="op">~</span>stations, <span class="dt">color =</span> <span class="op">~</span>depth,</a>
<a class="sourceLine" id="cb141-2" title="2">        <span class="dt">size =</span> <span class="op">~</span>depth, <span class="dt">text =</span> <span class="op">~</span><span class="kw">paste</span>(<span class="st">&quot;Region: &quot;</span>, region))</a></code></pre></div>
<div id="htmlwidget-1" style="width:100%;height:480px;" class="plotly html-widget"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"visdat":{"48487701f92":["function () ","plotlyVisDat"]},"cur_data":"48487701f92","attrs":{"48487701f92":{"x":{},"y":{},"text":{},"color":{},"size":{},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20]}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"mag"},"yaxis":{"domain":[0,1],"automargin":true,"title":"stations"},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"showSendToCloud":false},"data":[{"x":[4.8,4.2,5.4,4.1,4,4,4.8,4.4,4.7,4.3,4.4,4.6,4.4,4.4,6.1,4.3,6,4.5,4.4,4.4,4.5,4.2,4.4,4.7,5.4,4,4.6,5.2,4.5,4.4,4.6,4.7,4.8,4,4.5,4.3,4.5,4.6,4.1,4.4,4.7,4.6,4.4,4.3,4.6,4.9,4.5,4.4,4.3,5.1,4.2,4,4.6,4.3,4.2,4.4,4.5,4,4.4,4.3,4.7,4.1,5,4.6,4.9,4.7,4.1,5,4.5,5.5,4,4.5,4.3,5.2,4.4,4.3,4.1,4.5,4.2,5.3,5.2,4.5,4.6,4.3,4,4.3,4.7,4.5,4.2,4.3,5.1,4.7,5.2,4.2,4.2,4,4.5,5.2,5.1,4.7,4.1,4.6,4.7,4.7,4.6,4.2,4.4,4.6,5.7,5,4.5,4.2,4,4.8,4.4,4.2,5.3,4.7,4.8,4.2,4.8,4.3,4.7,4.5,4.4,5.1,4.2,5,4.8,4.3,4.5,4.2,4.5,4.6,4.3,4.7,5.1,4.6,4.9,4.2,4.6,4,5,4.4,4.2,4.2,4.4,4.9,5.3,4,5.7,6.4,4.3,4.2,4.7,4.7,4.2,4.3,4.9,4.6,4.1,4.8,4.6,4.6,4.8,5,5.6,5.3,4.7,4.5,4.3,4.6,4.1,4.1,4.1,5.7,5,4.5,4.1,4.6,4.5,4.3,4.4,4.2,4.1,4.9,4.3,4.9,4.6,4.6,5.3,4.7,4.6,4.1,4.6,4.2,4.6,4.5,4.3,5.2,4.3,4,4.7,4.5,4.5,4.3,5.2,4.5,4.7,4.2,4.7,4.3,4.1,5.4,4.3,4.3,4.2,4.6,4.4,4.2,4.7,4.6,4.9,4.2,4.5,4.9,4.2,4.5,5,5,4.7,4.3,4.4,4.9,4.5,4,4.4,5,4.7,4.8,4.5,4.1,5.3,4.8,5,4.6,4.3,4.7,5.3,4.2,4.7,4.5,5.1,4.9,4.4,4.2,4.6,4.7,4.2,4.9,5.1,4.7,4.4,4.4,4.2,4.9,4.6,4.4,4.6,4.5,4.4,4.9,4.1,4.2,5.7,4.6,5,4.3,4.5,5.2,4.4,4.2,4.6,4,4.4,4.7,4.2,4.7,4.5,5,5,4.8,4.6,4.6,5,5,5.6,4,4,4.6,4.4,4.8,4.7,4.6,4.3,4.7,4.1,4.9,4.6,4.8,4.9,5.1,5.4,4.5,4.9,4.4,4.1,5.3,4.5,4.9,4.8,5.2,4.4,4.4,4.9,4.4,4.2,4.6,4.6,5.3,5.3,4.5,4.4,5,5.1,4.5,4.5,5.4,4.5,4.7,4.2,4.8,4.5,4.3,4.3,4.3,4.6,4.5,5,4.6,4.6,4.9,4.1,5.5,4.7,5,5.1,5.5,4.6,4.7,4.2,4,5.4,4.3,4.4,4.6,5.1,4.5,4.2,4.1,5.1,5.4,5.1,5.1,4.4,5.7,4.4,5.1,4.6,5.5,5.1,4.4,5,5,5.1,5.1,4.2,4.5,4,4.9,4.3,4.8,4.4,4.2,4.9,4.2,5.3,5,5.7,5.3,4.7,4.6,4.3,5.4,4.4,4.3,4.3,4.7,4.4,4.2,4.5,4.8,4.8,4.3,4.4,5.1,4.4,4.4,4.3,4.8,4.3,4.5,4.1,5.1,4.7,4.6,4.7,4.6,4.4,4.2,4.1,4.7,4,4.8,4.4,4.3,4.4,4.5,4.5,4.7,4.3,4.7,4.8,4.6,5.1,4.7,4.3,5.1,5.5,4.5,4.3,4.3,4.7,4.3,4.3,4.6,4.5,4.5,5.4,4.6,4.4,5,5.2,4.4,5.1,4.4,4.4,4.8,4.4,4.7,4.7,4.4,4.3,5,4.5,4.6,5.4,4.6,4.5,4.4,4.5,4.1,4,4.9,4.1,5.2,4.4,4.1,4.9,4.6,4.5,4.8,4.2,4.2,4.1,5.5,4.4,4.8,4.2,4.8,4.9,4.6,4.5,4.4,4.6,4.2,4.7,4.4,4.5,4.9,4.7,5.5,4.7,4.6,4.1,4.7,4.6,4.3,4.4,4.7,4.3,4.1,4.7,4.5,5.5,4.5,4.6,5.1,4.4,4.7,5.5,4.6,4,4.6,4.8,4.7,4.7,4.2,5.4,4.6,5.5,4.2,4.5,4.5,4.8,4.6,5.4,4.6,5,4.3,4.3,4.8,4.7,4.7,4.8,4.2,4.2,5.9,4.6,4.5,4.9,4.7,4.9,5.3,4.2,4.2,4.5,5.2,4.5,5.6,5.2,4.8,4.5,5,4.4,4.5,4.6,4.5,5.2,5.1,4.8,4.3,5.1,4.7,4.6,4.8,4.6,4.4,4.6,5.1,4.3,4.4,4.7,4.8,4.1,4.6,4.9,4,4.7,4.7,5.2,4.6,4.6,4.9,5.7,4.7,4.4,4.9,4.8,4.6,4.4,4.8,4.7,4.2,5.1,4.8,4.9,5.1,4.3,4.4,4.7,4.7,5.3,5.1,4.9,4.5,4.7,4.2,5.1,4.8,4.2,4.8,4.4,4.5,4.3,5.6,4,5,4.2,4.6,4.6,4.5,5,4.7,4.6,4.8,4.6,4.4,5.6,4.2,5.4,4.8,5.6,4.4,4.7,4.6,5.1,4.6,4.5,4.2,4.8,4.9,5.5,5,4.2,5.2,4.8,4.4,4.8,4.4,4.1,4.9,4.6,4.5,5.3,4.8,4.6,4.8,4.7,4.9,5.3,4.4,4.6,4.3,4.4,4.2,4.1,4.2,5,4.1,4.3,5.2,4.2,4.5,4.4,4.4,5,4,4.8,5,4.2,5.2,5.2,4.5,4.3,4.5,4.6,5.1,4.4,4.3,4.7,5.6,4.9,5.1,4.6,4.4,4.8,4.2,4.7,4.1,4.7,4,4.9,5,4.5,4.4,4,4.5,4.7,4.4,4.7,4.7,4,4.2,4.5,4.7,4.5,4.1,4.6,4.3,4.6,5.2,4.6,4.7,5,5.2,4.4,4.6,4.5,4,4.2,5.3,5.9,4.9,4.5,4.4,5.4,5.3,5.1,4.1,4.3,4.5,4.1,5.1,5.3,4.5,4.1,4.4,4.7,4,5.1,4,4.3,4.3,4,4.1,4.4,4.3,4.2,4,4.5,4.7,5,4.3,5.1,4.7,5.3,5,4.5,5,4.1,4.9,4.1,4,4.4,4.5,4.4,4.5,4.3,4.3,5,4.5,4.5,4.4,4.5,4.1,4.9,4.7,4.3,4.6,4.6,5.2,4.5,4.3,4.6,4,4.5,4.8,4.6,4.1,4.9,4.7,4.1,4.3,4.4,4,4.8,4.4,4.4,4.6,4.2,4.1,4.2,4,4.1,4.1,4.7,4.8,5.1,5,4.8,4.4,5,5.2,4.2,4.1,4.8,4.5,5,5.1,4.1,4.7,5.2,4.8,4.5,4,4.7,4.1,4.3,4.3,4,4.7,4.1,4.2,4.8,4.8,4.2,4.2,5.7,6,4.2,4.5,4.9,4.4,4,4.3,4.2,4.5,4.8,4.4,4.2,4.2,5,4.2,5.2,4.5,4.6,5,5,5.4,4.8,4.2,5.5,4.3,4.1,4.4,4.9,4.5,4.9,4,4.5,5,4.9,4.5,4.2,4.2,4.2,5.2,4.3,5.1,4.6,4.6,4.4,4.4,4.9,5.1,4.2,4.7,4,5.6,5.3,5,4.3,4.1,5.1,4.5,4.9,5.4,4.7,4.8,4.5,4.2,4.6,4.6,5.6,5.4,4,5.2,4.2,4.7,4.3,4.8,4.6,5.4,4.8,4.6,4.2,5.5,4.7,4.7,4.5,5.5,4.5,4.1,4,4.3,4.7,4.9,4.5,4.7,4.5,4.8,4.3,4.1,5.4,4.1,4.8,4.2,4.8,5.4,4.4,5.2,4.7,4.9,4.9,4.2,4.4,4.4,4.3,4.9,5,4.7,4.9,4.3,4.5,4.2,5.2,4.8,4,4.7,4.3,4.3,4.9,4,4.2,4.4,4.7,4.5,4.5,6],"y":[41,15,43,19,11,12,43,15,35,19,13,16,19,10,94,11,83,21,13,18,17,12,18,22,57,15,18,79,25,17,21,30,42,10,10,13,17,17,17,11,34,32,23,26,27,34,24,18,21,73,13,15,26,13,16,31,17,11,23,12,35,12,61,32,40,25,13,45,27,91,11,30,14,75,35,15,11,23,15,60,65,27,38,15,11,15,32,26,16,42,61,22,64,14,21,18,21,54,45,33,12,25,30,22,29,15,25,22,76,35,28,14,16,39,21,25,67,14,52,13,28,11,27,23,18,43,21,69,59,19,22,24,21,30,14,12,68,14,31,17,43,14,46,34,23,10,22,42,63,19,106,122,24,20,16,39,14,19,31,30,19,34,30,32,35,37,98,73,41,27,24,41,11,14,10,90,50,22,20,27,47,25,17,15,14,62,11,54,24,29,71,35,12,21,41,23,27,14,31,74,23,12,35,36,19,13,66,14,32,11,42,13,19,85,22,21,17,41,29,14,30,39,48,22,26,52,18,22,55,43,34,24,16,31,15,12,20,63,27,41,33,16,16,52,52,28,26,18,61,12,26,26,47,38,19,22,34,35,23,43,72,32,10,27,16,37,16,14,37,23,15,35,12,11,104,25,59,16,19,56,22,12,17,10,21,29,16,36,26,50,49,18,31,35,57,47,80,16,16,23,22,40,30,15,21,29,19,20,36,26,68,57,82,21,54,14,13,53,25,26,28,69,23,14,55,11,10,20,15,55,42,11,11,28,58,14,26,68,16,17,14,13,13,12,14,11,11,12,29,10,15,27,17,68,21,49,49,82,21,19,14,22,67,19,16,22,48,14,21,20,49,105,61,54,21,123,14,57,31,95,68,26,25,49,49,63,14,39,14,36,21,27,21,14,45,21,89,30,112,93,24,36,17,65,30,16,23,28,26,21,35,57,37,15,15,51,17,40,23,19,27,29,22,58,44,28,44,12,15,23,10,22,17,33,19,14,21,10,29,30,18,29,33,14,68,19,21,91,104,25,11,21,23,18,20,20,23,15,87,39,11,100,72,15,51,17,21,25,22,39,31,29,12,40,19,27,65,23,13,13,18,10,13,39,13,79,41,11,43,20,17,30,19,23,15,71,19,20,23,36,46,19,34,24,28,19,28,51,51,48,34,92,30,32,14,28,21,25,20,44,25,22,30,16,81,17,44,70,28,35,73,39,16,24,34,36,33,20,87,34,86,15,22,21,20,18,80,34,30,17,24,38,23,36,27,17,16,118,28,25,49,17,25,78,21,23,18,67,23,79,87,35,29,28,26,18,42,24,74,54,42,18,55,19,20,51,23,25,27,49,20,19,30,47,15,33,35,17,32,32,89,18,34,23,99,26,18,38,43,27,18,35,28,18,54,56,47,49,28,30,33,24,86,71,38,23,41,23,50,57,18,56,20,26,18,129,16,36,28,31,18,28,32,42,36,50,44,17,87,13,88,43,94,27,29,27,79,22,29,23,43,48,105,41,21,69,36,30,40,31,12,45,24,32,18,40,41,37,17,50,60,27,33,17,17,27,14,15,64,10,20,67,10,36,29,16,65,11,25,51,21,91,68,10,15,19,11,71,36,16,37,109,46,22,13,18,49,17,57,11,33,17,43,50,16,23,14,30,23,20,43,32,14,14,18,44,17,15,13,25,30,65,22,36,65,49,20,18,18,12,20,69,119,42,34,14,75,86,47,20,17,18,10,70,71,29,16,26,24,10,61,16,21,21,22,10,17,10,12,12,25,32,48,22,54,34,69,63,29,77,16,27,16,16,27,19,33,37,19,36,36,37,13,30,35,22,78,27,18,32,43,49,19,11,52,14,39,30,30,11,50,40,23,20,17,12,15,25,34,21,28,15,18,12,15,17,29,44,44,41,38,39,36,56,19,16,60,27,54,81,16,41,59,48,33,11,49,15,17,17,14,51,27,13,36,31,15,29,78,132,20,32,36,22,15,20,23,30,31,28,18,12,31,15,64,30,35,22,52,71,28,21,70,25,16,22,74,45,56,33,27,40,47,31,16,37,34,30,21,43,50,14,36,32,64,40,28,30,14,115,81,82,27,11,67,36,22,61,40,29,28,23,50,28,121,110,20,72,12,57,15,27,30,88,27,22,22,67,16,35,32,78,34,21,23,32,27,50,31,55,22,42,20,23,61,26,40,20,25,45,14,74,23,35,27,32,47,17,11,20,67,21,49,22,17,16,51,27,12,33,18,27,65,17,10,22,35,34,14,119],"text":["Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Ouest","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Ouest","Region:  Ouest","Region:  Ouest","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Ouest","Region:  Ouest","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Est","Region:  Ouest","Region:  Est","Region:  Est","Region:  Ouest"],"type":"scatter","mode":"markers","marker":{"colorbar":{"title":"depth","ticklen":2},"cmin":40,"cmax":680,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[562,650,42,626,649,195,82,194,211,622,583,249,554,600,139,306,50,590,570,598,576,211,512,125,431,537,155,498,582,328,553,50,292,349,48,600,206,574,585,230,263,96,511,94,246,56,329,70,493,129,554,223,46,593,489,562,445,584,535,530,582,260,613,84,593,286,587,627,530,40,152,201,96,506,546,564,197,265,323,304,75,367,579,284,450,170,117,538,123,69,128,236,497,271,224,375,365,306,50,484,108,583,608,72,636,293,42,100,42,146,280,388,477,617,606,609,46,64,178,248,82,81,606,571,328,49,517,600,94,307,189,527,63,510,624,53,42,199,149,210,658,582,220,205,614,186,97,48,462,573,56,127,229,112,140,597,69,452,93,103,626,504,202,42,59,40,205,244,553,239,640,434,627,99,399,216,544,206,542,339,640,67,161,375,534,45,309,576,523,290,234,223,569,605,422,637,204,175,538,595,360,445,367,190,629,261,603,508,350,533,411,338,226,93,535,573,186,618,242,342,90,130,65,397,505,71,207,154,232,106,664,397,431,57,525,574,74,617,44,470,298,148,48,107,218,597,619,46,553,150,180,97,587,106,179,680,304,254,521,526,270,548,158,562,300,65,130,82,482,607,105,590,498,504,577,529,528,492,561,579,413,565,138,383,260,522,671,123,572,529,641,67,546,507,158,148,562,601,175,260,654,242,126,555,637,500,515,583,501,55,644,641,442,464,200,479,497,218,492,325,123,210,575,129,74,49,483,93,118,83,61,534,42,219,544,56,68,69,45,43,65,80,51,68,69,103,61,69,51,55,54,59,573,56,65,587,150,403,60,130,590,135,583,406,221,40,502,103,423,158,527,219,536,630,249,48,553,112,153,130,188,226,124,204,605,221,573,401,195,56,102,44,556,417,591,646,565,52,535,641,41,109,40,548,118,593,492,123,475,153,112,99,66,481,139,211,151,211,246,47,484,119,70,579,57,176,602,488,149,546,343,530,563,537,325,80,259,476,499,257,165,136,146,524,82,90,138,499,538,467,184,538,45,237,162,136,604,107,538,639,45,636,628,632,215,556,135,297,568,168,269,143,95,142,104,169,65,54,474,125,617,294,180,47,593,94,201,537,594,638,80,211,520,384,223,54,57,49,508,242,62,63,203,132,543,589,51,45,63,485,66,58,70,541,598,50,102,144,58,460,69,570,70,137,41,586,140,213,393,51,64,45,296,50,44,68,549,150,47,543,40,100,85,98,58,125,89,590,49,543,506,40,42,76,63,104,93,64,587,83,579,40,62,273,393,264,174,574,309,75,195,44,420,63,609,40,575,559,405,70,41,605,130,577,599,82,50,480,559,566,611,409,209,70,74,134,150,406,243,89,53,68,605,615,546,176,52,66,377,186,51,67,234,597,64,511,47,49,546,75,60,278,550,518,116,518,75,491,56,376,584,48,53,617,294,417,280,332,85,525,613,182,57,79,595,164,148,82,153,556,649,651,93,533,642,47,548,154,627,622,286,390,624,539,624,631,631,299,498,255,539,195,594,573,128,137,143,511,564,559,248,210,390,616,98,218,655,356,564,548,655,385,518,598,476,579,603,249,208,587,221,545,586,488,246,61,524,104,271,487,83,183,55,166,586,618,524,133,201,383,86,555,605,609,204,287,390,348,550,487,578,361,275,498,162,78,134,554,608,367,599,45,50,162,302,57,203,66,591,440,611,57,627,89,500,264,127,85,50,75,182,619,223,156,46,50,230,184,188,80,86,391,199,592,595,618,213,616,175,589,83,119,70,74,40,87,63,537,47,490,593,644,576,199,589,178,248,500,71,568,42,510,97,663,625,210,557,582,402,474,577,56,43,118,544,532,237,111,595,603,505,100,587,364,100,350,228,93,66,225,334,70,220,397,326,121,209,510,54,242,574,82,102,43,432,580,464,479,581,513,77,68,71,68,586,243,658,315,210,278,638,615,567,560,99,266,397,180,40,242,530,133,62,580,530,566,501,548,587,592,221,560,94,139,162,562,204,56,49,100,231,601,42,180,559,524,69,594,262,538,331,48,47,558,524,545,477,129,268,117,541,112,162,609,76,61,202,90,133,589,190,138,598,600,162,626,137,57,201,69,219,553,524,51,107,44,574,128,568,583,622,193,544,118,51,63,442,87,61,60,561,138,174,543,530,497,63,82,605,234,41,40,137,223,109,595,512,613,60,43,172,54,68,217,102,178,251,42,575,43,577,42,75,71,60,291,125,69,614,108,575,409,243,642,45,470,248,244,40,165],"size":[83.40625,95.78125,10.28125,92.40625,95.640625,31.796875,15.90625,31.65625,34.046875,91.84375,86.359375,39.390625,82.28125,88.75,23.921875,47.40625,11.40625,87.34375,84.53125,88.46875,85.375,34.046875,76.375,21.953125,64.984375,79.890625,26.171875,74.40625,86.21875,50.5,82.140625,11.40625,45.4375,53.453125,11.125,88.75,33.34375,85.09375,86.640625,36.71875,41.359375,17.875,76.234375,17.59375,38.96875,12.25,50.640625,14.21875,73.703125,22.515625,82.28125,35.734375,10.84375,87.765625,73.140625,83.40625,66.953125,86.5,79.609375,78.90625,86.21875,40.9375,90.578125,16.1875,87.765625,44.59375,86.921875,92.546875,78.90625,10,25.75,32.640625,17.875,75.53125,81.15625,83.6875,32.078125,41.640625,49.796875,47.125,14.921875,55.984375,85.796875,44.3125,67.65625,28.28125,20.828125,80.03125,21.671875,14.078125,22.375,37.5625,74.265625,42.484375,35.875,57.109375,55.703125,47.40625,11.40625,72.4375,19.5625,86.359375,89.875,14.5,93.8125,45.578125,10.28125,18.4375,10.28125,24.90625,43.75,58.9375,71.453125,91.140625,89.59375,90.015625,10.84375,13.375,29.40625,39.25,15.90625,15.765625,89.59375,84.671875,50.5,11.265625,77.078125,88.75,17.59375,47.546875,30.953125,78.484375,13.234375,76.09375,92.125,11.828125,10.28125,32.359375,25.328125,33.90625,96.90625,86.21875,35.3125,33.203125,90.71875,30.53125,18.015625,11.125,69.34375,84.953125,12.25,22.234375,36.578125,20.125,24.0625,88.328125,14.078125,67.9375,17.453125,18.859375,92.40625,75.25,32.78125,10.28125,12.671875,10,33.203125,38.6875,82.140625,37.984375,94.375,65.40625,92.546875,18.296875,60.484375,34.75,80.875,33.34375,80.59375,52.046875,94.375,13.796875,27.015625,57.109375,79.46875,10.703125,47.828125,85.375,77.921875,45.15625,37.28125,35.734375,84.390625,89.453125,63.71875,93.953125,33.0625,28.984375,80.03125,88.046875,55,66.953125,55.984375,31.09375,92.828125,41.078125,89.171875,75.8125,53.59375,79.328125,62.171875,51.90625,36.15625,17.453125,79.609375,84.953125,30.53125,91.28125,38.40625,52.46875,17.03125,22.65625,13.515625,60.203125,75.390625,14.359375,33.484375,26.03125,37,19.28125,97.75,60.203125,64.984375,12.390625,78.203125,85.09375,14.78125,91.140625,10.5625,70.46875,46.28125,25.1875,11.125,19.421875,35.03125,88.328125,91.421875,10.84375,82.140625,25.46875,29.6875,18.015625,86.921875,19.28125,29.546875,100,47.125,40.09375,77.640625,78.34375,42.34375,81.4375,26.59375,83.40625,46.5625,13.515625,22.65625,15.90625,72.15625,89.734375,19.140625,87.34375,74.40625,75.25,85.515625,78.765625,78.625,73.5625,83.265625,85.796875,62.453125,83.828125,23.78125,58.234375,40.9375,77.78125,98.734375,21.671875,84.8125,78.765625,94.515625,13.796875,81.15625,75.671875,26.59375,25.1875,83.40625,88.890625,28.984375,40.9375,96.34375,38.40625,22.09375,82.421875,93.953125,74.6875,76.796875,86.359375,74.828125,12.109375,94.9375,94.515625,66.53125,69.625,32.5,71.734375,74.265625,35.03125,73.5625,50.078125,21.671875,33.90625,85.234375,22.515625,14.78125,11.265625,72.296875,17.453125,20.96875,16.046875,12.953125,79.46875,10.28125,35.171875,80.875,12.25,13.9375,14.078125,10.703125,10.421875,13.515625,15.625,11.546875,13.9375,14.078125,18.859375,12.953125,14.078125,11.546875,12.109375,11.96875,12.671875,84.953125,12.25,13.515625,86.921875,25.46875,61.046875,12.8125,22.65625,87.34375,23.359375,86.359375,61.46875,35.453125,10,74.96875,18.859375,63.859375,26.59375,78.484375,35.171875,79.75,92.96875,39.390625,11.125,82.140625,20.125,25.890625,22.65625,30.8125,36.15625,21.8125,33.0625,89.453125,35.453125,84.953125,60.765625,31.796875,12.25,18.71875,10.5625,82.5625,63.015625,87.484375,95.21875,83.828125,11.6875,79.609375,94.515625,10.140625,19.703125,10,81.4375,20.96875,87.765625,73.5625,21.671875,71.171875,25.890625,20.125,18.296875,13.65625,72.015625,23.921875,34.046875,25.609375,34.046875,38.96875,10.984375,72.4375,21.109375,14.21875,85.796875,12.390625,29.125,89.03125,73,25.328125,81.15625,52.609375,78.90625,83.546875,79.890625,50.078125,15.625,40.796875,71.3125,74.546875,40.515625,27.578125,23.5,24.90625,78.0625,15.90625,17.03125,23.78125,74.546875,80.03125,70.046875,30.25,80.03125,10.703125,37.703125,27.15625,23.5,89.3125,19.421875,80.03125,94.234375,10.703125,93.8125,92.6875,93.25,34.609375,82.5625,23.359375,46.140625,84.25,28,42.203125,24.484375,17.734375,24.34375,19,28.140625,13.515625,11.96875,71.03125,21.953125,91.140625,45.71875,29.6875,10.984375,87.765625,17.59375,32.640625,79.890625,87.90625,94.09375,15.625,34.046875,77.5,58.375,35.734375,11.96875,12.390625,11.265625,75.8125,38.40625,13.09375,13.234375,32.921875,22.9375,80.734375,87.203125,11.546875,10.703125,13.234375,72.578125,13.65625,12.53125,14.21875,80.453125,88.46875,11.40625,18.71875,24.625,12.53125,69.0625,14.078125,84.53125,14.21875,23.640625,10.140625,86.78125,24.0625,34.328125,59.640625,11.546875,13.375,10.703125,46,11.40625,10.5625,13.9375,81.578125,25.46875,10.984375,80.734375,10,18.4375,16.328125,18.15625,12.53125,21.953125,16.890625,87.34375,11.265625,80.734375,75.53125,10,10.28125,15.0625,13.234375,19,17.453125,13.375,86.921875,16.046875,85.796875,10,13.09375,42.765625,59.640625,41.5,28.84375,85.09375,47.828125,14.921875,31.796875,10.5625,63.4375,13.234375,90.015625,10,85.234375,82.984375,61.328125,14.21875,10.140625,89.453125,22.65625,85.515625,88.609375,15.90625,11.40625,71.875,82.984375,83.96875,90.296875,61.890625,33.765625,14.21875,14.78125,23.21875,25.46875,61.46875,38.546875,16.890625,11.828125,13.9375,89.453125,90.859375,81.15625,29.125,11.6875,13.65625,57.390625,30.53125,11.546875,13.796875,37.28125,88.328125,13.375,76.234375,10.984375,11.265625,81.15625,14.921875,12.8125,43.46875,81.71875,77.21875,20.6875,77.21875,14.921875,73.421875,12.25,57.25,86.5,11.125,11.828125,91.140625,45.71875,63.015625,43.75,51.0625,16.328125,78.203125,90.578125,29.96875,12.390625,15.484375,88.046875,27.4375,25.1875,15.90625,25.890625,82.5625,95.640625,95.921875,17.453125,79.328125,94.65625,10.984375,81.4375,26.03125,92.546875,91.84375,44.59375,59.21875,92.125,80.171875,92.125,93.109375,93.109375,46.421875,74.40625,40.234375,80.171875,31.796875,87.90625,84.953125,22.375,23.640625,24.484375,76.234375,83.6875,82.984375,39.25,33.90625,59.21875,91,18.15625,35.03125,96.484375,54.4375,83.6875,81.4375,96.484375,58.515625,77.21875,88.46875,71.3125,85.796875,89.171875,39.390625,33.625,86.921875,35.453125,81.015625,86.78125,73,38.96875,12.953125,78.0625,19,42.484375,72.859375,16.046875,30.109375,12.109375,27.71875,86.78125,91.28125,78.0625,23.078125,32.640625,58.234375,16.46875,82.421875,89.453125,90.015625,33.0625,44.734375,59.21875,53.3125,81.71875,72.859375,85.65625,55.140625,43.046875,74.40625,27.15625,15.34375,23.21875,82.28125,89.875,55.984375,88.609375,10.703125,11.40625,27.15625,46.84375,12.390625,32.921875,13.65625,87.484375,66.25,90.296875,12.390625,92.546875,16.890625,74.6875,41.5,22.234375,16.328125,11.40625,14.921875,29.96875,91.421875,35.734375,26.3125,10.84375,11.40625,36.71875,30.25,30.8125,15.625,16.46875,59.359375,32.359375,87.625,88.046875,91.28125,34.328125,91,28.984375,87.203125,16.046875,21.109375,14.21875,14.78125,10,16.609375,13.234375,79.890625,10.984375,73.28125,87.765625,94.9375,85.375,32.359375,87.203125,29.40625,39.25,74.6875,14.359375,84.25,10.28125,76.09375,18.015625,97.609375,92.265625,33.90625,82.703125,86.21875,60.90625,71.03125,85.515625,12.25,10.421875,20.96875,80.875,79.1875,37.703125,19.984375,88.046875,89.171875,75.390625,18.4375,86.921875,55.5625,18.4375,53.59375,36.4375,17.453125,13.65625,36.015625,51.34375,14.21875,35.3125,60.203125,50.21875,21.390625,33.765625,76.09375,11.96875,38.40625,85.09375,15.90625,18.71875,10.421875,65.125,85.9375,69.625,71.734375,86.078125,76.515625,15.203125,13.9375,14.359375,13.9375,86.78125,38.546875,96.90625,48.671875,33.90625,43.46875,94.09375,90.859375,84.109375,83.125,18.296875,41.78125,60.203125,29.6875,10,38.40625,78.90625,23.078125,13.09375,85.9375,78.90625,83.96875,74.828125,81.4375,86.921875,87.625,35.453125,83.125,17.59375,23.921875,27.15625,83.40625,33.0625,12.25,11.265625,18.4375,36.859375,88.890625,10.28125,29.6875,82.984375,78.0625,14.078125,87.90625,41.21875,80.03125,50.921875,11.125,10.984375,82.84375,78.0625,81.015625,71.453125,22.515625,42.0625,20.828125,80.453125,20.125,27.15625,90.015625,15.0625,12.953125,32.78125,17.03125,23.078125,87.203125,31.09375,23.78125,88.46875,88.75,27.15625,92.40625,23.640625,12.390625,32.640625,14.078125,35.171875,82.140625,78.0625,11.546875,19.421875,10.5625,85.09375,22.375,84.25,86.359375,91.84375,31.515625,80.875,20.96875,11.546875,13.234375,66.53125,16.609375,12.953125,12.8125,83.265625,23.78125,28.84375,80.734375,78.90625,74.265625,13.234375,15.90625,89.453125,37.28125,10.140625,10,23.640625,35.734375,19.703125,88.046875,76.375,90.578125,12.8125,10.421875,28.5625,11.96875,13.9375,34.890625,18.71875,29.40625,39.671875,10.28125,85.234375,10.421875,85.515625,10.28125,14.921875,14.359375,12.8125,45.296875,21.953125,14.078125,90.71875,19.5625,85.234375,61.890625,38.546875,94.65625,10.703125,70.46875,39.25,38.6875,10,27.578125],"sizemode":"area","line":{"colorbar":{"title":"","ticklen":2},"cmin":40,"cmax":680,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":false,"color":[562,650,42,626,649,195,82,194,211,622,583,249,554,600,139,306,50,590,570,598,576,211,512,125,431,537,155,498,582,328,553,50,292,349,48,600,206,574,585,230,263,96,511,94,246,56,329,70,493,129,554,223,46,593,489,562,445,584,535,530,582,260,613,84,593,286,587,627,530,40,152,201,96,506,546,564,197,265,323,304,75,367,579,284,450,170,117,538,123,69,128,236,497,271,224,375,365,306,50,484,108,583,608,72,636,293,42,100,42,146,280,388,477,617,606,609,46,64,178,248,82,81,606,571,328,49,517,600,94,307,189,527,63,510,624,53,42,199,149,210,658,582,220,205,614,186,97,48,462,573,56,127,229,112,140,597,69,452,93,103,626,504,202,42,59,40,205,244,553,239,640,434,627,99,399,216,544,206,542,339,640,67,161,375,534,45,309,576,523,290,234,223,569,605,422,637,204,175,538,595,360,445,367,190,629,261,603,508,350,533,411,338,226,93,535,573,186,618,242,342,90,130,65,397,505,71,207,154,232,106,664,397,431,57,525,574,74,617,44,470,298,148,48,107,218,597,619,46,553,150,180,97,587,106,179,680,304,254,521,526,270,548,158,562,300,65,130,82,482,607,105,590,498,504,577,529,528,492,561,579,413,565,138,383,260,522,671,123,572,529,641,67,546,507,158,148,562,601,175,260,654,242,126,555,637,500,515,583,501,55,644,641,442,464,200,479,497,218,492,325,123,210,575,129,74,49,483,93,118,83,61,534,42,219,544,56,68,69,45,43,65,80,51,68,69,103,61,69,51,55,54,59,573,56,65,587,150,403,60,130,590,135,583,406,221,40,502,103,423,158,527,219,536,630,249,48,553,112,153,130,188,226,124,204,605,221,573,401,195,56,102,44,556,417,591,646,565,52,535,641,41,109,40,548,118,593,492,123,475,153,112,99,66,481,139,211,151,211,246,47,484,119,70,579,57,176,602,488,149,546,343,530,563,537,325,80,259,476,499,257,165,136,146,524,82,90,138,499,538,467,184,538,45,237,162,136,604,107,538,639,45,636,628,632,215,556,135,297,568,168,269,143,95,142,104,169,65,54,474,125,617,294,180,47,593,94,201,537,594,638,80,211,520,384,223,54,57,49,508,242,62,63,203,132,543,589,51,45,63,485,66,58,70,541,598,50,102,144,58,460,69,570,70,137,41,586,140,213,393,51,64,45,296,50,44,68,549,150,47,543,40,100,85,98,58,125,89,590,49,543,506,40,42,76,63,104,93,64,587,83,579,40,62,273,393,264,174,574,309,75,195,44,420,63,609,40,575,559,405,70,41,605,130,577,599,82,50,480,559,566,611,409,209,70,74,134,150,406,243,89,53,68,605,615,546,176,52,66,377,186,51,67,234,597,64,511,47,49,546,75,60,278,550,518,116,518,75,491,56,376,584,48,53,617,294,417,280,332,85,525,613,182,57,79,595,164,148,82,153,556,649,651,93,533,642,47,548,154,627,622,286,390,624,539,624,631,631,299,498,255,539,195,594,573,128,137,143,511,564,559,248,210,390,616,98,218,655,356,564,548,655,385,518,598,476,579,603,249,208,587,221,545,586,488,246,61,524,104,271,487,83,183,55,166,586,618,524,133,201,383,86,555,605,609,204,287,390,348,550,487,578,361,275,498,162,78,134,554,608,367,599,45,50,162,302,57,203,66,591,440,611,57,627,89,500,264,127,85,50,75,182,619,223,156,46,50,230,184,188,80,86,391,199,592,595,618,213,616,175,589,83,119,70,74,40,87,63,537,47,490,593,644,576,199,589,178,248,500,71,568,42,510,97,663,625,210,557,582,402,474,577,56,43,118,544,532,237,111,595,603,505,100,587,364,100,350,228,93,66,225,334,70,220,397,326,121,209,510,54,242,574,82,102,43,432,580,464,479,581,513,77,68,71,68,586,243,658,315,210,278,638,615,567,560,99,266,397,180,40,242,530,133,62,580,530,566,501,548,587,592,221,560,94,139,162,562,204,56,49,100,231,601,42,180,559,524,69,594,262,538,331,48,47,558,524,545,477,129,268,117,541,112,162,609,76,61,202,90,133,589,190,138,598,600,162,626,137,57,201,69,219,553,524,51,107,44,574,128,568,583,622,193,544,118,51,63,442,87,61,60,561,138,174,543,530,497,63,82,605,234,41,40,137,223,109,595,512,613,60,43,172,54,68,217,102,178,251,42,575,43,577,42,75,71,60,291,125,69,614,108,575,409,243,642,45,470,248,244,40,165]}},"textfont":{"size":[83.40625,95.78125,10.28125,92.40625,95.640625,31.796875,15.90625,31.65625,34.046875,91.84375,86.359375,39.390625,82.28125,88.75,23.921875,47.40625,11.40625,87.34375,84.53125,88.46875,85.375,34.046875,76.375,21.953125,64.984375,79.890625,26.171875,74.40625,86.21875,50.5,82.140625,11.40625,45.4375,53.453125,11.125,88.75,33.34375,85.09375,86.640625,36.71875,41.359375,17.875,76.234375,17.59375,38.96875,12.25,50.640625,14.21875,73.703125,22.515625,82.28125,35.734375,10.84375,87.765625,73.140625,83.40625,66.953125,86.5,79.609375,78.90625,86.21875,40.9375,90.578125,16.1875,87.765625,44.59375,86.921875,92.546875,78.90625,10,25.75,32.640625,17.875,75.53125,81.15625,83.6875,32.078125,41.640625,49.796875,47.125,14.921875,55.984375,85.796875,44.3125,67.65625,28.28125,20.828125,80.03125,21.671875,14.078125,22.375,37.5625,74.265625,42.484375,35.875,57.109375,55.703125,47.40625,11.40625,72.4375,19.5625,86.359375,89.875,14.5,93.8125,45.578125,10.28125,18.4375,10.28125,24.90625,43.75,58.9375,71.453125,91.140625,89.59375,90.015625,10.84375,13.375,29.40625,39.25,15.90625,15.765625,89.59375,84.671875,50.5,11.265625,77.078125,88.75,17.59375,47.546875,30.953125,78.484375,13.234375,76.09375,92.125,11.828125,10.28125,32.359375,25.328125,33.90625,96.90625,86.21875,35.3125,33.203125,90.71875,30.53125,18.015625,11.125,69.34375,84.953125,12.25,22.234375,36.578125,20.125,24.0625,88.328125,14.078125,67.9375,17.453125,18.859375,92.40625,75.25,32.78125,10.28125,12.671875,10,33.203125,38.6875,82.140625,37.984375,94.375,65.40625,92.546875,18.296875,60.484375,34.75,80.875,33.34375,80.59375,52.046875,94.375,13.796875,27.015625,57.109375,79.46875,10.703125,47.828125,85.375,77.921875,45.15625,37.28125,35.734375,84.390625,89.453125,63.71875,93.953125,33.0625,28.984375,80.03125,88.046875,55,66.953125,55.984375,31.09375,92.828125,41.078125,89.171875,75.8125,53.59375,79.328125,62.171875,51.90625,36.15625,17.453125,79.609375,84.953125,30.53125,91.28125,38.40625,52.46875,17.03125,22.65625,13.515625,60.203125,75.390625,14.359375,33.484375,26.03125,37,19.28125,97.75,60.203125,64.984375,12.390625,78.203125,85.09375,14.78125,91.140625,10.5625,70.46875,46.28125,25.1875,11.125,19.421875,35.03125,88.328125,91.421875,10.84375,82.140625,25.46875,29.6875,18.015625,86.921875,19.28125,29.546875,100,47.125,40.09375,77.640625,78.34375,42.34375,81.4375,26.59375,83.40625,46.5625,13.515625,22.65625,15.90625,72.15625,89.734375,19.140625,87.34375,74.40625,75.25,85.515625,78.765625,78.625,73.5625,83.265625,85.796875,62.453125,83.828125,23.78125,58.234375,40.9375,77.78125,98.734375,21.671875,84.8125,78.765625,94.515625,13.796875,81.15625,75.671875,26.59375,25.1875,83.40625,88.890625,28.984375,40.9375,96.34375,38.40625,22.09375,82.421875,93.953125,74.6875,76.796875,86.359375,74.828125,12.109375,94.9375,94.515625,66.53125,69.625,32.5,71.734375,74.265625,35.03125,73.5625,50.078125,21.671875,33.90625,85.234375,22.515625,14.78125,11.265625,72.296875,17.453125,20.96875,16.046875,12.953125,79.46875,10.28125,35.171875,80.875,12.25,13.9375,14.078125,10.703125,10.421875,13.515625,15.625,11.546875,13.9375,14.078125,18.859375,12.953125,14.078125,11.546875,12.109375,11.96875,12.671875,84.953125,12.25,13.515625,86.921875,25.46875,61.046875,12.8125,22.65625,87.34375,23.359375,86.359375,61.46875,35.453125,10,74.96875,18.859375,63.859375,26.59375,78.484375,35.171875,79.75,92.96875,39.390625,11.125,82.140625,20.125,25.890625,22.65625,30.8125,36.15625,21.8125,33.0625,89.453125,35.453125,84.953125,60.765625,31.796875,12.25,18.71875,10.5625,82.5625,63.015625,87.484375,95.21875,83.828125,11.6875,79.609375,94.515625,10.140625,19.703125,10,81.4375,20.96875,87.765625,73.5625,21.671875,71.171875,25.890625,20.125,18.296875,13.65625,72.015625,23.921875,34.046875,25.609375,34.046875,38.96875,10.984375,72.4375,21.109375,14.21875,85.796875,12.390625,29.125,89.03125,73,25.328125,81.15625,52.609375,78.90625,83.546875,79.890625,50.078125,15.625,40.796875,71.3125,74.546875,40.515625,27.578125,23.5,24.90625,78.0625,15.90625,17.03125,23.78125,74.546875,80.03125,70.046875,30.25,80.03125,10.703125,37.703125,27.15625,23.5,89.3125,19.421875,80.03125,94.234375,10.703125,93.8125,92.6875,93.25,34.609375,82.5625,23.359375,46.140625,84.25,28,42.203125,24.484375,17.734375,24.34375,19,28.140625,13.515625,11.96875,71.03125,21.953125,91.140625,45.71875,29.6875,10.984375,87.765625,17.59375,32.640625,79.890625,87.90625,94.09375,15.625,34.046875,77.5,58.375,35.734375,11.96875,12.390625,11.265625,75.8125,38.40625,13.09375,13.234375,32.921875,22.9375,80.734375,87.203125,11.546875,10.703125,13.234375,72.578125,13.65625,12.53125,14.21875,80.453125,88.46875,11.40625,18.71875,24.625,12.53125,69.0625,14.078125,84.53125,14.21875,23.640625,10.140625,86.78125,24.0625,34.328125,59.640625,11.546875,13.375,10.703125,46,11.40625,10.5625,13.9375,81.578125,25.46875,10.984375,80.734375,10,18.4375,16.328125,18.15625,12.53125,21.953125,16.890625,87.34375,11.265625,80.734375,75.53125,10,10.28125,15.0625,13.234375,19,17.453125,13.375,86.921875,16.046875,85.796875,10,13.09375,42.765625,59.640625,41.5,28.84375,85.09375,47.828125,14.921875,31.796875,10.5625,63.4375,13.234375,90.015625,10,85.234375,82.984375,61.328125,14.21875,10.140625,89.453125,22.65625,85.515625,88.609375,15.90625,11.40625,71.875,82.984375,83.96875,90.296875,61.890625,33.765625,14.21875,14.78125,23.21875,25.46875,61.46875,38.546875,16.890625,11.828125,13.9375,89.453125,90.859375,81.15625,29.125,11.6875,13.65625,57.390625,30.53125,11.546875,13.796875,37.28125,88.328125,13.375,76.234375,10.984375,11.265625,81.15625,14.921875,12.8125,43.46875,81.71875,77.21875,20.6875,77.21875,14.921875,73.421875,12.25,57.25,86.5,11.125,11.828125,91.140625,45.71875,63.015625,43.75,51.0625,16.328125,78.203125,90.578125,29.96875,12.390625,15.484375,88.046875,27.4375,25.1875,15.90625,25.890625,82.5625,95.640625,95.921875,17.453125,79.328125,94.65625,10.984375,81.4375,26.03125,92.546875,91.84375,44.59375,59.21875,92.125,80.171875,92.125,93.109375,93.109375,46.421875,74.40625,40.234375,80.171875,31.796875,87.90625,84.953125,22.375,23.640625,24.484375,76.234375,83.6875,82.984375,39.25,33.90625,59.21875,91,18.15625,35.03125,96.484375,54.4375,83.6875,81.4375,96.484375,58.515625,77.21875,88.46875,71.3125,85.796875,89.171875,39.390625,33.625,86.921875,35.453125,81.015625,86.78125,73,38.96875,12.953125,78.0625,19,42.484375,72.859375,16.046875,30.109375,12.109375,27.71875,86.78125,91.28125,78.0625,23.078125,32.640625,58.234375,16.46875,82.421875,89.453125,90.015625,33.0625,44.734375,59.21875,53.3125,81.71875,72.859375,85.65625,55.140625,43.046875,74.40625,27.15625,15.34375,23.21875,82.28125,89.875,55.984375,88.609375,10.703125,11.40625,27.15625,46.84375,12.390625,32.921875,13.65625,87.484375,66.25,90.296875,12.390625,92.546875,16.890625,74.6875,41.5,22.234375,16.328125,11.40625,14.921875,29.96875,91.421875,35.734375,26.3125,10.84375,11.40625,36.71875,30.25,30.8125,15.625,16.46875,59.359375,32.359375,87.625,88.046875,91.28125,34.328125,91,28.984375,87.203125,16.046875,21.109375,14.21875,14.78125,10,16.609375,13.234375,79.890625,10.984375,73.28125,87.765625,94.9375,85.375,32.359375,87.203125,29.40625,39.25,74.6875,14.359375,84.25,10.28125,76.09375,18.015625,97.609375,92.265625,33.90625,82.703125,86.21875,60.90625,71.03125,85.515625,12.25,10.421875,20.96875,80.875,79.1875,37.703125,19.984375,88.046875,89.171875,75.390625,18.4375,86.921875,55.5625,18.4375,53.59375,36.4375,17.453125,13.65625,36.015625,51.34375,14.21875,35.3125,60.203125,50.21875,21.390625,33.765625,76.09375,11.96875,38.40625,85.09375,15.90625,18.71875,10.421875,65.125,85.9375,69.625,71.734375,86.078125,76.515625,15.203125,13.9375,14.359375,13.9375,86.78125,38.546875,96.90625,48.671875,33.90625,43.46875,94.09375,90.859375,84.109375,83.125,18.296875,41.78125,60.203125,29.6875,10,38.40625,78.90625,23.078125,13.09375,85.9375,78.90625,83.96875,74.828125,81.4375,86.921875,87.625,35.453125,83.125,17.59375,23.921875,27.15625,83.40625,33.0625,12.25,11.265625,18.4375,36.859375,88.890625,10.28125,29.6875,82.984375,78.0625,14.078125,87.90625,41.21875,80.03125,50.921875,11.125,10.984375,82.84375,78.0625,81.015625,71.453125,22.515625,42.0625,20.828125,80.453125,20.125,27.15625,90.015625,15.0625,12.953125,32.78125,17.03125,23.078125,87.203125,31.09375,23.78125,88.46875,88.75,27.15625,92.40625,23.640625,12.390625,32.640625,14.078125,35.171875,82.140625,78.0625,11.546875,19.421875,10.5625,85.09375,22.375,84.25,86.359375,91.84375,31.515625,80.875,20.96875,11.546875,13.234375,66.53125,16.609375,12.953125,12.8125,83.265625,23.78125,28.84375,80.734375,78.90625,74.265625,13.234375,15.90625,89.453125,37.28125,10.140625,10,23.640625,35.734375,19.703125,88.046875,76.375,90.578125,12.8125,10.421875,28.5625,11.96875,13.9375,34.890625,18.71875,29.40625,39.671875,10.28125,85.234375,10.421875,85.515625,10.28125,14.921875,14.359375,12.8125,45.296875,21.953125,14.078125,90.71875,19.5625,85.234375,61.890625,38.546875,94.65625,10.703125,70.46875,39.25,38.6875,10,27.578125]},"error_y":{"width":[]},"error_x":{"width":[]},"xaxis":"x","yaxis":"y","frame":null},{"x":[4,6.4],"y":[10,132],"type":"scatter","mode":"markers","opacity":0,"hoverinfo":"none","showlegend":false,"marker":{"colorbar":{"title":"depth","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"cmin":40,"cmax":680,"colorscale":[["0","rgba(68,1,84,1)"],["0.0416666666666667","rgba(70,19,97,1)"],["0.0833333333333333","rgba(72,32,111,1)"],["0.125","rgba(71,45,122,1)"],["0.166666666666667","rgba(68,58,128,1)"],["0.208333333333333","rgba(64,70,135,1)"],["0.25","rgba(60,82,138,1)"],["0.291666666666667","rgba(56,93,140,1)"],["0.333333333333333","rgba(49,104,142,1)"],["0.375","rgba(46,114,142,1)"],["0.416666666666667","rgba(42,123,142,1)"],["0.458333333333333","rgba(38,133,141,1)"],["0.5","rgba(37,144,140,1)"],["0.541666666666667","rgba(33,154,138,1)"],["0.583333333333333","rgba(39,164,133,1)"],["0.625","rgba(47,174,127,1)"],["0.666666666666667","rgba(53,183,121,1)"],["0.708333333333333","rgba(79,191,110,1)"],["0.75","rgba(98,199,98,1)"],["0.791666666666667","rgba(119,207,85,1)"],["0.833333333333333","rgba(147,214,70,1)"],["0.875","rgba(172,220,52,1)"],["0.916666666666667","rgba(199,225,42,1)"],["0.958333333333333","rgba(226,228,40,1)"],["1","rgba(253,231,37,1)"]],"showscale":true,"color":[40,680],"line":{"color":"rgba(255,127,14,1)"}},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="autres-packages-pour-la-création-de-graphiques-interactifs-en-r" class="section level3">
<h3>Autres packages pour la création de graphiques interactifs en R</h3>
<p>Les tutoriels suivants, réalisés par d’anciens étudiants de ce cours, portaient sur des packages R pour la création de graphiques interactifs :</p>
<ul>
<li>package <a href="https://plot.ly/r/"><code>plotly</code></a> mentionnné ci-dessus :<br />
<a href="https://stt4230.rbind.io/tutoriels_etudiants/hiver_2018/plotly/" class="uri">https://stt4230.rbind.io/tutoriels_etudiants/hiver_2018/plotly/</a></li>
<li>package <a href="https://CRAN.R-project.org/package=googleVis"><code>googleVis</code></a> pour créer des <a href="https://developers.google.com/chart/">Google charts</a> :<br />
<a href="https://stt4230.rbind.io/tutoriels_etudiants/hiver_2018/googlevis/" class="uri">https://stt4230.rbind.io/tutoriels_etudiants/hiver_2018/googlevis/</a></li>
<li>package <a href="http://jkunst.com/highcharter/"><code>highcharter</code></a> basé sur la <a href="https://www.highcharts.com/">librairie JavaScript Highcharts</a>, pour produire divers graphiques interactifs :<br />
<a href="https://stt4230.rbind.io/tutoriels_etudiants/hiver_2018/highcharter/" class="uri">https://stt4230.rbind.io/tutoriels_etudiants/hiver_2018/highcharter/</a></li>
<li>package <a href="https://davidgohel.github.io/ggiraph/index.html"><code>ggiraph</code></a> pour rendre des graphiques <code>ggplot2</code> interactifs :<br />
<a href="https://stt4230.rbind.io/tutoriels_etudiants/hiver_2018/ggiraph/" class="uri">https://stt4230.rbind.io/tutoriels_etudiants/hiver_2018/ggiraph/</a></li>
<li>package<a href="https://rstudio.github.io/dygraphs/"><code>dygraphs</code></a>, basé sur la <a href="http://dygraphs.com/">librairie JavaScript du même nom</a>, pour produire des graphiques temporels interactifs : <a href="https://stt4230.rbind.io/tutoriels_etudiants/hiver_2019/dygraphs/" class="uri">https://stt4230.rbind.io/tutoriels_etudiants/hiver_2019/dygraphs/</a></li>
<li>package <a href="https://rstudio.github.io/DT/"><code>DT</code></a>, basé sur la <a href="https://datatables.net/">librairie JavaScript DataTables</a>, pour produire des tableaux interactifs : <a href="https://stt4230.rbind.io/tutoriels_etudiants/hiver_2019/dt/" class="uri">https://stt4230.rbind.io/tutoriels_etudiants/hiver_2019/dt/</a></li>
</ul>
<!--

###  Google Charts - package `googleVis`

Google Charts est un outil de création de graphiques développé par Google (https://developers.google.com/chart/). Il permet d'intégrer des graphiques à des pages web. Il propose plusieurs types de graphiques.


**Exemple** : (affiché seulement dans la version HTML des notes, pas dans le PDF)









**Autres Exemple** : *Geo Chart*  

Les *Geo Chart* sont des cartes géographiques intégrant des couleurs dans des régions selon le niveau d'une variable. Ce type de carte est parfois nommé carte choroplèthe. En voici un exemple :

https://developers.google.com/chart/interactive/docs/gallery/geochart

-->
</div>
</div>
</div>
<div id="conclusion" class="section level1">
<h1>Conclusion</h1>
<div id="quelques-conseils" class="section level4">
<h4>Quelques conseils :</h4>
<ul>
<li>Trouver de l’information :
<ul>
<li>Système graphique de base :<br />
lire les fiches d’aide, nous y apprenons toutes les possibilités des fonctions;</li>
<li>Autres systèmes (en particulier <code>ggplot2</code>) et packages graphiques :<br />
faire des recherches sur internet.</li>
</ul></li>
<li>Stratégie 1 - Procéder par essai/erreur jusqu’à obtenir le graphique souhaité.</li>
<li>Stratégie 2 - Partir d’un modèle :
<ul>
<li>un graphique que nous avons déjà fait ou</li>
<li>un graphique trouvé dans un livre ou sur internet (voir les références).</li>
</ul></li>
</ul>
</div>
<div id="r-un-excellent-outil-pour-les-graphiques" class="section level4">
<h4>R = un excellent outil pour les graphiques</h4>
<ul>
<li>R produit des graphiques d’assez bonne qualité pour des publications et facilement reproductibles à partir de leur code source.</li>
<li>La variété des graphiques possibles de créer en R est impressionnante.</li>
<li>De nouvelles fonctions graphiques sont fréquemment ajoutées.</li>
</ul>
<hr />
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="résumé" class="section level1">
<h1>Résumé</h1>
<div id="packages-graphiques-en-r" class="section level5">
<h5>Packages graphiques en R</h5>

<p><strong>Système graphique de base :</strong> <code>graphics</code> et <code>grDevices</code> : intégrés au R de base <span class="math inline">\(\Rightarrow\)</span> chargés par défaut lors de l’ouverture d’une session R</p>
<p><strong>Autres systèmes graphiques :</strong></p>
<ul>
<li><a href="https://CRAN.R-project.org/package=lattice"><code>lattice</code></a> : emphase sur les représentations multivariables</li>
<li><a href="https://CRAN.R-project.org/package=ggplot2"><code>ggplot2</code></a> : conçu en ayant comme objectif la simplicité d’utilisation et la qualité des graphiques produits</li>
</ul>
<p><strong>Packages offrant d’autres types de graphiques, notamment :</strong></p>
<ul>
<li>graphiques 3D orientables : <a href="https://cran.r-project.org/web/packages/rgl/vignettes/rgl.html"><code>rgl</code></a></li>
<li>graphiques interactifs : <a href="https://plot.ly/r/"><code>plotly</code></a>, etc.</li>
<li>cartes géographiques : <a href="https://CRAN.R-project.org/package=maps"><code>maps</code></a>, <a href="https://CRAN.R-project.org/package=mapdata"><code>mapdata</code></a>, etc.</li>
<li>et bien d’autres : <a href="https://cran.r-project.org/web/views/Graphics.html" class="uri">https://cran.r-project.org/web/views/Graphics.html</a></li>
</ul>
</div>
<div id="système-graphique-de-base" class="section level4">
<h4>Système graphique de base</h4>

<div id="procédure-de-création-dun-graphique-de-base" class="section level5">
<h5>Procédure de création d’un graphique de base</h5>

<ol style="list-style-type: decimal">
<li>La configuration des paramètres graphiques (au besoin) :
<ul>
<li>énoncé <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/par.html"><code>par</code></a> ou <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/layout.html"><code>layout</code></a>.</li>
</ul></li>
<li>L’initialisation d’un graphique :
<ul>
<li>fonction de base : <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.html"><code>plot</code></a>,</li>
<li>ou fonction pour un type spécifique graphiques : <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/pairs.html"><code>pairs</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/matplot.html"><code>matplot</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/pie.html"><code>pie</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/barplot.html"><code>barplot</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/mosaicplot.html"><code>dotchart</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/mosaicplot.html"><code>mosaicplot</code></a>, <a href="http://stat.ethz.ch/R-manual/R-devel/library/graphics/html/hist.html"><code>hist</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/boxplot.html"><code>boxplot</code></a>, <a href="http://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqnorm</code></a>, <a href="http://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqplot</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/curve.html"><code>curve</code></a>, etc.</li>
</ul></li>
<li>L’ajout séquentiel d’éléments au graphique (au besoin) :
<ul>
<li>fonctions d’ajouts à un graphique déjà initialisé :
<ul>
<li><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/points.html"><code>points</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/matplot.html"><code>matpoints</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/lines.html"><code>lines</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/matplot.html"><code>matlines</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/abline.html"><code>abline</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/segments.html"><code>segments</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/arrows.html"><code>arrows</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/rect.html"><code>rect</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/polygon.html"><code>polygon</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/legend.html"><code>legend</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/text.html"><code>text</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/mtext.html"><code>mtext</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/title.html"><code>title</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/axis.html"><code>axis</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/box.html"><code>box</code></a>, <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqline</code></a>, etc.;</li>
<li><code>matplot</code>, <code>barplot</code>, <code>hist</code>, <code>boxplot</code>, <code>curve</code> avec l’argument <code>add = TRUE</code>.</li>
</ul></li>
</ul></li>
</ol>
<p><strong>Arguments et paramètres graphiques</strong> <span class="math inline">\(\Rightarrow\)</span> mise en forme et annotations</p>
</div>
<div id="fonction-plot" class="section level5">
<h5>Fonction <code>plot</code></h5>

<ul>
<li><strong>Fonction générique</strong> qui possède plusieurs <strong>méthodes</strong> :
<ul>
<li>Le comportement de <code>plot</code> dépend de la classe de l’objet assigné à son premier argument.</li>
</ul></li>
<li>Choix de <code>plot</code> = bon type de graphique à produire selon le nombre et la nature des variables.</li>
<li>Observations numériques de deux variables en entrée <span class="math inline">\(\Rightarrow\)</span> <strong>diagramme de dispersion</strong>.</li>
</ul>
</div>
<div id="autres-fonctions-de-création-dun-graphique" class="section level5">
<h5>Autres fonctions de création d’un graphique</h5>

<p><strong>Représentations d’une variable (observations stockées dans <code>x</code>)</strong> :</p>
<table>
<colgroup>
<col width="49%" />
<col width="30%" />
<col width="20%" />
</colgroup>
<thead>
<tr class="header">
<th>Type de graphique</th>
<th>Exemple d’appel de fonction</th>
<th>Type de <code>x</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://en.wikipedia.org/wiki/Pie_chart">diagramme en secteurs (<em>pie chart</em>)</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/pie.html"><code>pie</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/table.html"><code>table</code></a><code>(x), ...)</code></td>
<td>facteur</td>
</tr>
<tr class="even">
<td><a href="https://en.wikipedia.org/wiki/Bar_chart">diagramme à barres (<em>bar plot</em>)</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/barplot.html"><code>barplot</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/table.html"><code>table</code></a><code>(x), ...)</code></td>
<td>facteur</td>
</tr>
<tr class="odd">
<td><a href="https://en.wikipedia.org/wiki/Dot_plot_(statistics)">diagramme en points de Cleveland</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/dotchart.html"><code>dotchart</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/table.html"><code>table</code></a><code>(x), ...)</code></td>
<td>facteur</td>
</tr>
<tr class="even">
<td><a href="https://en.wikipedia.org/wiki/Histogram">histogramme</a></td>
<td><a href="http://stat.ethz.ch/R-manual/R-devel/library/graphics/html/hist.html"><code>hist</code></a><code>(x, ...)</code></td>
<td>vecteur numérique</td>
</tr>
<tr class="odd">
<td><a href="https://en.wikipedia.org/wiki/Kernel_density_estimation">courbe de densité à noyau (<em>kernel density plot</em>)</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.html"><code>plot</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/density.html"><code>density</code></a><code>(x), ...)</code> <span class="math inline">\(\rightarrow\)</span> méthode <a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/plot.density.html"><code>plot.density</code></a></td>
<td>vecteur numérique</td>
</tr>
<tr class="even">
<td><a href="https://en.wikipedia.org/wiki/Box_plot">diagramme en boîte (<em>boxplot</em>)</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/boxplot.html"><code>boxplot</code></a><code>(x, ...)</code></td>
<td>vecteur numérique</td>
</tr>
<tr class="odd">
<td><a href="https://fr.wikipedia.org/wiki/Diagramme_Quantile-Quantile">diagramme quantile-quantile théorique normal</a></td>
<td><a href="http://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqnorm</code></a><code>(x, ...)</code></td>
<td>vecteur numérique</td>
</tr>
</tbody>
</table>
<p><strong>Représentation d’une expression mathématique</strong> : <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/curve.html"><code>curve</code></a><code>(expr, ...)</code></p>
<p><strong>Représentations de deux variables (observations stockées dans <code>x</code> et <code>y</code>)</strong> :</p>
<table>
<colgroup>
<col width="32%" />
<col width="40%" />
<col width="13%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th>Type de graphique</th>
<th>Exemple d’appel de fonction</th>
<th>Type de <code>x</code></th>
<th>Type de <code>y</code></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://en.wikipedia.org/wiki/Bar_chart">diagramme à barres empilées ou groupées</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/barplot.html"><code>barplot</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/table.html"><code>table</code></a><code>(x, y), ...)</code> avec <code>beside = TRUE</code> pour barres groupées</td>
<td>facteur</td>
<td>facteur</td>
</tr>
<tr class="even">
<td><a href="https://en.wikipedia.org/wiki/Dot_plot_(statistics)">diagramme en points de Cleveland</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/dotchart.html"><code>dotchart</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/table.html"><code>table</code></a><code>(x, y), ...)</code></td>
<td>facteur</td>
<td>facteur</td>
</tr>
<tr class="odd">
<td><a href="https://en.wikipedia.org/wiki/Mosaic_plot">diagramme en mosaïque</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/mosaicplot.html"><code>mosaicplot</code></a><code>(</code><a href="https://stat.ethz.ch/R-manual/R-devel/library/base/html/table.html"><code>table</code></a><code>(x, y), ...)</code></td>
<td>facteur</td>
<td>facteur</td>
</tr>
<tr class="even">
<td><a href="https://en.wikipedia.org/wiki/Box_plot">diagrammes en boîte juxtaposés</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/boxplot.html"><code>boxplot</code></a><code>(y ~ x, ...)</code></td>
<td>facteur</td>
<td>vecteur numérique</td>
</tr>
<tr class="odd">
<td><a href="https://en.wikipedia.org/wiki/Scatter_plot">diagramme de dispersion (<em>scatterplot</em>)</a> ou <a href="https://en.wikipedia.org/wiki/Line_chart">en lignes (<em>line chart</em>)</a></td>
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.html"><code>plot</code></a><code>(x, y, ...)</code> <span class="math inline">\(\rightarrow\)</span> méthode <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.default.html"><code>plot.default</code></a></td>
<td>vecteur numérique</td>
<td>vecteur numérique</td>
</tr>
<tr class="even">
<td><a href="https://fr.wikipedia.org/wiki/Diagramme_Quantile-Quantile">diagramme quantile-quantile empirique</a></td>
<td><a href="http://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqplot</code></a><code>(x, y, ...)</code></td>
<td>vecteur numérique</td>
<td>vecteur numérique</td>
</tr>
</tbody>
</table>
<p><strong>Représentation de plus de trois variables numériques</strong> :</p>
<ul>
<li>matrice de diagrammes de dispersion : <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/pairs.html"><code>pairs</code></a><code>( ~ x + y + z, ...)</code></li>
<li>diagrammes de dispersion superposés : <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/matplot.html"><code>matplot</code></a><code>(matriceX, matriceY, ...)</code></li>
</ul>
</div>
<div id="arguments-et-paramètres-graphiques-1" class="section level5">
<h5>Arguments et paramètres graphiques</h5>

<ul>
<li>Arguments communs à plusieurs fonctions graphiques :
<ul>
<li>titre et noms d’axes : <code>main</code>, <code>sub</code>, <code>xlab</code>, <code>ylab</code>;</li>
<li>étendue numérique couverte : <code>xlim</code>, <code>ylim</code>;</li>
<li>type de représentation : <code>type</code>.</li>
</ul></li>
<li>Paramètres graphiques :
<ul>
<li>autour de la zone graphique : <code>ann</code>, <code>bty</code>;</li>
<li>style des éléments : <code>lty</code>, <code>lwd</code>, <code>pch</code>;</li>
<li>police de caractères : <code>font</code>, <code>font.main</code>, <code>font.sub</code>, <code>font.axis</code>, <code>font.lab</code>, <code>family</code>;</li>
<li>grosseur des éléments : <code>cex</code>, <code>cex.main</code>, <code>cex.sub</code>, <code>cex.axis</code>, <code>cex.lab</code>;</li>
<li>couleur des éléments : <code>col</code>, <code>col.main</code>, <code>col.sub</code>, <code>col.axis</code>, <code>col.lab</code>, <code>bg</code>;</li>
<li>argument de la fonction <code>par</code> uniquement :
<ul>
<li>disposition des graphiques : <code>mfrow</code> ou <code>mfcol</code>, <code>new</code>;</li>
<li>largeur des marges : <code>mar</code>, <code>oma</code>;</li>
<li>etc.</li>
</ul></li>
</ul></li>
</ul>
</div>
<div id="ajout-déléments-à-un-graphique-1" class="section level5">
<h5>Ajout d’éléments à un graphique</h5>

<table>
<thead>
<tr class="header">
<th><strong>Fonction(s) R</strong></th>
<th><strong>Élément(s) ajouté(s)</strong></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/points.html"><code>points</code></a> et <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/matplot.html"><code>matpoints</code></a></td>
<td>points selon des coordonnées</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/lines.html"><code>lines</code></a> et <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/matplot.html"><code>matlines</code></a></td>
<td>segments de droites reliant des points</td>
</tr>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/abline.html"><code>abline</code></a></td>
<td>droites traversant toute la zone graphique</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/segments.html"><code>segments</code></a></td>
<td>segments de droites entre des paires de coordonnées</td>
</tr>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/arrows.html"><code>arrows</code></a></td>
<td>flèches entre des paires de coordonnées</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/rect.html"><code>rect</code></a></td>
<td>rectangles</td>
</tr>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/polygon.html"><code>polygon</code></a></td>
<td>polygones quelconques</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/legend.html"><code>legend</code></a></td>
<td>légende</td>
</tr>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/text.html"><code>text</code></a></td>
<td>texte dans la zone graphique</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/mtext.html"><code>mtext</code></a></td>
<td>texte dans la marge</td>
</tr>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/title.html"><code>title</code></a></td>
<td>titre</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/axis.html"><code>axis</code></a></td>
<td>axe</td>
</tr>
<tr class="odd">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/box.html"><code>box</code></a></td>
<td>boîte autour de la zone graphique</td>
</tr>
<tr class="even">
<td><a href="https://stat.ethz.ch/R-manual/R-devel/library/stats/html/qqnorm.html"><code>qqline</code></a></td>
<td>ligne dans un graphique quantile-quantile théorique</td>
</tr>
</tbody>
</table>
</div>
<div id="exemple-de-code-avec-le-système-graphique-de-base" class="section level5">
<h5>Exemple de code avec le système graphique de base</h5>

<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb142-1" title="1"><span class="co"># Configuration de paramètres graphiques</span></a>
<a class="sourceLine" id="cb142-2" title="2">par.default &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="dt">bty=</span><span class="st">&quot;n&quot;</span>)</a>
<a class="sourceLine" id="cb142-3" title="3"><span class="co"># Initialisation du graphique</span></a>
<a class="sourceLine" id="cb142-4" title="4"><span class="kw">plot</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag, <span class="dt">y =</span> quakes<span class="op">$</span>stations, </a>
<a class="sourceLine" id="cb142-5" title="5">     <span class="dt">xlab =</span> <span class="st">&quot;magnitude du séisme&quot;</span>, </a>
<a class="sourceLine" id="cb142-6" title="6">     <span class="dt">ylab =</span> <span class="st">&quot;nombre de stations rapportant le séisme&quot;</span>,</a>
<a class="sourceLine" id="cb142-7" title="7">     <span class="dt">main =</span> <span class="st">&quot;1000 séismes près de Fidji&quot;</span>)</a>
<a class="sourceLine" id="cb142-8" title="8"><span class="co"># Ajout d&#39;une droite de régression</span></a>
<a class="sourceLine" id="cb142-9" title="9">lmout &lt;-<span class="st"> </span><span class="kw">lm</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> quakes) </a>
<a class="sourceLine" id="cb142-10" title="10"><span class="kw">abline</span>(lmout)</a>
<a class="sourceLine" id="cb142-11" title="11"><span class="co"># Réattribution des valeurs par défaut </span></a>
<a class="sourceLine" id="cb142-12" title="12"><span class="co"># aux paramètres graphiques</span></a>
<a class="sourceLine" id="cb142-13" title="13"><span class="kw">par</span>(par.default)</a></code></pre></div>
</div>
<div id="possibilités-graphiques-dans-le-r-de-base" class="section level5">
<h5>Possibilités graphiques dans le R de base</h5>

<p><strong>Annotations mathématiques</strong> :</p>
<ul>
<li>Utilisation de la fonction <code>expression</code> avec la syntaxe détaillée dans la <a href="https://stat.ethz.ch/R-manual/R-devel/library/grDevices/html/plotmath.html">fiche d’aide <code>plotmath</code></a> pour créer les valeurs attribuées aux arguments d’éléments textuels dans un graphique (ex. <code>main</code>, <code>xlab</code>, <code>ylab</code>, <code>labels</code>, <code>legend</code>, <code>text</code>, etc.).</li>
</ul>
<p><strong>Plusieurs graphiques dans une même fenêtre</strong> :<br />
division de la fenêtre en sous-fenêtres</p>
<ul>
<li>Sous-fenêtres de tailles égales : arguments <code>mfrow</code> ou <code>mfcol</code> de la fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/par.html"><code>par</code></a>,</li>
<li>Sous-fenêtres de tailles quelconques : fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/layout.html"><code>layout</code></a>.</li>
</ul>
</div>
<div id="aspects-techniques-des-graphiques-en-r" class="section level5">
<h5>Aspects techniques des graphiques en R</h5>

<ul>
<li><p><strong>Générer un graphique</strong> = soumettre le programme de création</p></li>
<li><p><strong>Fenêtre graphique</strong> :</p>
<ul>
<li>tous les graphiques sont créés dans la même fenêtre,</li>
<li>RStudio conserve un historique des graphiques produits,</li>
<li>une nouvelle fenêtre graphique s’ouvre avec la commande <code>windows()</code> (Windows), <code>quartz()</code> (Mac) ou <code>X11()</code> (Linux).</li>
</ul></li>
<li><p><strong>Enregistrer un graphique</strong> :</p>
<ul>
<li>par le menu de la fenêtre graphique ou</li>
<li>avec une fonction <code>bmp</code>, <code>postscript</code>, <code>pdf</code>, <code>png</code>, <code>tiff</code>, <code>svg</code> ou <code>jpeg</code>, selon le format désiré.</li>
</ul></li>
</ul>
<p>Pour fermer une connexion avec une fenêtre graphique ou un fichier<br />
<span class="math inline">\(\rightarrow\)</span> <code>dev.off()</code>.</p>
</div>
</div>
<div id="package-ggplot2-1" class="section level4">
<h4>Package <code>ggplot2</code></h4>

<p>Principes de base de la <strong>g</strong>rammaire <strong>g</strong>raphique :</p>
<p>Graphique statistique = représentation de <strong>données</strong>, dans un <strong>système de coordonnées</strong> spécifique, divisée en éléments de base :</p>
<ul>
<li><strong>éléments géométriques</strong> (<em>geoms</em>) : points, lignes, barres, etc.;</li>
<li><strong>propriétés visuelles</strong> (<em>aesthetics</em>) des éléments géométriques : axes, couleurs, formes, tailles, etc.</li>
<li><strong>transformations statistiques</strong>, si désiré : courbe de régression ou de lissage, région d’erreur, etc.</li>
</ul>
<p>Un graphique est spécifié en <strong>associant des variables</strong>, provenant des données, <strong>à des propriétés visuelles</strong> des éléments géométriques du graphique.</p>
<div id="survol-des-principales-fonctions-de-ggplot2" class="section level5">
<h5>Survol des principales fonctions de <code>ggplot2</code></h5>

<ul>
<li><a href="https://ggplot2.tidyverse.org/reference/ggplot.html"><code>ggplot</code></a> : initialisation d’un objet de classe <code>ggplot</code>;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/qplot.html"><code>qplot</code></a> : initialisation rapide (<code>q</code> pour <em>quick</em>) d’un objet <code>ggplot</code>;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/gg-add.html"><code>+</code></a> : opérateur pour l’ajout de couches ou la modification de configurations dans un objet <code>ggplot</code>;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html#section-layer-geoms">fonctions de type <code>geom_</code></a> (p. ex. <code>geom_point</code>, <code>geom_boxplot</code>, <code>geom_bar</code>, etc.) : spécification de couches à ajouter à un graphique;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/aes.html"><code>aes</code></a> : création d’un <code>mapping</code>, soit une association entre entre des propriétés visuelles et des variables;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/ggsave.html"><code>ggsave</code></a> : enregistrement d’un graphique.</li>
</ul>
<p><strong>Produire un graphique = afficher un objet <code>ggplot</code></strong></p>
<p>Gabarit minimaliste de code de création d’un graphique <code>ggplot2</code> :</p>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="kw">ggplot</span>(<span class="dt">data =</span> <span class="op">&lt;</span>DATA<span class="op">&gt;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb143-2" title="2"><span class="st">  </span><span class="er">&lt;</span>GEOM_FUNCTION<span class="op">&gt;</span>(<span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="op">&lt;</span>MAPPINGS<span class="op">&gt;</span>))</a></code></pre></div>
</div>
<div id="quelques-fonctions-de-type-geom_-1" class="section level5">
<h5>Quelques fonctions de type <code>geom_</code></h5>

<table>
<colgroup>
<col width="16%" />
<col width="29%" />
<col width="54%" />
</colgroup>
<thead>
<tr class="header">
<th>Fonction</th>
<th>Type de graphique</th>
<th>Élément(s) ajouté(s)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_point.html"><code>geom_point</code></a></td>
<td>diagramme de dispersion</td>
<td>points selon des coordonnées</td>
</tr>
<tr class="even">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_path.html"><code>geom_line</code></a></td>
<td>diagramme en lignes</td>
<td>segments de droites reliant des points</td>
</tr>
<tr class="odd">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_bar.html"><code>geom_bar</code></a></td>
<td>diagramme à barres</td>
<td>barres disjointes, de hauteurs spécifiées ou calculées = fréquences des niveaux d’un facteur</td>
</tr>
<tr class="even">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_histogram.html"><code>geom_histogram</code></a></td>
<td>histogramme</td>
<td>barres collées, de hauteurs calculées = fréquences d’observations d’une variable numérique tombant dans des intervalles joints (<em>bin</em>)</td>
</tr>
<tr class="odd">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_boxplot.html"><code>geom_boxplot</code></a></td>
<td>diagramme en boîte</td>
<td><em>boxplots</em></td>
</tr>
<tr class="even">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_density.html"><code>geom_density</code></a></td>
<td>courbe de densité à noyau</td>
<td>courbe de la densité estimée par noyau (<em>kernel density</em>)</td>
</tr>
<tr class="odd">
<td><a href="http://ggplot2.tidyverse.org/reference/geom_qq.html"><code>geom_qq</code></a></td>
<td>diagramme quantile-quantile théorique</td>
<td>points pour les couples de quantiles empiriques et théoriques</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\vdots\)</span></td>
<td>il en existe plusieurs autres</td>
<td>voir <a href="http://ggplot2.tidyverse.org/reference/" class="uri">http://ggplot2.tidyverse.org/reference/</a></td>
</tr>
</tbody>
</table>
<p>La plupart de ces fonctions cachent des transformations statistiques (p. ex. <code>geom_bar</code> et <code>geom_histogram</code> calculent des fréquences, <code>geom_boxplot</code> calcule des quantiles, <code>geom_density</code> estime une densité, etc.)</p>
</div>
<div id="quelques-autres-fonctions-de-ggplot2" class="section level5">
<h5>Quelques autres fonctions de <code>ggplot2</code></h5>

<p>Pour ajouter des couches ou modifier des configurations dans un objet <code>ggplot</code> initialisé :</p>
<ul>
<li>fonctions <a href="http://ggplot2.tidyverse.org/reference/labs.html"><code>labs</code>, <code>ggtitle</code>, <code>xlab</code>, <code>ylab</code></a> : ajouter un titre, modifier les noms d’axes;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html#section-coordinate-systems">fonctions de type <code>coord_</code></a> : modifier des configurations reliées au système de coordonnées;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html#section-facetting">fonctions de type <code>facet_</code></a> : créer des grilles de sous-graphiques
<ul>
<li>chacun des sous-graphiques est conditionnel à la valeur de facteurs(s), il représente donc seulement le sous-ensemble des observations ayant une modalité particulière pour ce(s) facteur(s);</li>
</ul></li>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html#section-scales">fonctions de type <code>scale_</code></a> : modifier les échelles de certaines propriétés visuelles (p. ex. couleurs, formes, tailles, etc.)</li>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html#section-themes">fonctions de type <code>theme_</code></a> : modifier des configurations reliées à l’apparence du graphique;</li>
<li><a href="https://ggplot2.tidyverse.org/reference/index.html#section-layer-stats">fonctions de type <code>stat_</code></a> : ajouts d’éléments tirés d’un calcul mathématique ou statistique.</li>
</ul>
</div>
<div id="exemple-de-code-avec-ggplot2" class="section level5">
<h5>Exemple de code avec <code>ggplot2</code></h5>

<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb144-1" title="1"><span class="co"># Chargement du package</span></a>
<a class="sourceLine" id="cb144-2" title="2"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb144-3" title="3"><span class="co"># Initialisation d&#39;un objet ggplot</span></a>
<a class="sourceLine" id="cb144-4" title="4">graph &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> quakes, <span class="dt">mapping =</span> <span class="kw">aes</span>(<span class="dt">x =</span> mag, <span class="dt">y =</span> stations)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb144-5" title="5"><span class="st">  </span><span class="co"># Ajout de points</span></a>
<a class="sourceLine" id="cb144-6" title="6"><span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb144-7" title="7"><span class="st">  </span><span class="co"># Ajout d&#39;un titre</span></a>
<a class="sourceLine" id="cb144-8" title="8"><span class="st">  </span><span class="kw">ggtitle</span>(<span class="dt">label =</span> <span class="st">&quot;1000 séismes près de Fidji&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb144-9" title="9"><span class="st">  </span><span class="co"># Ajout d&#39;une droite de régression</span></a>
<a class="sourceLine" id="cb144-10" title="10"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&#39;lm&#39;</span>)</a>
<a class="sourceLine" id="cb144-11" title="11"><span class="co"># Affichage du graphique</span></a>
<a class="sourceLine" id="cb144-12" title="12">graph</a></code></pre></div>
<hr />
</div>
</div>
</div>
<div id="références" class="section level1">
<h1>Références</h1>
<div id="système-de-base" class="section level4">
<h4>Système de base :</h4>

<ul>
<li><a href="http://www.statmethods.net/graphs/index.html" class="uri">http://www.statmethods.net/graphs/index.html</a></li>
<li><a href="http://www.statmethods.net/advgraphs/index.html" class="uri">http://www.statmethods.net/advgraphs/index.html</a></li>
<li>Murrell, P. (2011). R Graphics, Second Edition. CRC Press. URL pour le code R : <a href="https://www.stat.auckland.ac.nz/~paul/RG2e/" class="uri">https://www.stat.auckland.ac.nz/~paul/RG2e/</a></li>
<li>Feuilles de triche (cheat sheets) :
<ul>
<li><a href="http://www.joyce-robbins.com/wp-content/uploads/2016/04/BaseGraphicsCheatsheet.pdf" class="uri">http://www.joyce-robbins.com/wp-content/uploads/2016/04/BaseGraphicsCheatsheet.pdf</a></li>
<li>Paramètres graphiques : <a href="http://gastonsanchez.com/visually-enforced/resources/2015/09/22/R-cheat-sheet-graphical-parameters/" class="uri">http://gastonsanchez.com/visually-enforced/resources/2015/09/22/R-cheat-sheet-graphical-parameters/</a></li>
</ul></li>
</ul>
</div>
<div id="package-lattice-1" class="section level4">
<h4>Package <code>lattice</code> :</h4>

<ul>
<li>Page web sur le CRAN : <a href="https://CRAN.R-project.org/package=lattice" class="uri">https://CRAN.R-project.org/package=lattice</a></li>
<li>Documentation en ligne : <a href="http://lattice.r-forge.r-project.org/" class="uri">http://lattice.r-forge.r-project.org/</a></li>
<li>Sarkar, D. (2008). <em>Lattice: multivariate data visualization with R</em>. Springer Science &amp; Business Media. URL pour le code R : <a href="http://lmdvr.r-forge.r-project.org" class="uri">http://lmdvr.r-forge.r-project.org</a></li>
<li>Cleveland, W. S. (1993). <em>Visualizing data</em>. Hobart Press</li>
</ul>
</div>
<div id="package-ggplot2-2" class="section level4">
<h4>Package <code>ggplot2</code> :</h4>

<ul>
<li>Page web sur le CRAN : <a href="https://CRAN.R-project.org/package=ggplot2" class="uri">https://CRAN.R-project.org/package=ggplot2</a></li>
<li>Documentation en ligne : <a href="http://ggplot2.tidyverse.org/" class="uri">http://ggplot2.tidyverse.org/</a></li>
<li>Feuilles de triche (cheat sheets) :
<ul>
<li><a href="https://www.rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf" class="uri">https://www.rstudio.com/wp-content/uploads/2016/11/ggplot2-cheatsheet-2.1.pdf</a></li>
<li>traduction française de ce document : <a href="http://thinkr.fr/pdf/ggplot2-french-cheatsheet.pdf" class="uri">http://thinkr.fr/pdf/ggplot2-french-cheatsheet.pdf</a></li>
</ul></li>
<li>Flipbook : <a href="https://evamaerey.github.io/ggplot_flipbook/ggplot_flipbook_xaringan.html#1" class="uri">https://evamaerey.github.io/ggplot_flipbook/ggplot_flipbook_xaringan.html#1</a></li>
<li>Extensions de <code>ggplot2</code> : <a href="https://www.ggplot2-exts.org" class="uri">https://www.ggplot2-exts.org</a></li>
<li>Extension et tutoriel de la BBC : <a href="https://bbc.github.io/rcookbook/" class="uri">https://bbc.github.io/rcookbook/</a></li>
<li>Conseils pour améliorer nos graphiques, illutrés avec <code>ggplot2</code> : <a href="http://www.thinkingondata.com/6-tips-to-make-your-visualizations-look-professional/" class="uri">http://www.thinkingondata.com/6-tips-to-make-your-visualizations-look-professional/</a></li>
<li>Vidéos de Roger Peng concernant <code>ggplot2</code> :
<ul>
<li><a href="https://www.youtube.com/watch?v=HeqHMM4ziXA" class="uri">https://www.youtube.com/watch?v=HeqHMM4ziXA</a></li>
<li><a href="https://www.youtube.com/watch?v=n8kYa9vu1l8" class="uri">https://www.youtube.com/watch?v=n8kYa9vu1l8</a></li>
</ul></li>
<li>Livres :
<ul>
<li>Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis, Second Edition. Springer. URL pour le code R : <a href="https://github.com/hadley/ggplot2-book" class="uri">https://github.com/hadley/ggplot2-book</a></li>
<li>Wickham, H. et Grolemund, G. (2016). R for Data Science. O’Reilly Media, Inc. Chapitre 3. URL <a href="https://r4ds.had.co.nz/data-visualisation.html" class="uri">https://r4ds.had.co.nz/data-visualisation.html</a></li>
<li>Wilkinson, L. (2005). <em>The grammar of graphics</em>, Second Edition. Springer.</li>
<li>Chang, W. (2012). R Graphics Cookbook: Practical Recipes for Visualizing Data. O’Reilly Media, Inc. URL pour le code R : <a href="http://www.cookbook-r.com/Graphs/" class="uri">http://www.cookbook-r.com/Graphs/</a></li>
</ul></li>
<li>Tutoriels, rédigés par d’anciens étudiants du cours :
<ul>
<li>Boxplot : <a href="https://stt4230.rbind.io/tutoriels_etudiants/hiver_2015/boxplot_ggplot2/" class="uri">https://stt4230.rbind.io/tutoriels_etudiants/hiver_2015/boxplot_ggplot2/</a></li>
<li>Graphique de série temporelle :<br />
<a href="https://stt4230.rbind.io/tutoriels_etudiants/hiver_2015/graphique_temporel_ggplot2/" class="uri">https://stt4230.rbind.io/tutoriels_etudiants/hiver_2015/graphique_temporel_ggplot2/</a></li>
<li>Histogramme et courbe de densité de Kernel :<br />
<a href="https://stt4230.rbind.io/tutoriels_etudiants/hiver_2015/histogramme_ggplot2/" class="uri">https://stt4230.rbind.io/tutoriels_etudiants/hiver_2015/histogramme_ggplot2/</a></li>
<li>Diagramme à barres : <a href="https://stt4230.rbind.io/tutoriels_etudiants/hiver_2015/diagramme_batons_ggplot2/" class="uri">https://stt4230.rbind.io/tutoriels_etudiants/hiver_2015/diagramme_batons_ggplot2/</a></li>
</ul></li>
</ul>
</div>
<div id="références-non-propres-à-un-seul-système-graphique" class="section level4">
<h4>Références non propres à un seul système graphique</h4>

<ul>
<li>Revue des packages R ajoutant de nouvelles possibilités graphiques à R : <a href="https://CRAN.R-project.org/view=Graphics" class="uri">https://CRAN.R-project.org/view=Graphics</a></li>
<li>Référence concernant les couleurs en R : <a href="http://research.stowers.org/mcm/efg/R/Color/Chart/" class="uri">http://research.stowers.org/mcm/efg/R/Color/Chart/</a></li>
<li>Exemples de graphiques (tous systèmes, mais beaucoup de <code>ggplot2</code>) avec leur code source permettant de les reproduire: <a href="http://www.r-graph-gallery.com/" class="uri">http://www.r-graph-gallery.com/</a></li>
<li>Tutoriel en ligne sur la visualisation de données en R par Dianne Cook : <a href="https://github.com/dicook/useR2019_highd_vis" class="uri">https://github.com/dicook/useR2019_highd_vis</a></li>
<li>Cours STAT:4580, Data Visualization and Data Technologies, University of Iowa, par Luke Tierney : <a href="https://homepage.divms.uiowa.edu/~luke/classes/STAT4580/index.html" class="uri">https://homepage.divms.uiowa.edu/~luke/classes/STAT4580/index.html</a></li>
<li>Wilke, C. O. (2019). Fundamentals of data visualization: a primer on making informative and compelling figures. O’Reilly Media. URL <a href="https://serialmentor.com/dataviz/" class="uri">https://serialmentor.com/dataviz/</a></li>
<li>Healy, K. (2018). Data visualization: a practical introduction. Princeton University Press. URL
<a href="https://socviz.co/" class="uri">https://socviz.co/</a></li>
<li>Site web fournissant de l’information à propos de différents types de graphique: <a href="https://datavizcatalogue.com/index.html" class="uri">https://datavizcatalogue.com/index.html</a></li>
<li>Site web qui guide dans le choix du graphique le plus approprié à réaliser en fonction de nos données et de l’information que nous souhaitons transmettre (avec exemple en R et Python) : <a href="https://www.data-to-viz.com/" class="uri">https://www.data-to-viz.com/</a></li>
<li>Conseil dans la création de graphiques :
<ul>
<li><a href="https://moz.com/blog/impactful-data-storytelling" class="uri">https://moz.com/blog/impactful-data-storytelling</a></li>
<li><a href="https://chart.guide/design/" class="uri">https://chart.guide/design/</a></li>
</ul></li>
</ul>
<hr />
</div>
</div>
<div id="annexe" class="section level1">
<h1>Annexe</h1>
<div id="graphiques-produits-par-plot-selon-les-types-dobjets-donnés-en-entrée-aux-arguments-x-et-y" class="section level2">
<h2>Graphiques produits par <code>plot</code> selon les types d’objets donnés en entrée aux arguments <code>x</code> et <code>y</code></h2>
<p>Voici quelques essais pour mieux comprendre la fonction <code>plot</code>. Appelons la fonction en lui fournissant en entrée des arguments <code>x</code> et <code>y</code> de différentes classes et observons le résultat. Les données <code>quakes</code> sont utilisées ici.</p>
<div id="un-seul-vecteur-numérique" class="section level4">
<h4>Un seul vecteur numérique</h4>

<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1"><span class="kw">plot</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/plot1vecteur-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si seulement un vecteur est fourni en entrée, en argument <code>x</code>, et qu’aucun argument <code>y</code> n’est fourni, alors les observations contenues dans le vecteur sont placées sur l’axe des y (ordonnées), et les entiers <code>1</code> à <code>length(x)</code> sont placés sur l’axe des x (abscisses). C’est la méthode <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.default.html"><code>plot.default</code></a> qui a tracé ce graphique.</p>
</div>
<div id="deux-vecteurs-numériques" class="section level4">
<h4>Deux vecteurs numériques</h4>

<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb146-1" title="1"><span class="kw">plot</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag, <span class="dt">y =</span> quakes<span class="op">$</span>stations)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-157-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Un diagramme de dispersion est produit, encore par la méthode <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.default.html"><code>plot.default</code></a>.</p>
</div>
<div id="un-seul-facteur" class="section level4">
<h4>Un seul facteur</h4>

<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1"><span class="kw">plot</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag_catego)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/plot1facteur-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si seulement un facteur est fourni en entrée, un diagramme à barres est produit. La fonction générique <code>plot</code> a commencé par envoyer les arguments qu’elle a reçus à la méthode <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.factor.html"><code>plot.factor</code></a> parce que la classe de l’argument <code>x</code> fourni en entrée était <code>factor</code>. Ensuite, la méthode <code>plot.factor</code> a choisi d’appeler la fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/barplot.html"><code>barplot</code></a>, parce qu’aucun argument <code>y</code> n’a été fourni. En fait, ce sont les fréquences des niveaux du facteur (<code>table(x)</code>) qui sont données comme premier argument à <code>barplot</code>.</p>
<p>Ainsi, les arguments acceptés par la fonction générique <code>plot</code> lorsqu’elle reçoit en entrée comme premier argument (<code>x</code>) un facteur sans recevoir d’argument <code>y</code> sont les arguments acceptés par la fonction <code>barplot</code>. Par exemple, nous pourrions produire un diagramme à barres horizontales comme suit.</p>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb148-1" title="1"><span class="kw">plot</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag_catego, <span class="dt">horiz =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-158-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="un-facteur-et-un-vecteur-numérique" class="section level4">
<h4>Un facteur et un vecteur numérique</h4>

<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1"><span class="kw">plot</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag_catego, <span class="dt">y =</span> quakes<span class="op">$</span>stations)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/plot1facteur1vecteur-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si un vecteur numérique est fourni en argument <code>y</code>, avec le facteur fourni en <code>x</code>, la méthode <code>plot.factor</code> choisit d’appeler la fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/boxplot.html"><code>boxplot</code></a> pour produire des boxplots de la variable <code>y</code> pour chacun des niveaux de la variable <code>x</code>.</p>
</div>
<div id="deux-facteurs" class="section level4">
<h4>Deux facteurs</h4>

<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb150-1" title="1"><span class="kw">plot</span>(<span class="dt">x =</span> quakes<span class="op">$</span>mag_catego, <span class="dt">y =</span> quakes<span class="op">$</span>region)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/plot2facteurs-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si deux facteurs sont fournis en entrée, la méthode <code>plot.factor</code> choisit d’appeler la fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/spineplot.html"><code>spineplot</code></a>. Elle produit un type particulier de diagramme en mosaïque, nommé en anglais <em>spineplot</em>.</p>
</div>
<div id="data-frame-à-plus-de-2-variables-contenant-des-valeurs-numériques-ou-transformables-en-valeurs-numériques" class="section level4">
<h4>Data frame à plus de 2 variables contenant des valeurs numériques ou transformables en valeurs numériques</h4>

<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1"><span class="co"># Utilisation du data frame quakes original, sans les deux facteurs ajoutés</span></a>
<a class="sourceLine" id="cb151-2" title="2"><span class="kw">plot</span>(datasets<span class="op">::</span>quakes)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-159-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si un data frame est fourni en entrée à la fonction générique <code>plot</code>, elle délègue son travail à la méthode <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.dataframe.html"><code>plot.data.frame</code></a>. Si ce data frame possède plus de 2 variables contenant des valeurs numériques (ou transformables en valeurs numériques), alors la méthode <code>plot.data.frame</code> choisit d’appeler la fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/pairs.html"><code>pairs</code></a>. Celle-ci produit une matrice de diagramme de dispersion.</p>
</div>
<div id="data-frame-à-2-variables" class="section level4">
<h4>Data frame à 2 variables</h4>

<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb152-1" title="1"><span class="kw">plot</span>(quakes[, <span class="kw">c</span>(<span class="st">&quot;mag&quot;</span>, <span class="st">&quot;stations&quot;</span>)])</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-160-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si un data frame contenant seulement 2 variables est fourni en entré à <code>plot</code>, la méthode <code>plot.data.frame</code> évalue le type des données dans ces variables. Si les deux variables contiennent des valeurs numériques, la méthode <code>plot.default</code> est appelée pour produire un seul diagramme de dispersion. Les observations dans la première colonne sont placées sur l’axe des x et celle de la deuxième colonne sur l’axe des y.</p>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1"><span class="kw">plot</span>(quakes[, <span class="kw">c</span>(<span class="st">&quot;mag_catego&quot;</span>, <span class="st">&quot;stations&quot;</span>)])</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-161-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si la première colonne est un facteur, des boxplots des observations dans la deuxième colonne, par niveaux du facteur dans le première colonne, sont produits avec la fonction <code>boxplot</code>.</p>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb154-1" title="1"><span class="kw">plot</span>(quakes[, <span class="kw">c</span>(<span class="st">&quot;mag_catego&quot;</span>, <span class="st">&quot;region&quot;</span>)])</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-162-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si les deux variables sont des facteurs, <code>plot.data.frame</code> se comporte alors comme <code>plot.factor</code> lorsqu’il reçoit deux facteurs.</p>
</div>
<div id="data-frame-à-une-colonne" class="section level4">
<h4>Data frame à une colonne</h4>

<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1"><span class="kw">plot</span>(quakes[, <span class="st">&quot;mag&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>])</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-163-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si un data frame à seulement une colonne est fourni à <code>plot</code> et que cette colonne contient des observations numériques, un diagramme de dispersion à une dimension est produit, en appelant la fonction <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/stripchart.html"><code>stripchart</code></a>.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1"><span class="kw">plot</span>(quakes[, <span class="st">&quot;mag_catego&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>])</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-164-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si la colonne contient plutôt un facteur, c’est un diagramme à barres qui est produit par la fonction <code>barplot</code>.</p>
<p><strong>Remarque</strong> : Sans l’argument <code>drop = FALSE</code> dans l’extraction d’une colonne de <code>quakes</code>, le résultat de l’extraction aurait été un vecteur ou un facteur (un objet à une dimension) plutôt qu’un data frame à une colonne.</p>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb157-1" title="1"><span class="kw">str</span>(quakes[, <span class="st">&quot;mag_catego&quot;</span>])</a></code></pre></div>
<pre><code>##  Factor w/ 3 levels &quot;4&quot;,&quot;5&quot;,&quot;6&quot;: 1 1 2 1 1 1 1 1 1 1 ...</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1"><span class="kw">str</span>(quakes[, <span class="st">&quot;mag_catego&quot;</span>, <span class="dt">drop =</span> <span class="ot">FALSE</span>])</a></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    1000 obs. of  1 variable:
##  $ mag_catego: Factor w/ 3 levels &quot;4&quot;,&quot;5&quot;,&quot;6&quot;: 1 1 2 1 1 1 1 1 1 1 ...</code></pre>
</div>
<div id="formule-en-entrée" class="section level4">
<h4>Formule en entrée</h4>

<p>La méthode <code>plot</code> accepte aussi une formule en entrée, auquel cas la méthode <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/plot.formula.html"><code>plot.formula</code></a> est appelée. La méthode <code>plot.formula</code> est très versatile. La variable que nous lui fournissons dans la partie de gauche de la formule (à gauche de <code>~</code>) est celle positionnée sur l’axe des y. La variable que nous lui fournissons dans la partie de droite de la formule est celle positionnée sur l’axe des x.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1"><span class="kw">plot</span>(stations <span class="op">~</span><span class="st"> </span>mag, <span class="dt">data =</span> quakes)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-167-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si les deux variables sont numériques, un diagramme de dispersion est produit. Mais si la variable à droite est un facteur, des boxplots de la variable dans la partie de gauche de la formule, par niveau de ce facteur, sont produits.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1"><span class="kw">plot</span>(stations <span class="op">~</span><span class="st"> </span>mag_catego, <span class="dt">data =</span> quakes)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-168-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si les deux variables sont des facteurs, un diagramme en mosaïque est produit.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb163-1" title="1"><span class="kw">plot</span>(region <span class="op">~</span><span class="st"> </span>mag_catego, <span class="dt">data =</span> quakes)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-169-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Nous pouvons aussi spécifier seulement une variable dans la formule. Par exemple, avec une seule variable dans la partie de droite de la formule (rien dans la partie de gauche de la formule), nous obtenons le même résultat qu’en fournissant un data frame à une colonne à la fonction générique <code>plot</code>.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb164-1" title="1"><span class="kw">plot</span>(<span class="op">~</span><span class="st"> </span>stations, <span class="dt">data =</span> quakes)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-170-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>En plaçant plutôt l’unique variable dans la partie de gauche de la formule, avec la valeur 1 dans la partie de droite, nous obtenons le même résultat qu’en fournissant un seul vecteur ou facteur à la fonction générique <code>plot</code>.</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb165-1" title="1"><span class="kw">plot</span>(stations <span class="op">~</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">data =</span> quakes)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-171-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Si la formule contient une variable dans la partie de gauche et plus d’une variable dans la partie de droite, plus d’un graphique est produit.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb166-1" title="1"><span class="kw">plot</span>(stations <span class="op">~</span><span class="st"> </span>mag <span class="op">+</span><span class="st"> </span>mag_catego, <span class="dt">data =</span> quakes)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-172-1.png" width="100%" style="display: block; margin: auto;" /><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-172-2.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Mais si la formule ne contient pas de variable dans la partie de gauche et plus de deux variables dans la partie de droite, une matrice de diagrammes de dispersion est produite.</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb167-1" title="1"><span class="kw">plot</span>(<span class="op">~</span><span class="st"> </span>lat <span class="op">+</span><span class="st"> </span>long <span class="op">+</span><span class="st"> </span>depth <span class="op">+</span><span class="st"> </span>mag <span class="op">+</span><span class="st"> </span>stations, <span class="dt">data =</span> quakes)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-173-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Bref, la méthode <code>plot.formula</code> fait appel à une des autres méthodes vues jusqu’à maintenant, en fonction de la position et de la nature (vecteur numérique ou facteur) des variables dans la formule.</p>
</div>
<div id="fonction-en-entrée" class="section level4">
<h4>Fonction en entrée</h4>

<p>Il y a en R plusieurs fonctions prenant comme premier argument un vecteur numérique et retournant un vecteur de valeurs numériques, par exemple les fonctions R de type mathématique <code>abs</code>, <code>srqt</code>, <code>exp</code>, <code>log</code>, <code>sin</code>, <code>cos</code>, etc. Ce sont en quelque sorte des représentations de fonctions mathématiques d’une variable. La fonction générique <code>plot</code> peut tracer ces fonctions, grâce à sa méthode <a href="https://stat.ethz.ch/R-manual/R-devel/library/graphics/html/curve.html"><code>plot.function</code></a>, après avoir évalué leurs valeurs en certains points.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb168-1" title="1"><span class="kw">plot</span>(exp)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-174-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>Par défaut, elle fait une évaluation de la valeur de la fonction en 101 points également répartis entre 0 et 1. Il est possible de modifier ces points grâce aux arguments <code>from</code>, <code>to</code> et <code>n</code> (une séquence de points est créée avec la fonction <code>seq</code>).</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb169-1" title="1"><span class="kw">plot</span>(exp, <span class="dt">from =</span> <span class="dv">-4</span>, <span class="dt">to =</span> <span class="dv">4</span>, <span class="dt">n =</span> <span class="dv">501</span>)</a></code></pre></div>
<p><img src="/communication_resultats/graphiques_r_2020_files/figure-html/unnamed-chunk-175-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>En fait, la méthode <code>plot.function</code> appelle la fonction <code>curve</code>.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol>
<li id="fn1"><p>Anscombe, F.J. (1973). Graphs in Statistical Analysis. <em>The American Statistician</em>, <strong>27</strong>(1). pp. 17-21.<a href="#fnref1" class="footnote-back">↩</a></p></li>
<li id="fn2"><p>Matejka, J. et Fitzmaurice, G. (2017, Mai). Same Stats, Different Graphs: Generating Datasets with Varied Appearance and Identical Statistics through Simulated Annealing. <em>Proceedings of the 2017 CHI Conference on Human Factors in Computing Systems</em>. ACM. pp. 1290-1294. URL : <a href="https://www.autodeskresearch.com/publications/samestats" class="uri">https://www.autodeskresearch.com/publications/samestats</a><a href="#fnref2" class="footnote-back">↩</a></p></li>
<li id="fn3"><p>Kozak, M. (2002). Watch out for superman: first visualize, then analyze. <em>IEEE Computer Graphics and Applications</em>. <strong>32</strong>(3), pp. 6–9.<a href="#fnref3" class="footnote-back">↩</a></p></li>
<li id="fn4"><p><a href="http://www.theanalyticslab.nl/2017/03/18/python-r-vs-spss-sas/" class="uri">http://www.theanalyticslab.nl/2017/03/18/python-r-vs-spss-sas/</a><a href="#fnref4" class="footnote-back">↩</a></p></li>
<li id="fn5"><p><a href="https://www.datacamp.com/community/tutorials/r-or-python-for-data-analysis" class="uri">https://www.datacamp.com/community/tutorials/r-or-python-for-data-analysis</a><a href="#fnref5" class="footnote-back">↩</a></p></li>
<li id="fn6"><p>Ce graphique est une adaptation d’un graphique sur la page web suivante :<br />
<a href="http://www.statmethods.net/graphs/line.html" class="uri">http://www.statmethods.net/graphs/line.html</a>.<a href="#fnref6" class="footnote-back">↩</a></p></li>
<li id="fn7"><p>Ce graphique est une adaptation d’un graphique sur la page web suivante :<br />
<a href="http://www.sthda.com/french/wiki/les-differents-types-de-traits-dans-r-lty" class="uri">http://www.sthda.com/french/wiki/les-differents-types-de-traits-dans-r-lty</a><a href="#fnref7" class="footnote-back">↩</a></p></li>
<li id="fn8"><p>Ce graphique est une adaptation d’un graphique sur la page web suivante :<br />
<a href="http://www.sthda.com/french/wiki/les-differents-types-de-points-dans-r-comment-utiliser-pch" class="uri">http://www.sthda.com/french/wiki/les-differents-types-de-points-dans-r-comment-utiliser-pch</a><a href="#fnref8" class="footnote-back">↩</a></p></li>
<li id="fn9"><p><a href="https://chichacha.netlify.com/2019/09/08/mysterious-colour-names-in-r/" class="uri">https://chichacha.netlify.com/2019/09/08/mysterious-colour-names-in-r/</a><a href="#fnref9" class="footnote-back">↩</a></p></li>
<li id="fn10"><p>Ce graphique a été produit grâce à un code R partagé sur la page web suivante : <a href="https://github.com/EarlGlynn/colorchart/wiki/Color-Chart-in-R" class="uri">https://github.com/EarlGlynn/colorchart/wiki/Color-Chart-in-R</a><a href="#fnref10" class="footnote-back">↩</a></p></li>
<li id="fn11"><p><a href="https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf" class="uri">https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf</a><a href="#fnref11" class="footnote-back">↩</a></p></li>
<li id="fn12"><p><a href="http://r4ds.had.co.nz/data-visualisation.html#a-graphing-template" class="uri">http://r4ds.had.co.nz/data-visualisation.html#a-graphing-template</a><a href="#fnref12" class="footnote-back">↩</a></p></li>
<li id="fn13"><p><a href="https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf" class="uri">https://github.com/rstudio/cheatsheets/blob/master/data-visualization-2.1.pdf</a><a href="#fnref13" class="footnote-back">↩</a></p></li>
<li id="fn14"><p><a href="http://seananderson.ca/ggplot2-FISH554/" class="uri">http://seananderson.ca/ggplot2-FISH554/</a><a href="#fnref14" class="footnote-back">↩</a></p></li>
<li id="fn15"><p><a href="https://serialmentor.com/dataviz/no-3d.html" class="uri">https://serialmentor.com/dataviz/no-3d.html</a><a href="#fnref15" class="footnote-back">↩</a></p></li>
</ol>
</div>

---
title: "Rédaction de documents en R Markdown"
linkTitle: "R Markdown"
author: "Sophie Baillargeon, Université Laval"
date: "2020-02-16"
weight: 2
slug: "redaction_r_markdown"
categories: ["cours_2020-02-25"]
categories_weight: 1
lastmodifierdisplayname : "Sophie Baillargeon"
lastmodifieremail: "sophie.baillargeon@mat.ulaval.ca"
output:
  pdf_document:
    toc: yes
    toc_depth: 3
    highlight: tango
  blogdown::html_page:
    toc: yes
    toc_depth: 3
    highlight: tango
header-includes:
- \usepackage[french]{babel}
- \frenchbsetup{StandardLayout}
- \hypersetup{colorlinks=true, urlcolor = {blue}, linkcolor = {blue}}
- \renewcommand{\linethickness}{0.05em}
editor_options: 
  chunk_output_type: console
---





<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  { background-color: #f8f8f8; }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #c4a000; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #000000; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #000000; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #000000; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a><ul>
<li><a href="#logiciels-de-type-wysiwym">Logiciels de type WYSIWYM</a></li>
<li><a href="#recherche-reproductible-et-programmation-lettrée">Recherche reproductible et programmation lettrée</a></li>
<li><a href="#sweave-et-knitr"><code>Sweave</code> et <code>knitr</code></a></li>
</ul></li>
<li><a href="#r-markdown">R Markdown</a><ul>
<li><a href="#création-dun-document-r-markdown-en-rsudio">Création d’un document R Markdown en RSudio</a></li>
<li><a href="#syntaxe-markdown">Syntaxe Markdown</a></li>
<li><a href="#compilation-de-fichier-r-markdown-en-rstudio">Compilation de fichier R Markdown en RStudio</a></li>
<li><a href="#blocs-de-code-r">Blocs de code R</a></li>
<li><a href="#commande-r-intégrée-à-un-bout-de-texte-inline">Commande R intégrée à un bout de texte (<em>inline</em>)</a></li>
<li><a href="#intégration-de-figures">Intégration de figures</a></li>
<li><a href="#intégration-de-tableaux">Intégration de tableaux</a></li>
<li><a href="#trucs-divers-dans-lédition-de-documents-r-markdown">Trucs divers dans l’édition de documents R Markdown</a></li>
</ul></li>
<li><a href="#références">Références</a></li>
</ul>
</div>

<!--
Source d'info :
http://rmarkdown.rstudio.com/articles_verbatim2.html
-->
<hr />
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Pour rédiger un document destiné à être publié (rapport, article, mémoire, thèse, etc.), plusieurs outils s’offrent à nous. En science, deux des outils les plus utilisés pour la création de documents sont :</p>
<ul>
<li>Word,</li>
<li>LaTeX.</li>
</ul>
<p>Voyons d’abord la distinction entre ces deux outils.</p>
<div id="word" class="section level4">
<h4>Word :</h4>

<p>En Word, <strong>le contenu et la mise en forme du document ne font qu’un</strong>. Le fichier dans lequel nous travaillons pour créer le document est directement le document final.</p>
<p>En anglais, ce logiciel est dit de type <strong>WYSIWYG</strong>. Cet acronyme signifie <em><strong>W</strong>hat <strong>Y</strong>ou <strong>S</strong>ee <strong>I</strong>s <strong>W</strong>hat <strong>Y</strong>ou <strong>G</strong>et</em>.</p>
</div>
<div id="latex" class="section level4">
<h4>LaTeX :</h4>

<p>Avec LaTeX, <strong>le contenu est dissocié de la mise en forme</strong>. Le fichier dans lequel nous travaillons, portant l’extension .tex, n’est pas le document final. Nous devons compiler le fichier .tex afin d’obtenir ce document final (.pdf ou autre). Le fichier .tex contient le texte du document, soit le contenu, mais aussi des tags pour la mise en forme. Par exemple, il y a des tags pour changer de sections, modifier la police de caractères, inclure une liste, un tableau ou une figure, etc.</p>
<p>En anglais, ce logiciel est dit de type <strong>WYSIWYM</strong>. Cet acronyme signifie <em><strong>W</strong>hat <strong>Y</strong>ou <strong>S</strong>ee <strong>I</strong>s <strong>W</strong>hat <strong>Y</strong>ou <strong>M</strong>ean</em>.</p>
</div>
<div id="logiciels-de-type-wysiwym" class="section level2">
<h2>Logiciels de type WYSIWYM</h2>
<p>Avec les logiciels de type WYSIWYM, un document se crée en :</p>
<ul>
<li>éditant un fichier source, puis en</li>
<li>compilant le fichier source pour obtenir le document final.</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-2"></span>
<img src="fig/WYSIWYM.png" alt="Production de documents avec un logiciel de type WYSIWYM" width="45%" />
<p class="caption">
Figure 1: Production de documents avec un logiciel de type WYSIWYM
</p>
</div>
<div id="utilisation-de-latex" class="section level4">
<h4>Utilisation de LaTeX :</h4>

<p>En fait, LaTeX est un <strong>langage de composition de documents</strong>. Afin de créer un document en utilisant ce langage, nous avons besoin de :</p>
<ul>
<li>un <strong>éditeur LaTeX</strong> (un éditeur de texte fait aussi l’affaire, mais les fonctionnalités offertes par un éditeur LaTeX facilitent le travail de l’utilisateur) :
<ul>
<li>TeXstudio (multiplateforme, gratuit) : <a href="http://texstudio.sourceforge.net/" class="uri">http://texstudio.sourceforge.net/</a>,</li>
<li>Overleaf (en ligne, facilite le travail collaboratif) : <a href="https://www.overleaf.com/" class="uri">https://www.overleaf.com/</a></li>
<li>ou autre : <a href="https://en.wikipedia.org/wiki/Comparison_of_TeX_editors" class="uri">https://en.wikipedia.org/wiki/Comparison_of_TeX_editors</a>.</li>
</ul></li>
<li>un <strong>compilateur LaTeX</strong> :
<ul>
<li>MiKTeX (Windows, gratuit) : <a href="http://miktex.org/" class="uri">http://miktex.org/</a>,</li>
<li>ou autre : <a href="https://www.overleaf.com/learn/latex/Choosing_a_LaTeX_Compiler" class="uri">https://www.overleaf.com/learn/latex/Choosing_a_LaTeX_Compiler</a>.</li>
</ul></li>
</ul>
</div>
<div id="markdown" class="section level4">
<h4>Markdown :</h4>

<p>Markdown est un langage simple de composition de documents en format HTML (interprétable par un navigateur web). Il s’agit donc d’un outil permettant de créer des pages web sans avoir à connaître le langage HTML.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-3"></span>
<img src="fig/Markdown.png" alt="Production de documents avec Markdown" width="45%" />
<p class="caption">
Figure 2: Production de documents avec Markdown
</p>
</div>
<p>Markdown offre moins de possibilités de mise en forme que LaTeX, mais il est plus simple à apprendre et à utiliser.</p>
</div>
</div>
<div id="recherche-reproductible-et-programmation-lettrée" class="section level2">
<h2>Recherche reproductible et programmation lettrée</h2>
<div id="recherche-reproductible" class="section level4">
<h4>Recherche reproductible :</h4>

<p>La recherche reproductible (en anglais <em>reproducible research</em>) est un courant en recherche qui prône le partage de données et de programmes informatiques en accompagnement de publications scientifiques faisant intervenir de l’analyse de données. Le but de ce partage est de <strong>permettre à tout lecteur de reproduire par lui-même les résultats publiés</strong>. Ainsi, la publication est plus facile à comprendre, les résultats peuvent être vérifiés et la poursuite des travaux est facilitée. La recherche devrait en ressortir accélérée.</p>
<div id="programmation-lettrée" class="section level5">
<h5>Programmation lettrée :</h5>

<p>La programmation lettrée (en anglais <em>literate programming</em>) est une approche de programmation dans laquelle le code n’est pas simplement documenté par quelques commentaires. Du texte expliquant ce que le code doit produire est entrelacé avec le code, à l’intérieur du même document. Pour que ce texte explicatif soit clair, il devrait pouvoir inclure toutes sortes d’éléments usuels dans des documents textuels, tels que des listes, des tableaux, des images, etc. Il n’est pas facile d’inclure de tels éléments dans des commentaires à l’intérieur d’un script. En programmation lettrée, le document de travail devient donc principalement un document texte, mais celui-ci contient des bouts de code bien identifiés en étant encadrés par des tags. Et il existe une façon de soumettre facilement ce code.</p>
<p>En fin de compte, le principe de programmation lettrée devient en quelque sorte de la rédaction de <strong>documents combinant du texte et des bouts de code informatique</strong>. Il s’agit d’une façon de mettre en oeuvre de la recherche reproductible. C’est aussi une façon productive de rédiger des documents devant contenir des bouts de code et/ou des sorties informatiques. En effet, le document contenant le « programme lettré » peut être compilé afin de générer un autre document qui lui peut afficher, pour chaque bout de code :</p>
<ul>
<li>seulement le code ou</li>
<li>le code et les sorties informatiques qu’il produit lorsqu’il est soumis (par exemple un affichage texte comme dans une console, ou encore un graphique) ou</li>
<li>seulement les sorties informatiques ou</li>
<li>rien du tout.</li>
</ul>
<p>Cette approche est très utile pour rédiger un <strong>guide d’utilisation d’un langage informatique</strong>. Par exemple, j’ai utilisé R Markdown, un outil de programmation lettrée, pour rédiger le document que vous êtes en train de lire, ainsi que toutes les autres notes du cours STT-4230/STT-6230 R pour scientifique publiées sur le site web <a href="https://stt4230.rbind.io/" class="uri">https://stt4230.rbind.io/</a>.</p>
<p>Une autre utilité de cette approche est la rédaction facilitée de <strong>rapport d’analyse de données</strong>. Nous nous intéressons ici à une analyse de données effectuée en R, mais la programmation lettrée pourrait s’appliquer avec n’importe quel logiciel d’analyse de données fonctionnant avec du code informatique (plutôt que seulement avec une interface utilisateur composée de menus et de boutons cliquables). Avec un outil de programmation lettrée, il est facile de rédiger un rapport contenant du texte explicatif et des résultats d’analyse sous forme de sorties informatiques. Nul besoin de copier/coller des valeurs dans un tableau, ou d’insérer manuellement un graphique. Tout est fait automatiquement lors de la compilation du document. Ainsi, si les données changent ou si nous décidons de modifier une analyse, nous n’avons pas besoin d’effectuer manuellement les mises à jour dans les résultats. Nous avons seulement besoin de mettre à jour le code et de recompiler le rapport. Cette approche peut nous permettre de sauver beaucoup de temps et minimise les risques d’erreur dans les résultats rapportés.</p>
</div>
</div>
</div>
<div id="sweave-et-knitr" class="section level2">
<h2><code>Sweave</code> et <code>knitr</code></h2>
<p>En R, il est possible d’effectuer de la programmation lettrée avec la fonction <code>Sweave</code> (du package <code>utils</code>) ou avec le package <code>knitr</code>.</p>
<p>Ces packages permettent de créer des publications qui contiennent des <strong>bouts de code et/ou des sorties R</strong>, sans faire de copier/coller à partir d’un programme R ou de la console R.</p>
<div id="sweave" class="section level4">
<h4><code>Sweave</code> :</h4>

<p><code>Sweave</code> est le premier outil a avoir été développé pour faire de la programmation lettrée en R. Il permet d’intégrer du code R à des <strong>documents LaTeX</strong>.</p>
<p>Les tags encadrant les bouts de code R dans le fichier source acceptent des options permettant de contrôler :</p>
<ul>
<li>ce qui doit être compilé ou non,</li>
<li>ce qui doit être affiché ou non (code, sorties, figures),</li>
<li>la mise en forme de l’affichage.</li>
</ul>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-4"></span>
<img src="fig/Sweave.png" alt="Schéma de compilation avec Sweave" width="50%" />
<p class="caption">
Figure 3: Schéma de compilation avec Sweave
</p>
</div>
</div>
<div id="knitr" class="section level4">
<h4><code>knitr</code> :</h4>

<p><code>knitr</code> est une alternative à <code>Sweave</code>, plus récente et maintenant plus utilisée. Les options de mise en forme par défaut des éléments R intégrés au fichier LaTeX ne sont pas les mêmes avec <code>knitr</code> qu’avec <code>Sweave</code>.</p>
<p>De plus, <code>knitr</code> permet d’intégrer des éléments R à d’autres types de fichiers que LaTeX, notamment à des fichiers Markdown. C’est ce qui est appellé le <strong>R Markdown</strong>.</p>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-5"></span>
<img src="fig/RMarkdown.png" alt="Schéma de compilation avec R Markdown" width="50%" />
<p class="caption">
Figure 4: Schéma de compilation avec R Markdown
</p>
</div>
</div>
</div>
</div>
<div id="r-markdown" class="section level1">
<h1>R Markdown</h1>
<p><img src="fig/rmarkdown_wizards.png" width="80%" style="display: block; margin: auto;" /></p>
<p>Illustration de <span class="citation">@allison_horst</span> <a href="https://github.com/allisonhorst/stats-illustrations" class="uri">https://github.com/allisonhorst/stats-illustrations</a></p>
<div id="création-dun-document-r-markdown-en-rsudio" class="section level2">
<h2>Création d’un document R Markdown en RSudio</h2>
<p>Un bon outil pour rédiger et compiler des documents R Markdown est RStudio. Les instructions suivantes se rapportent à RStudio.</p>
<p>Nous pouvons créer un nouveau document R Markdown (extension .Rmd) par le menu :</p>
<ul>
<li>« File &gt; New File &gt; R Markdown… »</li>
</ul>
<p>Une fenêtre s’ouvre alors. Nous devons spécifier quelques informations à propos de notre fichier.</p>
<ol style="list-style-type: decimal">
<li>Le menu de gauche sert à indiquer quel <strong>type de produit final</strong> nous voulons créer :
<ul>
<li>un document,</li>
<li>une présentation,</li>
<li>un document avec composantes interactives (Shiny) ou</li>
<li>un document suivant un certain modèle prédéfini (p. ex. document GitHub ou vignette de package).</li>
</ul></li>
<li>Dans la partie de droite de la fenêtre, nous spécifions :
<ul>
<li>le titre du document,</li>
<li>le nom de l’auteur,</li>
<li>le format préféré pour le fichier final.</li>
</ul></li>
</ol>
<p>En cliquant sur OK, un fichier est créé. Il devrait avoir l’allure suivante :</p>
<div style="page-break-after: always;"></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-7"></span>
<img src="fig/ExempleDoc.png" alt="Exemple de nouveau document R Markdown" width="100%" />
<p class="caption">
Figure 5: Exemple de nouveau document R Markdown
</p>
</div>
<p>Il ne reste plus qu’à :</p>
<ol style="list-style-type: decimal">
<li><strong>enregistrer</strong> le fichier,</li>
<li><strong>éditer</strong> le fichier en respectant :
<ul>
<li>la syntaxe Markdown et</li>
<li>les noms d’options de <code>knitr</code> pour les bouts de code R,</li>
</ul></li>
<li><strong>compiler</strong> le fichier.</li>
</ol>
<div style="page-break-after: always;"></div>
<div id="formats-du-document-final" class="section level4">
<h4>Formats du document final :</h4>

<p>Bien qu’à l’origine Markdown ait été créé pour générer des documents HTML, nous pouvons maintenant l’utiliser pour générer des documents dans d’autres formats. Avec RStudio, il est facile de compiler un fichier Markdown ou R Markdown notamment dans les formats suivants, grâce à Pandoc (intégré à RStudio) :</p>
<ul>
<li>HTML,</li>
<li>PDF (à la condition d’avoir un compilateur LaTeX),</li>
<li>Word.</li>
</ul>
</div>
<div id="entête-dun-fichier-r-markdown" class="section level4">
<h4>Entête d’un fichier R Markdown :</h4>

<p>Un fichier R Markdown débute presque toujours par un entête entre les lignes :</p>
<pre><code>---</code></pre>
<p>et</p>
<pre><code>---</code></pre>
<p>Cet entête peut contenir des informations à inclure dans l’entête du document final, tel que :</p>
<ul>
<li>le titre du document,</li>
<li>le nom de l’auteur,</li>
<li>la date de publication du document.</li>
</ul>
<p>Cet entête peut aussi contenir des informations spécifiant le format et des options de mise en forme du document final. Ces options varient en fonction du format de sortie. Le site web suivant fourni de l’information sur les options possibles : <a href="http://rmarkdown.rstudio.com/formats.html" class="uri">http://rmarkdown.rstudio.com/formats.html</a></p>
</div>
</div>
<div id="syntaxe-markdown" class="section level2">
<h2>Syntaxe Markdown</h2>
<p>La syntaxe Markdown utilisée par R Markdown est la version Pandoc, documentée sur le site web suivant :</p>
<ul>
<li><a href="http://rmarkdown.rstudio.com/authoring_pandoc_markdown.html" class="uri">http://rmarkdown.rstudio.com/authoring_pandoc_markdown.html</a></li>
</ul>
<p>Les éléments de base de cette syntaxe sont bien présentés sur la page web suivante :</p>
<ul>
<li><a href="http://rmarkdown.rstudio.com/authoring_basics.html" class="uri">http://rmarkdown.rstudio.com/authoring_basics.html</a></li>
</ul>
<p>ainsi que dans une partie du document suivant :</p>
<ul>
<li><a href="https://github.com/rstudio/cheatsheets/blob/master/rmarkdown-2.0.pdf" class="uri">https://github.com/rstudio/cheatsheets/blob/master/rmarkdown-2.0.pdf</a></li>
</ul>
<p>(aussi disponible en RStudio via le menu « Help &gt; Cheatsheets &gt; R Markdown Cheat Sheet »).</p>
<p>Par exemple, pour mettre des caractères en italique, il suffit de les encadrer de <code>*</code> ou <code>_</code>. Ainsi, <code>*bonjour*</code> ou <code>_bonjour_</code> dans un fichier source R Markdown devient <em>bonjour</em> dans le document final obtenu suite à la compilation.</p>
<p>Aussi, la syntaxe suivante :</p>
<pre><code>- premier élément (obligatoirement précédé d&#39;une ligne vide)
    - sous élément (obligatoirement précédé de 4 à 7 espaces)
        - sous-sous élément (obligatoirement précédé de 8 à 11 espaces)
- dernier élément (obligatoirement suivi d&#39;une ligne vide)</code></pre>
<p>crée la liste suivante :</p>
<ul>
<li>premier élément (obligatoirement précédé d’une ligne vide)
<ul>
<li>sous élément (obligatoirement précédé de 4 à 7 espaces)
<ul>
<li>sous-sous élément (obligatoirement précédé de 8 à 11 espaces)</li>
</ul></li>
</ul></li>
<li>dernier élément (obligatoirement suivi d’une ligne vide)</li>
</ul>
<p>Je vous laisse découvrir par vous même les autres possibilités de la syntaxe Markdown à partir des sources proposées ci-dessus.</p>
</div>
<div id="compilation-de-fichier-r-markdown-en-rstudio" class="section level2">
<h2>Compilation de fichier R Markdown en RStudio</h2>
<p>Les deux étapes de compilation s’effectuent en cliquant sur un seul bouton, dans la barre en haut du fichier :</p>
<ul>
<li>bouton <strong>Knit</strong> (accompagné d’un logo représentant une pelote de laine avec une aiguille à tricoter).</li>
</ul>
<p>La petit triangle vers le bas semblable à <span class="math inline">\(\blacktriangledown\)</span> à côté du bouton <strong>Knit</strong> permet de sélectionner le format du fichier final. Le symbole de roue d’engrenage permet d’ouvrir un menu pour modifier les paramètres de la compilation.</p>
<p>Peu importe le format final de la sortie, la compilation cache toujours en fait plusieurs étapes intermédiaires dont :</p>
<ul>
<li>la compilation du code R dans une nouvelle session R (pas dans celle déjà ouverte en RStudio);</li>
<li>l’intégration des résultats de cette compilation à un document
<ul>
<li>Markdown (.md) pour un résultat final en HTML,</li>
<li>LaTeX (.tex) pour un résultat final en PDF,</li>
<li>Word;</li>
</ul></li>
<li>la compilation de ce document (sauf pour le format Word) pour produire le fichier final.</li>
</ul>
</div>
<div id="blocs-de-code-r" class="section level2">
<h2>Blocs de code R</h2>
<p>Dans un fichier R Markdown, le code R doit être encadré par le tag d’ouverture composé de trois apostrophes inversées suivies de <code>{r}</code> et le tag de fermeture composé de trois apostrophes inversées. Entre les accolades et après le <code>r</code>, nous pouvons ajouter un nom et des options de blocs de code R, séparées par des virgules. Nommer les blocs de code est utile pour se retrouver plus facilement dans un document contenant plusieurs blocs de code. Voici un exemple de bloc de code nommé, mais pour lequel aucune option n’a été modifiée.</p>
<pre><code>```{r chunck}
a &lt;- 1 + 1
a
```</code></pre>
<p>Sans modifier les options par défaut du bloc de code, le code et les sorties produites seront intégrés au document comme suit.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">a &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb5-2" title="2">a</a></code></pre></div>
<pre><code>## [1] 2</code></pre>
<div id="options-de-blocs-de-code-r" class="section level4">
<h4>Options de blocs de code R :</h4>

<p>Les options de blocs de code R les plus utiles sont les suivantes :</p>
<ul>
<li><code>eval</code> (<code>TRUE</code> par défaut, ou <code>FALSE</code>) : détermine si le code R doit être évalué ou non,</li>
<li><code>echo</code> (<code>TRUE</code> par défaut, ou <code>FALSE</code>) : détermine si le code R doit être affiché ou non,</li>
<li><code>results</code> (<code>'markup'</code> par défaut, ou <code>'hide'</code> ou <code>'hold'</code> ou <code>'asis'</code>) :<br />
détermine comment les sorties doivent être affichées,</li>
<li><code>error</code> (<code>FALSE</code> par défaut, ou <code>TRUE</code>) : détermine si les messages d’erreur doivent être affichés.</li>
<li><code>warning</code> (<code>TRUE</code> par défaut, ou <code>FALSE</code>) : détermine si les messages d’avertissement doivent être affichés.</li>
</ul>
<p>Il existe bien d’autres options, résumées dans le document suivant :<br />
<a href="https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf" class="uri">https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf</a></p>
<p>Voici un exemple de bout de code R avec options :</p>
<pre><code>```{r  R.options = list(width = 50), comment = &quot;&quot;}
b &lt;- c(1:10, rep(11, 20))
b
```</code></pre>
<p>Voici ce que ce bout de code inclut dans le document final.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">b &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="kw">rep</span>(<span class="dv">11</span>, <span class="dv">20</span>))</a>
<a class="sourceLine" id="cb8-2" title="2">b</a></code></pre></div>
<pre><code> [1]  1  2  3  4  5  6  7  8  9 10 11 11 11 11 11
[16] 11 11 11 11 11 11 11 11 11 11 11 11 11 11 11</code></pre>
<p>La largeur de la sortie a été contrôlée avec <code>R.options = list(width = 50)</code>, qui permet de modifier n’importe quelle option de session R. Les caractères <code>##</code> au début de chacune des lignes de sortie ont été retirés avec <code>comment = ""</code>.</p>
</div>
</div>
<div id="commande-r-intégrée-à-un-bout-de-texte-inline" class="section level2">
<h2>Commande R intégrée à un bout de texte (<em>inline</em>)</h2>
<p>Il est aussi possible d’inclure une commande R retournant un simple vecteur dans un bout de texte (en anglais on parle de <em>inline R code</em>). Seulement la sortie produite par la commande R sera affichée. Il faut encadrer la commande du tag ouvrant composé d’une seule apostrophe inversée suivie de <code>r</code> et du tag fermant composé uniquement d’une apostrophe inversée.</p>
<p>Par exemple, la phrase suivante dans un document R Markdown :</p>
<p><img src="fig/CodeInline.png" width="55%" style="display: block; margin: auto auto auto 0;" /></p>
<p>produit le résultat suivant :</p>
<p>La division de 5 par 3 donne le résultat 1.6666667.</p>
</div>
<div id="intégration-de-figures" class="section level2">
<h2>Intégration de figures</h2>
<div id="à-partir-dun-fichier-image" class="section level4">
<h4>À partir d’un fichier image :</h4>

<p>Il est possible d’intégrer une figure provenant d’un fichier image en utilisant la syntaxe Markdown suivante :</p>
<ul>
<li>fichier local : <code>![](chemin/relatif/vers/fichier.png)</code></li>
<li>fichier provenant du web : <code>![](http://example.com/logo.png)</code></li>
</ul>
<p><strong>Note</strong> : Seuls les chemins relatifs à l’emplacement du fichier source R Markdown sont acceptés. Alors le fichier image local doit être dans le même répertoire que le fichier .Rmd ou dans un sous-répertoire de ce répertoire.</p>
<p>Si nous ajoutons du texte entre les crochets, celui-ci devient le titre de la figure.</p>
<p>Par exemple, la commande Markdown suivante :</p>
<p><code>![Exemple de figure](fig/WYSIWYM.png)</code></p>
<p>produit le résultat suivant :</p>
<div style="page-break-after: always;"></div>
<div class="figure">
<img src="fig/WYSIWYM.png" alt="Exemple de figure" />
<p class="caption">Exemple de figure</p>
</div>
<p>Il n’est cependant pas possible de contrôler la taille de l’image avec cette syntaxe. Si nous travaillons dans un document R Markdown plutôt que simplement Markdown, il existe une autre façon d’intégrer une figure provenant d’un fichier image qui permet un meilleur contrôle sur la figure produite. Pour ce faire, il faut créer un bloc de code R dans lequel la fonction <code>include_graphic</code> du package <code>knitr</code> est appelée. En voici un exemple suivi du résultat produit.</p>
<pre><code>```{r echo = FALSE,  out.width = &quot;45%&quot;, fig.align = &#39;center&#39;, fig.cap = &quot;Autre exemple de figure&quot;}
knitr::include_graphics(&quot;fig/WYSIWYM.png&quot;)
```</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-13"></span>
<img src="fig/WYSIWYM.png" alt="Autre exemple de figure" width="45%" />
<p class="caption">
Figure 6: Autre exemple de figure
</p>
</div>
<p>Les options <code>out.height</code> et <code>out.width</code> permettent de contrôler les dimensions de la figure, <code>fig.align</code> contrôle son alignement et <code>fig.cap</code> permet d’ajouter un titre.</p>
<!--
Ma source d'info :
http://stackoverflow.com/questions/15625990/how-to-set-size-for-local-image-using-knitr-for-markdown
-->
</div>
<div id="à-partir-dun-bloc-de-code-r-qui-génère-un-graphique" class="section level4">
<h4>À partir d’un bloc de code R qui génère un graphique :</h4>

<p>Nous pouvons aussi intégrer une figure à un fichier R Markdown à l’aide d’un bloc de code R qui génère un graphique. Voici un exemple suivi du résultat produit.</p>
<pre><code>```{r  fig.height = 3.5, out.width = &quot;70%&quot;, fig.cap = &quot;Encore un exemple de figure&quot;}
plot(cars, main = &quot;Relation entre la vitesse et la distance de freinage de voitures&quot;)
```</code></pre>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-15"></span>
<img src="/communication_resultats/redaction_r_markdown_2020_files/figure-html/unnamed-chunk-15-1.png" alt="Encore un exemple de figure" width="70%" />
<p class="caption">
Figure 7: Encore un exemple de figure
</p>
</div>
<div style="page-break-after: always;"></div>
<p>Lorsque la figure est créée par le code R, nous pouvons contrôler les dimensions de la fenêtre graphique avec les options <code>fig.height</code> et <code>fig.width</code>. Malgré tout, les options <code>out.height</code> et <code>out.width</code> continuent de contrôler la dimension de la figure dans le document final.</p>
</div>
</div>
<div id="intégration-de-tableaux" class="section level2">
<h2>Intégration de tableaux</h2>
<p>Il existe une syntaxe Markdown pour créer des tableaux. Par exemple, le code Markdown suivant :</p>
<pre><code>| Droite | Gauche | Défaut | Centré |
|-------:|:-------|--------|:------:|
| 12 | 12 | 12 | 12 |
| 123 | 123 | 123 | 123 |
| 1 | 1 | 1 | 1 | 

Table: Premier exemple de tableau</code></pre>
<p>produit le tableau suivant :</p>
<table>
<caption>Premier exemple de tableau</caption>
<thead>
<tr class="header">
<th align="right">Droite</th>
<th align="left">Gauche</th>
<th>Défaut</th>
<th align="center">Centré</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">12</td>
<td align="left">12</td>
<td>12</td>
<td align="center">12</td>
</tr>
<tr class="even">
<td align="right">123</td>
<td align="left">123</td>
<td>123</td>
<td align="center">123</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">1</td>
<td>1</td>
<td align="center">1</td>
</tr>
</tbody>
</table>
<p>C’est l’emplacement des caractères « deux-points » (<code>:</code>) sur la ligne séparant l’entête du tableu à son contenu qui détermine l’alignement de la colonne. Pour donner un titre au tableau, il faut ajouter au-dessus ou en-dessous du code source du tableau une ligne débutant par <code>Table:</code>, suivi du titre.</p>
<p>Aussi, la fonction <code>kable</code> du package <code>knitr</code> permet d’intégrer un data frame R sous forme de tableau dans un document produit avec R Markdown.</p>
<div style="page-break-after: always;"></div>
<p>Voici un exemple suivi du résultat produit (l’option <code>results = 'asis'</code> est nécessaire ici).</p>
<pre><code>```{r  results = &#39;asis&#39;}
knitr::kable(head(cars, 3), caption = &quot;Exemple de tableau&quot;)
```</code></pre>
<table>
<caption><span id="tab:unnamed-chunk-16">Table 1: </span>Exemple de tableau</caption>
<thead>
<tr class="header">
<th align="right">speed</th>
<th align="right">dist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">10</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<p>Notons que d’autres fonctions permettent de formater une matrice ou un data frame R pour créer un tableau dans un document rédigé en R Markdown. Notamment, le <a href="http://haozhu233.github.io/kableExtra/">package <code>kableExtra</code></a> ajoute des possibilités à la fonction <code>kable</code> du package <code>knitr</code>. Quelques autres outils sont mentionnés dans le document <a href="https://github.com/rstudio/cheatsheets/blob/master/rmarkdown-2.0.pdf" class="uri">https://github.com/rstudio/cheatsheets/blob/master/rmarkdown-2.0.pdf</a>. La mise en forme du tableau obtenu diffère légèrement d’une fonction à l’autre.</p>
<p>Si le document final doit être en HTML uniquement, des outils supplémentaires s’offrent à nous pour mettre en forme des tableaux, notamment :</p>
<ul>
<li>la fonction <code>paged_table</code> du package <code>rmarkdown</code> pour créer des tableaux pouvant posséder des pages : <a href="https://bookdown.org/yihui/rmarkdown/html-document.html#data-frame-printing" class="uri">https://bookdown.org/yihui/rmarkdown/html-document.html#data-frame-printing</a></li>
<li>le package <code>formattable</code> pour formater un data frame à afficher sous forme de tableau : <a href="https://github.com/renkun-ken/formattable" class="uri">https://github.com/renkun-ken/formattable</a></li>
<li>le package <code>DT</code> pour créer des tableaux interactifs :
<ul>
<li><a href="https://rstudio.github.io/DT/" class="uri">https://rstudio.github.io/DT/</a></li>
<li><a href="https://stt4230.rbind.io/tutoriels_etudiants/hiver_2019/dt/" class="uri">https://stt4230.rbind.io/tutoriels_etudiants/hiver_2019/dt/</a></li>
</ul></li>
</ul>
</div>
<div id="trucs-divers-dans-lédition-de-documents-r-markdown" class="section level2">
<h2>Trucs divers dans l’édition de documents R Markdown</h2>
<ul>
<li><p>Pour faire un retour de chariot sans changer de paragraphe :<br />
insérer <strong>deux caractères espace</strong> à la fin d’une ligne, avant le retour de chariot.</p></li>
<li><p>Pour insérer une ligne vide dans le document final :<br />
insérer une ligne contenant uniquement le caractère « <code>&amp;nbsp;</code> », qui représente un espace en HTML.</p></li>
<li><p>Pour insérer un commentaire (texte n’apparaissant pas dans le document final) :<br />
utiliser les tags html pour des commentaires, soit</p></li>
</ul>
<pre><code>&lt;!-- commentaire ici (possiblement sur plusieurs lignes) --&gt;</code></pre>
<ul>
<li>Raccourci clavier pour insérer un bloc de code R dans un fichier R Markdown en RStudio :
<ul>
<li>Sous Windows : « Ctrl + Alt + i » ou « Alt Car + i »,</li>
<li>Sous Mac OS X / OS X / macOS : « Command + Option + i ».</li>
</ul></li>
<li>Pour modifier les options par défaut pour les blocs de code R :<br />
insérer la ligne suivante (avec les options désirées) au tout début du fichier .Rmd (juste en dessous de l’entête)</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="st">`</span><span class="dt">r knitr::opts_chunk$set(echo = FALSE, results = &#39;hide&#39;)</span><span class="st">`</span></a></code></pre></div>
<ul>
<li>Pour avoir des noms automatiques d’éléments en français lors de la création d’un document final au format PDF (par exemple le titre de la table des matières) : ajouter dans l’entête les lignes suivantes</li>
</ul>
<pre><code>header-includes:
- \usepackage[french]{babel}</code></pre>
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="références" class="section level1">
<h1>Références</h1>
<p>Recherche reproductible :</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Reproducibility#Reproducible_research" class="uri">https://en.wikipedia.org/wiki/Reproducibility#Reproducible_research</a></li>
<li><a href="https://annakrystalli.me/talks/r-in-repro-research-dc.html" class="uri">https://annakrystalli.me/talks/r-in-repro-research-dc.html</a></li>
</ul>
<p>Programmation lettrée :</p>
<ul>
<li><a href="https://fr.wikipedia.org/wiki/Programmation_lettr%C3%A9e" class="uri">https://fr.wikipedia.org/wiki/Programmation_lettr%C3%A9e</a></li>
</ul>
<p>Documentation de R Markdown :</p>
<ul>
<li><a href="http://rmarkdown.rstudio.com/" class="uri">http://rmarkdown.rstudio.com/</a></li>
<li>Xie, Y., Allaire, J. J., et Grolemund, G. (2018). <em>R markdown: The definitive guide</em>. Chapman and Hall/CRC. URL <a href="https://bookdown.org/yihui/rmarkdown/" class="uri">https://bookdown.org/yihui/rmarkdown/</a></li>
<li><a href="https://github.com/rstudio/cheatsheets/raw/master/rmarkdown-2.0.pdf" class="uri">https://github.com/rstudio/cheatsheets/raw/master/rmarkdown-2.0.pdf</a></li>
<li><a href="https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf" class="uri">https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf</a></li>
</ul>
<p>Options de blocs de code R :</p>
<ul>
<li><a href="https://yihui.name/knitr/options/" class="uri">https://yihui.name/knitr/options/</a></li>
</ul>
<p>Autre introduction à R Markdown en français :</p>
<ul>
<li><a href="http://larmarange.github.io/analyse-R/rmarkdown-les-rapports-automatises.html" class="uri">http://larmarange.github.io/analyse-R/rmarkdown-les-rapports-automatises.html</a></li>
</ul>
</div>
